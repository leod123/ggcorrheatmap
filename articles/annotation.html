<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Annotation • ggcorrheatmap</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Annotation">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ggcorrheatmap</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/heatmap.html">Making a heatmap</a></li>
    <li><a class="dropdown-item" href="../articles/correlation.html">Correlation heatmaps</a></li>
    <li><a class="dropdown-item" href="../articles/annotation.html">Annotation</a></li>
    <li><a class="dropdown-item" href="../articles/clustering.html">Clustering</a></li>
    <li><a class="dropdown-item" href="../articles/facets.html">Facets</a></li>
    <li><a class="dropdown-item" href="../articles/mixed.html">Mixed layouts</a></li>
    <li><a class="dropdown-item" href="../articles/legends.html">Scales and legends</a></li>
    <li><a class="dropdown-item" href="../articles/tidy_input.html">Using tidy data</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/leod123/ggcorrheatmap/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Annotation</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/leod123/ggcorrheatmap/blob/v0.2.0/vignettes/articles/annotation.Rmd" class="external-link"><code>vignettes/articles/annotation.Rmd</code></a></small>
      <div class="d-none name"><code>annotation.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/leod123/ggcorrheatmap" class="external-link">ggcorrheatmap</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span></code></pre></div>
<p>Row and column annotation is added by passing data frames to the
<code>annot_rows_df</code> and <code>annot_cols_df</code> arguments.
There must be either row names or a column named <code>.names</code>
containing the names of the rows/columns that are to be annotated. The
remaining columns are used for annotation.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">row_annot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span>, a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">col_annot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>b <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span>, <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">col_annot</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">mtcars</span>, annot_rows_df <span class="op">=</span> <span class="va">row_annot</span>, annot_cols_df <span class="op">=</span> <span class="va">col_annot</span><span class="op">)</span></span></code></pre></div>
<p><img src="annotation_files/figure-html/unnamed-chunk-2-1.png" alt="Correlation heatmap of mtcars. To the right and below are annotations half the width of a heatmap cell. The row annotation is continuous with the viridis scale and the column annotation is categorical with the values a, b, and c and the Brewer Pastel1 palette." width="700"></p>
<div class="section level2">
<h2 id="controlling-colours">Controlling colours<a class="anchor" aria-label="anchor" href="#controlling-colours"></a>
</h2>
<p>The colours used for annotation are selected in order from eight
brewer palettes (categorical annotations,
<code><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">ggplot2::scale_fill_brewer()</a></code>) or eight viridis options
(continuous annotations, <code><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">ggplot2::scale_fill_viridis_c()</a></code>),
starting again from the beginning if there are more than eight
annotations.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Make 8x8 matrix as some colour scales have a maximum of 8 possible colours</span></span>
<span><span class="va">mat_in</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">64</span>, nrow <span class="op">=</span> <span class="fl">8</span>, ncol <span class="op">=</span> <span class="fl">8</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># Works without rownames or '.names' column as they are by default set to the same numbers here</span></span>
<span><span class="va">row_annot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="fl">12</span>, <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">col_annot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">row_annot</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">col_annot</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">12</span></span>
<span><span class="fu"><a href="../reference/gghm.html">gghm</a></span><span class="op">(</span><span class="va">mat_in</span>, annot_rows_df <span class="op">=</span> <span class="va">row_annot</span>, annot_cols_df <span class="op">=</span> <span class="va">col_annot</span>,</span>
<span>     <span class="co"># Hide the legends</span></span>
<span>     legend_order <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></code></pre></div>
<p><img src="annotation_files/figure-html/unnamed-chunk-3-1.png" alt="An 8x8 heatmap. Rows and columns are named 1 to 8, and the values in the heatmap go from 1 to 64, rowwise from the top left. To the right are 12 categorical row annotation columns using different Brewer colour scales. After the eighth annotation the colour scale cycles back to the first one. Below the heatmap are 12 annotations using viridis colour scales for continuous data, also recycling scales after the eighth annotation." width="700"></p>
<p>The colours can be changed by passing a named list of
<code>ggplot2</code> fill scales or strings specifying brewer palettes
or viridis options to the <code>annot_rows_col</code> and
<code>annot_cols_col</code> arguments. Annotations not included in the
list will get the default colours. When supplying a scale object, the
order of the legends may change (by default the main heatmap annotation
is first, followed by row annotations in order and column annotations in
order). The order can be adjusted by using the <code>guide</code>
argument of the scale functions,
e.g. <code>guide = ggplot2::guide_legend(order = 3)</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Make annotation with eight columns, half categorical and half continuous</span></span>
<span><span class="va">col_annot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename_with</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"custom"</span>, <span class="st">"default"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, each <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">}</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="va">as.character</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">col_annot</span><span class="op">$</span><span class="va">.names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span></span>
<span></span>
<span><span class="va">col_annot_fill</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>custom1 <span class="op">=</span> <span class="st">"Oranges"</span>,</span>
<span>                       custom2 <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html" class="external-link">scale_fill_discrete</a></span><span class="op">(</span>guide <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span>,</span>
<span>                       custom3 <span class="op">=</span> <span class="st">"mako"</span>,</span>
<span>                       custom4 <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_continuous.html" class="external-link">scale_fill_continuous</a></span><span class="op">(</span>guide <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span>, annot_cols_df <span class="op">=</span> <span class="va">col_annot</span>,</span>
<span>         annot_cols_col <span class="op">=</span> <span class="va">col_annot_fill</span>, legend_order <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></code></pre></div>
<p><img src="annotation_files/figure-html/unnamed-chunk-4-1.png" alt="Correlation heatmap of eight columns from mtcars. Below the heatmap are eight annotation rows, the first four categorical and the last four continuous. Their names alternate between custom1, custom2, ... and default1, default2, .... The custom ones use user-specified colours while the default ones use the colour schemes in the annotations of the previous heatmap." width="700"></p>
</div>
<div class="section level2">
<h2 id="annotation-positioning">Annotation positioning<a class="anchor" aria-label="anchor" href="#annotation-positioning"></a>
</h2>
<p>The <code>annot_rows_side</code> and <code>annot_cols_side</code>
arguments control which side the annotation should be placed on (‘left’
or ‘right’ for row annotations, ‘top’ or ‘bottom’ for column
annotation). A triangular layout (for symmetric matrices) limits the
positions to the non-empty sides.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">annot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span>, annot1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plt1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gghm.html">gghm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span>, annot_rows_df <span class="op">=</span> <span class="va">annot</span>, annot_cols_df <span class="op">=</span> <span class="va">annot</span>,</span>
<span>             annot_rows_side <span class="op">=</span> <span class="st">"left"</span>, annot_cols_side <span class="op">=</span> <span class="st">"top"</span>,</span>
<span>             annot_cols_names_side <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Adjust legend position and margins</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"left"</span>,</span>
<span>        plot.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">50</span>, <span class="fl">30</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">plt2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gghm.html">gghm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span>, annot_rows_df <span class="op">=</span> <span class="va">annot</span>, annot_cols_df <span class="op">=</span> <span class="va">annot</span>,</span>
<span>             annot_rows_side <span class="op">=</span> <span class="st">"left"</span>, annot_cols_side <span class="op">=</span> <span class="st">"top"</span>,</span>
<span>             layout <span class="op">=</span> <span class="st">"br"</span>, include_diag <span class="op">=</span> <span class="cn">TRUE</span>, show_names_diag <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>             show_names_x <span class="op">=</span> <span class="cn">FALSE</span>, show_names_y <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">50</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plt1</span> <span class="op">+</span> <span class="va">plt2</span></span></code></pre></div>
<p><img src="annotation_files/figure-html/unnamed-chunk-5-1.png" alt="Two mtcars correlation heatmaps. The first one has row and column annotation to the left of and above the heatmap. The second one is a bottom right triangular heatmap and the row and column annotations are to the right and below." width="1152"></p>
<p>The sizes and gaps between annotations and the heatmap can be
adjusted with the <code>annot_size</code>, <code>annot_dist</code>
(distance from heatmap) and <code>annot_gap</code> (gap between
annotations) arguments.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">row_annot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">row_annot</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">mtcars</span>, annot_rows_df <span class="op">=</span> <span class="va">row_annot</span>,</span>
<span>         legend_order <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>         <span class="co"># annot_dist controls the distance between the heatmap and the annotation</span></span>
<span>         annot_dist <span class="op">=</span> <span class="fl">0</span>,</span>
<span>         <span class="co"># annot_gap controls the gap between annotations</span></span>
<span>         annot_gap <span class="op">=</span> <span class="fl">1</span>,</span>
<span>         <span class="co"># annot_size controls the size (width if row, height if column) of the annotations</span></span>
<span>         annot_size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="annotation_files/figure-html/unnamed-chunk-6-1.png" alt="mtcars correlation heatmap with four row annotations to the right. The first annotation is right next to the heatmap with no gap in-between. The gaps between annotations are the same width as a cell in the heatmap, and the annotations are each two cells wide." width="700"></p>
<p>Other arguments to control annotations include
<code>show_annot_names</code> (show/hide names),
<code>annot_legend</code> (show/hide legends), <code>border_col</code>
(cell border colour), and <code>border_lwd</code> (cell border
linewidth). The border arguments are for the main heatmap but are
applied to the annotations as well.</p>
<p>These parameters are applied to both row and column annotations but
can be applied independently for row and column annotation by using the
<code>annot_rows_params</code> and <code>annot_cols_params</code>
arguments. These are named lists where the names specify what to change
(<code>dist</code>, <code>gap</code>, <code>size</code>,
<code>show_names</code>, <code>border_col</code>, and
<code>border_lwd</code>).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_in</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">9</span>, nrow <span class="op">=</span> <span class="fl">3</span>, ncol <span class="op">=</span> <span class="fl">3</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">row_annot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>annot1 <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, annot2 <span class="op">=</span> <span class="fl">4</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span></span>
<span><span class="va">col_annot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>annot3 <span class="op">=</span> <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, annot4 <span class="op">=</span> <span class="va">letters</span><span class="op">[</span><span class="fl">4</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/gghm.html">gghm</a></span><span class="op">(</span><span class="va">df_in</span>, annot_rows_df <span class="op">=</span> <span class="va">row_annot</span>, annot_cols_df <span class="op">=</span> <span class="va">col_annot</span>,</span>
<span>     legend_order <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>     <span class="co"># border_col and border_lwd control both the heatmap and annotations</span></span>
<span>     border_col <span class="op">=</span> <span class="st">"yellow"</span>, border_lwd <span class="op">=</span> <span class="fl">1</span>,</span>
<span>     annot_rows_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>       <span class="co"># Hide labels</span></span>
<span>       show_names <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>     <span class="op">)</span>,</span>
<span>     annot_cols_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>       <span class="co"># 'border_col' and 'border_lwd' control the border colour and linewidth</span></span>
<span>       border_col <span class="op">=</span> <span class="st">"white"</span>, border_lwd <span class="op">=</span> <span class="fl">.3</span>,</span>
<span>       <span class="co"># 'dist', 'gap', and 'size' work as described in the previous chunk</span></span>
<span>       dist <span class="op">=</span> <span class="fl">1</span>, gap <span class="op">=</span> <span class="fl">0.3</span>, size <span class="op">=</span> <span class="fl">0.3</span></span>
<span>     <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="annotation_files/figure-html/unnamed-chunk-7-1.png" alt="A 3x3 matrix with two row and two column annotations. The heatmap and the row annotations have thick yellow cell borders. The column annotations have thin white borders and are themselves thinner than the row annotation while also being far below the heatmap with a gap between the two annotations. While the column annotations have legends there are no legends for the row annotations." width="700"></p>
</div>
<div class="section level2">
<h2 id="annotation-labels">Annotation labels<a class="anchor" aria-label="anchor" href="#annotation-labels"></a>
</h2>
<p>The sizes of the names can be changed using the
<code>annot_names_size</code> argument. Further customisation is
possible by passing named lists of static aesthetics to the
<code>annot_rows_names_params</code> and
<code>annot_cols_names_params</code> arguments. These lists are passed
on to <code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">ggplot2::geom_text()</a></code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_in</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">9</span>, nrow <span class="op">=</span> <span class="fl">3</span>, ncol <span class="op">=</span> <span class="fl">3</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">row_annot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>annot1 <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, annot2 <span class="op">=</span> <span class="fl">4</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span></span>
<span><span class="va">col_annot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>annot3 <span class="op">=</span> <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, annot4 <span class="op">=</span> <span class="va">letters</span><span class="op">[</span><span class="fl">4</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/gghm.html">gghm</a></span><span class="op">(</span><span class="va">df_in</span>, annot_rows_df <span class="op">=</span> <span class="va">row_annot</span>, annot_cols_df <span class="op">=</span> <span class="va">col_annot</span>,</span>
<span>     legend_order <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>     annot_rows_names_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>       colour <span class="op">=</span> <span class="st">"magenta"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, size <span class="op">=</span> <span class="fl">7</span>, fontface <span class="op">=</span> <span class="st">"bold"</span></span>
<span>     <span class="op">)</span>,</span>
<span>     annot_cols_names_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>       angle <span class="op">=</span> <span class="op">-</span><span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">0.7</span>, vjust <span class="op">=</span> <span class="fl">0</span></span>
<span>     <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="annotation_files/figure-html/unnamed-chunk-8-1.png" alt="A 3x3 heatmap with two each of row and column annotations. The row annotation has vertical, large, magenta labels below showing the names. The column annotations have labels to the left, angled at 45 degrees." width="700"></p>
<p>If the annotation labels are too long and are cut off, the plot
margins can be adjusted by using the <code><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">ggplot2::theme()</a></code>
function and its <code>plot.margin</code> argument. Alternatively, the
figure height can be increased, as the heatmap is set to use a fixed
aspect ratio (<code><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">ggplot2::coord_fixed()</a></code>). This can be
overwritten by adding <code><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">ggplot2::coord_cartesian()</a></code> to the
output plot.</p>
</div>
<div class="section level2">
<h2 id="dealing-with-missing-values">Dealing with missing values<a class="anchor" aria-label="anchor" href="#dealing-with-missing-values"></a>
</h2>
<p>If there are NAs in the annotation they are by default coloured grey.
The colour can be changed using the <code>annot_na_col</code> argument,
or by specifying a colour for the <code>na.value</code> argument in a
<code>ggplot2</code> scale when supplied using the
<code>annot_rows_col</code> and <code>annot_cols_col</code> arguments.
The <code>annot_na_remove</code> argument can be set to
<code>TRUE</code> to not display the cells at all. If the annotation
data frame does not contain all the names of the axis, those
rows/columns will be left empty.</p>
<p>As a side note, <code>annot_na_remove</code> is by default set to be
the same as <code>na_remove</code> so setting the NAs to be removed from
the main heatmap removes NAs from the annotation unless
<code>annot_na_remove</code> is changed. Similarly, the
<code>annot_na_col</code> argument is also set to by default be the same
as <code>na_col</code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="co"># Row annotation with NAs</span></span>
<span><span class="va">row_annot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span>,</span>
<span>                        a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="cn">NA</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span>, <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                        b <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"V"</span>, <span class="st">"W"</span>, <span class="cn">NA</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span>, <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">row_fill</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Purples"</span>, na.value <span class="op">=</span> <span class="st">"green"</span>,</span>
<span>                                       <span class="co"># Adjust the order of the legend</span></span>
<span>                                       guide <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span>order <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Column annotation with missing names</span></span>
<span><span class="va">col_annot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span>, <span class="fl">7</span><span class="op">)</span>,</span>
<span>                        c <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span>,</span>
<span>                        d <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plt1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">mtcars</span>, annot_rows_df <span class="op">=</span> <span class="va">row_annot</span>, annot_cols_df <span class="op">=</span> <span class="va">col_annot</span>,</span>
<span>                 annot_na_remove <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">plt2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">mtcars</span>, annot_rows_df <span class="op">=</span> <span class="va">row_annot</span>, annot_cols_df <span class="op">=</span> <span class="va">col_annot</span>,</span>
<span>                 annot_na_remove <span class="op">=</span> <span class="cn">FALSE</span>, annot_rows_col <span class="op">=</span> <span class="va">row_fill</span>,</span>
<span>                 annot_na_col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plt1</span> <span class="op">+</span> <span class="va">plt2</span></span></code></pre></div>
<p><img src="annotation_files/figure-html/unnamed-chunk-9-1.png" alt="Two mtcars correlation heatmaps with two row and two column annotations. In the first plot, there are holes in the annotations showing that there are NAs. In the second plot, the row annotation NAs have cells coloured green (first annotation) and blue (second annotation). The column annotation still has holes." width="960"></p>
<p>As can be seen in some plots, the legends may be cut off if there are
many annotations. Fitting the legends can be tricky and is covered in
the <a href="legends.html">legends article</a>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Leo Dahl.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>

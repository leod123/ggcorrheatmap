<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Clustering • ggcorrheatmap</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Clustering">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ggcorrheatmap</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/heatmap.html">Making a heatmap</a></li>
    <li><a class="dropdown-item" href="../articles/correlation.html">Correlation heatmaps</a></li>
    <li><a class="dropdown-item" href="../articles/annotation.html">Annotation</a></li>
    <li><a class="dropdown-item" href="../articles/clustering.html">Clustering</a></li>
    <li><a class="dropdown-item" href="../articles/facets.html">Facets</a></li>
    <li><a class="dropdown-item" href="../articles/mixed.html">Mixed layouts</a></li>
    <li><a class="dropdown-item" href="../articles/legends.html">Scales and legends</a></li>
    <li><a class="dropdown-item" href="../articles/tidy_input.html">Using tidy data</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/leod123/ggcorrheatmap/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Clustering</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/leod123/ggcorrheatmap/blob/main/vignettes/articles/clustering.Rmd" class="external-link"><code>vignettes/articles/clustering.Rmd</code></a></small>
      <div class="d-none name"><code>clustering.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/leod123/ggcorrheatmap" class="external-link">ggcorrheatmap</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://talgalili.github.io/dendextend/" class="external-link">dendextend</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span></code></pre></div>
<p>Heatmap rows and columns are clustered if the
<code>cluster_rows</code> and <code>cluster_cols</code> arguments are
set to <code>TRUE</code>. Distance measure and clustering method can be
specified with the <code>cluster_distance</code> and
<code>cluster_method</code> arguments, passed on to the
<code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">stats::dist()</a></code> and <code><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">stats::hclust()</a></code> functions,
respectively.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">mtcars</span>, cluster_rows <span class="op">=</span> <span class="cn">TRUE</span>, cluster_cols <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="clustering_files/figure-html/clustering-1.png" alt="A correlation heatmap of the columns in the mtcars data. The cells are filled with colours ranging from blue (-1) to white (0) to red (1). The rows and columns have been clustered and dendrograms are drawn to the right and below the heatmap." width="700"></p>
<p>The <code>cluster_rows</code> and <code>cluster_cols</code> arguments
can also be <code>hclust</code> or <code>dendrogram</code> objects if
more control is required.</p>
<div class="section level2">
<h2 id="dendrogram-position">Dendrogram position<a class="anchor" aria-label="anchor" href="#dendrogram-position"></a>
</h2>
<p>The positions of the dendrograms can be changed with the
<code>dend_rows_side</code> (‘left’ or ‘right’) and
<code>dend_cols_side</code> (‘top’ or ‘bottom’) arguments. For
triangular layouts (of symmetric matrices) the dendrograms are placed on
the non-empty sides of the heatmap.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The dendrogram sides can be adjusted with the 'dend_rows_side' and 'dend_cols_side' arguments</span></span>
<span><span class="va">plt1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">mtcars</span>, cluster_rows <span class="op">=</span> <span class="cn">TRUE</span>, cluster_cols <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                 dend_rows_side <span class="op">=</span> <span class="st">"left"</span>, dend_cols_side <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Dendrograms can be hidden by setting 'show_dend_rows' and/or 'show_dend_cols' to FALSE</span></span>
<span><span class="va">plt2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">mtcars</span>, cluster_rows <span class="op">=</span> <span class="cn">TRUE</span>, cluster_cols <span class="op">=</span> <span class="cn">TRUE</span>, layout <span class="op">=</span> <span class="st">"bl"</span>,</span>
<span>                 show_dend_rows <span class="op">=</span> <span class="cn">FALSE</span>, dend_cols_side <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plt1</span> <span class="op">+</span> <span class="va">plt2</span></span></code></pre></div>
<p><img src="clustering_files/figure-html/unnamed-chunk-2-1.png" alt="Two mtcars correlation heatmaps. The first one has the dendrograms on the top and left. The second plot has only drawn the bottom left triangle of the matrix and there is a dendrogram on the bottom." width="960"></p>
<p>If annotation and a dendrogram are on the same side, the dendrogram
is moved to make place for the annotation.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">annot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span>, a <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">11</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">mtcars</span>, cluster_rows <span class="op">=</span> <span class="cn">TRUE</span>, cluster_cols <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>         annot_rows_df <span class="op">=</span> <span class="va">annot</span>, annot_cols_df <span class="op">=</span> <span class="va">annot</span>,</span>
<span>         dend_rows_side <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span></span></code></pre></div>
<p><img src="clustering_files/figure-html/unnamed-chunk-3-1.png" alt="A correlation heatmap of mtcars with clustered rows and columns. The row dendrogram is on the left side, and on the right side of the plot is an annotation column with values ranging between 1 and 11 and colours from the viridis scale. At the bottom of the plot is an annotation row showing the same as the row annotation but using a different viridis scale. Below the annotation row is another dendrogram." width="672"></p>
</div>
<div class="section level2">
<h2 id="changing-how-the-dendrograms-look">Changing how the dendrograms look<a class="anchor" aria-label="anchor" href="#changing-how-the-dendrograms-look"></a>
</h2>
<p>The <code>dend_col</code>, <code>dend_dist</code>,
<code>dend_height</code>, <code>dend_lwd</code>, and
<code>dend_lty</code> arguments change the colour, distance to the
heatmap, height (scaling), linewidth, and linetype of the dendrograms,
respectively.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">mtcars</span>, cluster_rows <span class="op">=</span> <span class="cn">TRUE</span>, cluster_cols <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>         dend_col <span class="op">=</span> <span class="st">"cyan"</span>, dend_height <span class="op">=</span> <span class="fl">2</span>, dend_lwd <span class="op">=</span> <span class="fl">1</span>, dend_lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="clustering_files/figure-html/unnamed-chunk-4-1.png" alt="Correlation heatmap of mtcars with clustered rows and columns. The row and column dendrograms are longer and thicker than before, coloured cyan and dashed." width="700"></p>
<p>To apply these changes to only one of the dendrograms, use the
<code>dend_rows_params</code> and <code>dend_cols_params</code>
arguments. These arguments take a named list containing one or more of
<code>col</code>, <code>dist</code>, <code>height</code>,
<code>lwd</code>, and <code>lty</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">mtcars</span>, cluster_rows <span class="op">=</span> <span class="cn">TRUE</span>, cluster_cols <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>         dend_rows_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"cyan"</span>, height <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>         dend_cols_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>lwd <span class="op">=</span> <span class="fl">1</span>, lty <span class="op">=</span> <span class="fl">2</span>, dist <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="clustering_files/figure-html/unnamed-chunk-5-1.png" alt="mtcors correlation heatmap with clustered rows and columns. The row dendrogram is tall and cyan like the previous plot, but solid and not thicker than normal. The column dendrogram is the default height and colour (black) but thick and dashed. There is a gap the size of one heatmap cell between the column dendrogram and the heatmap." width="700"></p>
</div>
<div class="section level2">
<h2 id="more-customisation-using-dendextend">More customisation using <code>dendextend</code><a class="anchor" aria-label="anchor" href="#more-customisation-using-dendextend"></a>
</h2>
<p>Finer customisation of dendrograms can be done with the
<code>dend_rows_extend</code> and <code>dend_cols_extend</code>
arguments. These use the <code>dendextend</code> package to change the
dendrogram appearance. The input can be either a named list of lists,
where each element is named after the <code>dendextend</code> function
to use and contains a list of the arguments to pass, or a functional
sequence (<code>fseq</code> object) that strings together the functions
to use. A few examples are shown below, see the <code>dendextend</code>
vignette <code><a href="https://talgalili.github.io/dendextend/articles/dendextend.html" class="external-link">vignette("dendextend", package = "dendextend")</a></code> for
more details on how to use its functions.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># List method</span></span>
<span><span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">mtcars</span>, cluster_rows <span class="op">=</span> <span class="cn">TRUE</span>, cluster_cols <span class="op">=</span> <span class="cn">TRUE</span>, dend_height <span class="op">=</span> <span class="fl">1</span>,</span>
<span>         <span class="co"># Multiple elements can use the same function as lists don't require unique names</span></span>
<span>         dend_rows_extend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>           set <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"branches_k_col"</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>           set <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"branches_lty"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span>         <span class="op">)</span>,</span>
<span>         <span class="co"># NULL or empty list if no arguments are to be passed</span></span>
<span>         dend_cols_extend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>           highlight_branches_lwd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>,</span>
<span>           highlight_branches_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span>         <span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required namespace: colorspace</span></span></code></pre></div>
<p><img src="clustering_files/figure-html/unnamed-chunk-6-1.png" alt="A clustered mtcars correlation heatmap again. The row dendrogram alternates between black, red, and green, as well as solid, dashed, and dotted. The column dendrogram starts thick and gets gradually thinner as it moves toward the heatmap. The colour comes from the viridis scale and shifts along the height of the dendrogram." width="700"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The equivalent call using the fseq method</span></span>
<span><span class="co"># library(dplyr)</span></span>
<span><span class="co"># library(dendextend)</span></span>
<span><span class="co"># ggcorrhm(mtcars, cluster_rows = TRUE, cluster_cols = TRUE,</span></span>
<span><span class="co">#          dend_rows_extend = . %&gt;%</span></span>
<span><span class="co">#            set("branches_k_col", k = 3) %&gt;%</span></span>
<span><span class="co">#            set("branches_lty", c(1, 2, 3)),</span></span>
<span><span class="co">#          dend_cols_extend = . %&gt;%</span></span>
<span><span class="co">#            highlight_branches_lwd(values = seq(1, 4)) %&gt;%</span></span>
<span><span class="co">#            highlight_branches_col())</span></span></code></pre></div>
<p>It is also possible to display the nodes of the dendrograms.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get clustered labels</span></span>
<span><span class="va">clust</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">clust_lab</span> <span class="op">&lt;-</span> <span class="va">clust</span><span class="op">$</span><span class="va">labels</span><span class="op">[</span><span class="va">clust</span><span class="op">$</span><span class="va">order</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">mtcars</span>, cluster_rows <span class="op">=</span> <span class="cn">TRUE</span>, cluster_cols <span class="op">=</span> <span class="cn">TRUE</span>, dend_height <span class="op">=</span> <span class="fl">1</span>,</span>
<span>         <span class="co"># Here using the fseq method</span></span>
<span>         dend_rows_extend <span class="op">=</span> <span class="va">.</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>           <span class="co"># More on customising segments</span></span>
<span>           <span class="co"># Can specify branches to affect by labels using the 'by_labels_branches_*' options</span></span>
<span>           <span class="fu"><a href="https://talgalili.github.io/dendextend/reference/set.html" class="external-link">set</a></span><span class="op">(</span><span class="st">"by_labels_branches_col"</span>, value <span class="op">=</span> <span class="va">clust_lab</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, TF_values <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>           <span class="fu"><a href="https://talgalili.github.io/dendextend/reference/set.html" class="external-link">set</a></span><span class="op">(</span><span class="st">"by_labels_branches_lty"</span>, value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"drat"</span>, <span class="st">"vs"</span><span class="op">)</span>, TF_values <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>           <span class="fu"><a href="https://talgalili.github.io/dendextend/reference/set.html" class="external-link">set</a></span><span class="op">(</span><span class="st">"by_labels_branches_lwd"</span>, value <span class="op">=</span> <span class="va">clust_lab</span><span class="op">[</span><span class="fl">6</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span>, TF_values <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>           <span class="co"># Node and leaf options</span></span>
<span>           <span class="co"># Specify all nodes before leaves so the leaf options are not overwritten</span></span>
<span>           <span class="co"># pch must be specified for a node to be drawn</span></span>
<span>           <span class="fu"><a href="https://talgalili.github.io/dendextend/reference/set.html" class="external-link">set</a></span><span class="op">(</span><span class="st">"nodes_pch"</span>, <span class="fl">19</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>           <span class="fu"><a href="https://talgalili.github.io/dendextend/reference/set.html" class="external-link">set</a></span><span class="op">(</span><span class="st">"nodes_cex"</span>, <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>           <span class="fu"><a href="https://talgalili.github.io/dendextend/reference/set.html" class="external-link">set</a></span><span class="op">(</span><span class="st">"nodes_col"</span>, <span class="st">"orange"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>           <span class="fu"><a href="https://talgalili.github.io/dendextend/reference/set.html" class="external-link">set</a></span><span class="op">(</span><span class="st">"leaves_pch"</span>, <span class="fl">21</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>           <span class="fu"><a href="https://talgalili.github.io/dendextend/reference/set.html" class="external-link">set</a></span><span class="op">(</span><span class="st">"leaves_cex"</span>, <span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>           <span class="fu"><a href="https://talgalili.github.io/dendextend/reference/set.html" class="external-link">set</a></span><span class="op">(</span><span class="st">"leaves_col"</span>, <span class="st">"purple"</span><span class="op">)</span>,</span>
<span>         dend_cols_extend <span class="op">=</span> <span class="va">.</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>           <span class="fu"><a href="https://talgalili.github.io/dendextend/reference/highlight_branches.html" class="external-link">highlight_branches_col</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>           <span class="co"># Node options</span></span>
<span>           <span class="fu"><a href="https://talgalili.github.io/dendextend/reference/set.html" class="external-link">set</a></span><span class="op">(</span><span class="st">"nodes_pch"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">16</span>, <span class="fl">17</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>           <span class="fu"><a href="https://talgalili.github.io/dendextend/reference/set.html" class="external-link">set</a></span><span class="op">(</span><span class="st">"nodes_cex"</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>           <span class="fu"><a href="https://talgalili.github.io/dendextend/reference/set.html" class="external-link">set</a></span><span class="op">(</span><span class="st">"nodes_col"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="clustering_files/figure-html/unnamed-chunk-7-1.png" alt="mtcars correlation heatmap with clustered rows and columns. The row dendrogram is red in one half and black in the other. The black side has a thicker linewidth and two branches are dashed at the segments closest to the heatmap. All leaves are purple unfilled circles and the rest of the nodes are orange and filled circles. The column dendrogram is coloured with the viridis scale shifting gradually as it gets closer to the heatmap. Nodes are a mix of different shapes (squares, circles, triangles), colours (black, blue, red, green, cyan) and sizes." width="700"></p>
<p>Leaves can be reordered using functions like <code>ladderize</code>
or <code>rotate</code>, though it is not recommended to do for only one
dimension if the matrix is symmetric as the diagonal may end up in
strange places. Triangular layouts are not supported if the clustering
causes the matrix to become asymmetric.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plt1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gghm.html">gghm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span>, <span class="op">]</span><span class="op">)</span>, cluster_rows <span class="op">=</span> <span class="cn">TRUE</span>, na_remove <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># Remove NaNs introduced by scaling</span></span>
<span><span class="va">plt2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gghm.html">gghm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span>, <span class="op">]</span><span class="op">)</span>, cluster_rows <span class="op">=</span> <span class="cn">TRUE</span>, na_remove <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>             <span class="co"># dendextend::rotate() to flip the order of rows</span></span>
<span>             dend_rows_extend <span class="op">=</span> <span class="va">.</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://talgalili.github.io/dendextend/reference/rotate.html" class="external-link">rotate</a></span><span class="op">(</span><span class="fl">5</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plt1</span> <span class="op">/</span> <span class="va">plt2</span></span></code></pre></div>
<p><img src="clustering_files/figure-html/unnamed-chunk-8-1.png" alt="Two heatmaps of rows 11 to 15 of mtcars. Both have clustered rows, but the second plot has its rows in the opposite order compared to the first plot." width="700"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Only the rows are reordered, causing the matrix to become asymmetric</span></span>
<span><span class="co"># If the layout were triangular (or mixed), the warning would be slightly different</span></span>
<span><span class="co"># and the same plot as below would be produced (forced full layout).</span></span>
<span><span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">mtcars</span>, cluster_rows <span class="op">=</span> <span class="cn">TRUE</span>, cluster_cols <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>         dend_rows_extend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ladderize <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: The clustering has ordered rows and columns differently and caused the matrix</span></span>
<span><span class="co">#&gt; to become asymmetric. The diagonal may be scrambled due to the unequal row and</span></span>
<span><span class="co">#&gt; column orders.</span></span></code></pre></div>
<p><img src="clustering_files/figure-html/unnamed-chunk-9-1.png" alt="Correlation heatmap of mtcars. Both the rows and columns are clustered, but the dendrograms have ordered the data differently causing the cells that would normally lie on the diagonal to be spread away from the diagonal. Those cells are still labelled with the column names." width="700"></p>
<p>Finally, since <code>cluster_rows</code> and
<code>cluster_cols</code> can take <code>dendrogram</code> objects, it
is possible to do the <code>dendextend</code> customisation externally.
<code>dend_rows_extend</code> and <code>dend_cols_extend</code> are
applied on top of that, meaning that the two approaches can be
combined.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Cluster data before</span></span>
<span><span class="va">clust1</span> <span class="op">&lt;-</span> <span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/dendrogram.html" class="external-link">as.dendrogram</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># Apply some dendextend functions</span></span>
<span><span class="va">clust2</span> <span class="op">&lt;-</span> <span class="va">clust1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://talgalili.github.io/dendextend/reference/highlight_branches.html" class="external-link">highlight_branches_col</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://talgalili.github.io/dendextend/reference/set.html" class="external-link">set</a></span><span class="op">(</span><span class="st">"nodes_pch"</span>, <span class="fl">20</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://talgalili.github.io/dendextend/reference/set.html" class="external-link">set</a></span><span class="op">(</span><span class="st">"nodes_col"</span>, <span class="st">"green"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://talgalili.github.io/dendextend/reference/set.html" class="external-link">set</a></span><span class="op">(</span><span class="st">"nodes_cex"</span>, <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://talgalili.github.io/dendextend/reference/set.html" class="external-link">set</a></span><span class="op">(</span><span class="st">"leaves_pch"</span>, <span class="fl">18</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://talgalili.github.io/dendextend/reference/set.html" class="external-link">set</a></span><span class="op">(</span><span class="st">"leaves_col"</span>, <span class="st">"yellow"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://talgalili.github.io/dendextend/reference/set.html" class="external-link">set</a></span><span class="op">(</span><span class="st">"leaves_cex"</span>, <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">mtcars</span>, cluster_rows <span class="op">=</span> <span class="va">clust1</span>, cluster_cols <span class="op">=</span> <span class="va">clust2</span>,</span>
<span>         <span class="co"># Increase height and linewidth for visibility</span></span>
<span>         dend_height <span class="op">=</span> <span class="fl">.6</span>, dend_lwd <span class="op">=</span> <span class="fl">1</span>,</span>
<span>         <span class="co"># Apply some customisation to the row dendrogram too</span></span>
<span>         dend_rows_extend <span class="op">=</span> <span class="va">.</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://talgalili.github.io/dendextend/reference/raise.dendrogram.html" class="external-link">raise.dendrogram</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>           <span class="co"># Rotating the row dendrogram of a symmetric matrix to be in the</span></span>
<span>           <span class="co"># reverse order will give a diagonal that runs from the bottom left</span></span>
<span>           <span class="co"># to the top right, but a warning will still be produced. Mixed layouts </span></span>
<span>           <span class="co"># allow for such diagonals without warnings</span></span>
<span>           <span class="fu"><a href="https://talgalili.github.io/dendextend/reference/rotate.html" class="external-link">rotate</a></span><span class="op">(</span><span class="fl">11</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: The clustering has ordered rows and columns differently and caused the matrix</span></span>
<span><span class="co">#&gt; to become asymmetric. The diagonal may be scrambled due to the unequal row and</span></span>
<span><span class="co">#&gt; column orders.</span></span></code></pre></div>
<p><img src="clustering_files/figure-html/unnamed-chunk-10-1.png" alt="A mtcars correlation heatmap with clustered rows and columns. The diagonal runs from bottom left to top right. The dendrograms have thick lines, and the lowest split in the row dendrogram has been raised. The column dendrogram colours shift from dark green to yellow the closer to the heatmap it gets and the nodes are green circles while the leaves are yellow diamonds." width="700"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Leo Dahl.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>

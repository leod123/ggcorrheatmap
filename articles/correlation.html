<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Correlation heatmaps â€¢ ggcorrheatmap</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Correlation heatmaps">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ggcorrheatmap</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/heatmap.html">Making a heatmap</a></li>
    <li><a class="dropdown-item" href="../articles/correlation.html">Correlation heatmaps</a></li>
    <li><a class="dropdown-item" href="../articles/annotation.html">Annotation</a></li>
    <li><a class="dropdown-item" href="../articles/clustering.html">Clustering</a></li>
    <li><a class="dropdown-item" href="../articles/mixed.html">Mixed layouts</a></li>
    <li><a class="dropdown-item" href="../articles/legends.html">Scales and legends</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/leod123/ggcorrheatmap/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Correlation heatmaps</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/leod123/ggcorrheatmap/blob/main/vignettes/articles/correlation.Rmd" class="external-link"><code>vignettes/articles/correlation.Rmd</code></a></small>
      <div class="d-none name"><code>correlation.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/leod123/ggcorrheatmap" class="external-link">ggcorrheatmap</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span></code></pre></div>
<p>Correlation heatmaps can be made easily using the
<code><a href="../reference/ggcorrhm.html">ggcorrhm()</a></code> function. <code><a href="../reference/ggcorrhm.html">ggcorrhm()</a></code> is a wrapper
for (and shares most of its arguments with) <code><a href="../reference/gghm.html">gghm()</a></code> and
calculates the correlation matrix of the input to make a heatmap with
<code><a href="../reference/gghm.html">gghm()</a></code>. If one matrix is provided the column-column
correlations are plotted. If two matrices are provided, the correlations
between the columns in the two matrices are plotted. By using
<code>cor_method</code> and <code>cor_use</code>, different
<code>method</code> and <code>use</code> arguments can be passed to
<code><a href="https://rdrr.io/r/stats/cor.html" class="external-link">stats::cor()</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span></code></pre></div>
<p><img src="correlation_files/figure-html/symmetric%20correlation%20heatmap-1.png" alt="A heatmap depicting the correlation matrix of the columns in the mtcars dataset. The colour scale goes from -1 to 1 with colours ranging from blue (skyblue2) to white to red (sienna2)." width="700"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span>, <span class="op">-</span><span class="fl">5</span><span class="op">]</span>, <span class="va">mtcars</span><span class="op">)</span></span></code></pre></div>
<p><img src="correlation_files/figure-html/asymmetric%20correlation%20heatmap-1.png" alt="A heatmap showing the correlation between the columns in the iris data (on the rows) and the columns in mtcars (on the columns)." width="768"></p>
<div class="section level2">
<h2 id="changing-the-colours">Changing the colours<a class="anchor" aria-label="anchor" href="#changing-the-colours"></a>
</h2>
<p><code><a href="../reference/ggcorrhm.html">ggcorrhm()</a></code> sets the fill scale to use
<code><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">ggplot2::scale_fill_gradient2()</a></code> with limits set to [-1, 1].
Unique to <code><a href="../reference/ggcorrhm.html">ggcorrhm()</a></code> are the arguments <code>high</code>,
<code>mid</code> and <code>low</code> to control the legend colours.
Like with <code><a href="../reference/gghm.html">gghm()</a></code>, the <code>bins</code> and
<code>limits</code> arguments create a binned scale and change the
limits, respectively.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">mtcars</span>, high <span class="op">=</span> <span class="st">"green"</span>, low <span class="op">=</span> <span class="st">"magenta"</span>, mid <span class="op">=</span> <span class="st">"yellow"</span>, bins <span class="op">=</span> <span class="fl">4L</span><span class="op">)</span></span></code></pre></div>
<p><img src="correlation_files/figure-html/changing%20colour-1.png" alt="A heatmap of the mtcars correlation matrix. The colour scale is changed to consist of 4 bins and the colours go from magenta to green." width="700"></p>
<p>If complete control is needed, the <code>col_scale</code> argument
can be used to overwrite the default scale. This can be a string
specifying a Brewer or Viridis scale, or a <code>ggplot2</code> scale
object.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plt1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">mtcars</span>, col_scale <span class="op">=</span> <span class="st">"RdYlGn"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Arguments like bins and limits still work with brewer and viridis scales</span></span>
<span><span class="va">plt2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">mtcars</span>, col_scale <span class="op">=</span> <span class="st">"PuOr"</span>, bins <span class="op">=</span> <span class="fl">5L</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plt1</span> <span class="op">+</span> <span class="va">plt2</span></span></code></pre></div>
<p><img src="correlation_files/figure-html/unnamed-chunk-2-1.png" alt="Two correlation heatmaps of mtcars. The first one uses the Brewer RdYlGn palette on a continuous scale, while the second one uses the Brewer PuOr scale with the data put into discrete bins." width="960"></p>
</div>
<div class="section level2">
<h2 id="changing-the-layout">Changing the layout<a class="anchor" aria-label="anchor" href="#changing-the-layout"></a>
</h2>
<p>For symmetric heatmaps, the <code>layout</code> argument can be used
to get triangular layouts. The possible layouts are full matrix, top
left, top right, bottom left, and bottom right. Note that while the top
right and bottom left layouts are just the top right and bottom left
triangles of the symmetric matrix, top left and bottom right layouts are
actually the bottom left and top right layouts with a flipped y axis to
retain the diagonal. This means that some layouts may have the y axis
order reversed.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plt1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">mtcars</span>, layout <span class="op">=</span> <span class="st">"topleft"</span><span class="op">)</span></span>
<span><span class="co"># The diagonal is displayed by default but can be hidden using the `include_diag` argument</span></span>
<span><span class="co"># Layouts can be specified by the first letters e.g. br, tl, f (for full), w (whole, same as full)</span></span>
<span><span class="va">plt2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">mtcars</span>, layout <span class="op">=</span> <span class="st">"br"</span>, include_diag <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plt1</span> <span class="op">+</span> <span class="va">plt2</span></span></code></pre></div>
<p><img src="correlation_files/figure-html/heatmap%20layouts-1.png" alt="Two heatmap of the mtcars correlation matrix. The first plot shows only the top left triangle including the diagonal with names written on it (diagonal running bottom left to top right and row labels reversed compared to the previous heatmaps). The second figure has only the bottom right triangle, but without the diagonal (names are written where the diagonal would be)." width="960"></p>
</div>
<div class="section level2">
<h2 id="label-customisation">Label customisation<a class="anchor" aria-label="anchor" href="#label-customisation"></a>
</h2>
<p>For symmetric matrices, the axis names are drawn on the diagonal. The
<code>show_names_diag</code>, <code>show_names_x</code> and
<code>show_names_y</code> arguments control where names should be
drawn.</p>
<p>The looks of the names displayed on the diagonal of a symmetric
matrix can be adjusted with the <code>names_diag_params</code> argument,
which takes a named list of parameters to pass to
<code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">ggplot2::geom_text()</a></code>. For names displayed on the x and y
axes, use <code><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">ggplot2::theme()</a></code> on the generated plot object to
change the appearance.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plt1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">mtcars</span>, layout <span class="op">=</span> <span class="st">"bl"</span>, legend_order <span class="op">=</span> <span class="cn">NA</span>, include_diag <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 names_diag_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>                   angle <span class="op">=</span> <span class="fl">45</span>, vjust <span class="op">=</span> <span class="fl">0.5</span>, hjust <span class="op">=</span> <span class="fl">0.5</span>, colour <span class="op">=</span> <span class="st">"magenta"</span></span>
<span>                 <span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Also take vectorised input</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">plt2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">mtcars</span>, layout <span class="op">=</span> <span class="st">"br"</span>, include_diag <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 names_diag_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>                   angle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="fl">45</span>, <span class="fl">9</span><span class="op">)</span>, <span class="fl">90</span><span class="op">)</span>,</span>
<span>                   hjust <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="fl">10</span><span class="op">)</span>, <span class="fl">0.3</span><span class="op">)</span>,</span>
<span>                   colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"green"</span>, <span class="st">"blue"</span><span class="op">)</span>, <span class="fl">11</span>, <span class="cn">TRUE</span><span class="op">)</span></span>
<span>                 <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plt1</span> <span class="op">+</span> <span class="va">plt2</span></span></code></pre></div>
<p><img src="correlation_files/figure-html/unnamed-chunk-3-1.png" alt="Two mtcars correlation heatmaps with the bottom left and bottom right triangles and no diagonals. In the first plot, the names on the diagonal are at a 45 degree angle and the text is magenta-coloured. The second plot has the names angled 45 degrees in the other direction apart from the names at the top and bottom which are angled at 90 and 0 degrees, respectively. The text colour is picked randomly from red, green, and blue." width="960"></p>
</div>
<div class="section level2">
<h2 id="legend-position">Legend position<a class="anchor" aria-label="anchor" href="#legend-position"></a>
</h2>
<p>The legend can be moved around by adding to the theme of the output
plot using <code><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">ggplot2::theme()</a></code>. Use the
<code>legend.position.inside</code> argument to move the legend to the
plotting area to make use of the empty space of triangular layouts.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plt1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span>,</span>
<span>        legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>vjust <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">plt2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">mtcars</span>, layout <span class="op">=</span> <span class="st">"br"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"inside"</span>,</span>
<span>        legend.position.inside <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.75</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plt1</span> <span class="op">+</span> <span class="va">plt2</span></span></code></pre></div>
<p><img src="correlation_files/figure-html/legend%20position-1.png" alt="Two mtcars correlation heatmaps. In the first one the legend has been moved above the heatmap and is horizontal. In the second the bottom right triangle is drawn and the legend is placed in the empty space where the top left triangle would be drawn." width="960"></p>
</div>
<div class="section level2">
<h2 id="clustering-and-annotation">Clustering and annotation<a class="anchor" aria-label="anchor" href="#clustering-and-annotation"></a>
</h2>
<p>Just like with <code><a href="../reference/gghm.html">gghm()</a></code>, the heatmap can be clustered and
annotated. Triangular layouts limit the positions of annotation and
dendrograms to the non-empty sides of the heatmap.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="co"># Make a correlation heatmap with a triangular layout, annotations and clustering</span></span>
<span><span class="va">row_annot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span>,</span>
<span>                        annot1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span>, <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                        annot2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">mtcars</span>, layout <span class="op">=</span> <span class="st">"tl"</span>,</span>
<span>         cluster_rows <span class="op">=</span> <span class="cn">TRUE</span>, cluster_cols <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>         show_dend_rows <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>         annot_rows_df <span class="op">=</span> <span class="va">row_annot</span>,</span>
<span>         annot_rows_names_side <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span></code></pre></div>
<p><img src="correlation_files/figure-html/clustering%20and%20annotation-1.png" alt="A top left triangle correlation heatmap of mtcars. The rows and columns have been clustered and a dendrogram is drawn above the heatmap. On the left side are two thinner columns containing continuous and categorical annotation." width="700"></p>
</div>
<div class="section level2">
<h2 id="cell-text">Cell text<a class="anchor" aria-label="anchor" href="#cell-text"></a>
</h2>
<p>The <code>cell_labels</code> argument labels cells with their values
or some user-supplied values, explained more in the <a href="heatmap.html#cell-labels">heatmap article</a>. If
<code>cell_labels</code> is a matrix/data frame it should be in the
shape of the matrix being plotted (using the same row and column names),
which for <code>ggcorrhm</code> is the correlation matrix. To keep in
mind for triangular layouts is that the top left or bottom right
triangles will display the bottom left or top right triangles with the y
axis order flipped, and this is reflected in the cell labels too.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">lab_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">121</span>, nrow <span class="op">=</span> <span class="fl">11</span>, ncol <span class="op">=</span> <span class="fl">11</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plt_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tl"</span>, <span class="st">"tr"</span>, <span class="st">"bl"</span>, <span class="st">"br"</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">lt</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Play a bit with the legend for the last plot</span></span>
<span>  <span class="va">legend_order</span> <span class="op">&lt;-</span> <span class="kw">if</span> <span class="op">(</span><span class="va">lt</span> <span class="op">==</span> <span class="st">"br"</span><span class="op">)</span> <span class="fl">1</span> <span class="kw">else</span> <span class="cn">NA</span></span>
<span>  <span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">mtcars</span>, layout <span class="op">=</span> <span class="va">lt</span>, legend_order <span class="op">=</span> <span class="va">legend_order</span>,</span>
<span>           cell_labels <span class="op">=</span> <span class="va">lab_mat</span>, show_names_diag <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"inside"</span>,</span>
<span>          legend.position.inside <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">1.075</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html" class="external-link">wrap_plots</a></span><span class="op">(</span><span class="va">plt_list</span><span class="op">)</span></span></code></pre></div>
<p><img src="correlation_files/figure-html/unnamed-chunk-4-1.png" alt="Four triangulra mtcars correlation heatmaps arranged in a 2x2 grid (top left triangle in the top left, top right in the top right etc) so that a diamond-shaped gap is formed in the middle. The cells are labelled from 1 to 121, filling the matrix rowwise. The top left and bottom left heatmaps are the same but with the y-axes flipped. The same relationship is true for the top right and bottom right heatmaps. In the middle (in the gap between the four plots) is one legend." width="768"></p>
</div>
<div class="section level2">
<h2 id="cell-shape">Cell shape<a class="anchor" aria-label="anchor" href="#cell-shape"></a>
</h2>
<p>Correlation heatmaps are sometimes plotted with circles. Passing a
value from 1 to 25 to the <code>mode</code> argument allows for
different cell shapes. Shapes 21-25 support filling and use fill scales
while 1-20 are not filled and use colour scales (relevant if a scale
object is passed). The shape size is set to vary between the values in
the <code>size_range</code> argument (not found in <code><a href="../reference/gghm.html">gghm()</a></code>),
scaling with the absolute value of the correlation.
<code>size_scale</code> can be provided to overwrite this behaviour. The
size legend is hidden by default when using <code><a href="../reference/ggcorrhm.html">ggcorrhm()</a></code> as
it would only show the absolute values of the correlations (but the
legend can be shown with the <code>legend_order</code> argument if
necessary).</p>
<p>Setting <code>mode</code> to â€˜textâ€™ writes the values in empty cells,
with the text colour scaling with the correlation values.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># If mode is a number, the R pch symbols are used, meaning 21 produces filled circles.</span></span>
<span><span class="va">plt1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">mtcars</span>, mode <span class="op">=</span> <span class="fl">21</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"mode = 21"</span><span class="op">)</span></span>
<span><span class="co"># It is also possible to use shapes other than circles. Only 21-25 support filling.</span></span>
<span><span class="co"># Change the size range using the size_range argument</span></span>
<span><span class="va">plt2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">mtcars</span>, mode <span class="op">=</span> <span class="fl">23</span>, size_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">7</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Can add a grid in the background with ggplot2::theme()</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.grid.major <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"mode = 23"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plt1</span> <span class="op">+</span> <span class="va">plt2</span></span></code></pre></div>
<p><img src="correlation_files/figure-html/cell%20shape-1.png" alt="Two mtcars correlation heatmaps. The first one has circles instead of cells. The colour scales with the correlation and the size with the absolute value of the correlation. The second plot has squares (diamonds) and a major grid is added in the background." width="960"></p>
<p>Itâ€™s also possible to draw mixed layouts by providing two values to
<code>layout</code> and <code>mode</code>. See the <a href="mixed.html">mixed layouts</a> article for more details.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Default modes for mixed layouts is 'heatmap' and 'text'</span></span>
<span><span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">mtcars</span>, layout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tr"</span>, <span class="st">"bl"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="correlation_files/figure-html/unnamed-chunk-5-1.png" alt="mtcars heatmap where the top right triangle (and the diagonal) has filled cells and the bottom left triangle has cells containing text instead. The text shows the correlation values and the colour scales with the correlation like the cells in the other triangle." width="700"></p>
</div>
<div class="section level2">
<h2 id="p-values">P-values<a class="anchor" aria-label="anchor" href="#p-values"></a>
</h2>
<p><code><a href="../reference/ggcorrhm.html">ggcorrhm()</a></code> adds support for correlation p-values which
can be calculated by setting the <code>p_values</code> argument to
<code>TRUE</code>. The values can be adjusted for multiple testing by
passing a string specifying the adjustment method to the
<code>p_adjust</code> argument. If the correlation matrix is symmetric,
the diagonal is excluded and only half of the off-diagonal values are
used for the adjustment. The calculated p-values will be included in the
data if <code>return_data</code> is <code>TRUE</code>. P-values and
adjusted p-values for the correlations of the diagonal in a symmetric
matrix are set to 0 as the correlations are always 1.</p>
<p>By default, cells are marked with asterisks if <code>p_values</code>
is <code>TRUE</code>. The <code>p_thresholds</code> argument controls
the p-value thresholds. <code>p_thresholds</code> must be NULL (for no
thresholds or symbols) or a named numeric vector where the values
specify the thresholds (in ascending order) and the names are the
symbols to use when an adjusted p-value is below each threshold.
<code><a href="https://rdrr.io/r/stats/symnum.html" class="external-link">stats::symnum()</a></code> is used to convert p-values and the last
value of <code>p_thresholds</code> must be 1 (or any higher number) to
set the upper bound. By default, <code>p_thresholds</code> is set to be
<code>c("***" = 0.001, "**" = 0.01, "*" = 0.05", 1)</code>. As can be
seen, 1 is left unnamed so that any p-values between 0.05 and 1 are
unmarked.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># P-value symbols added to the plot</span></span>
<span><span class="va">plt1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">mtcars</span>, p_values <span class="op">=</span> <span class="cn">TRUE</span>, p_adjust <span class="op">=</span> <span class="st">"bonferroni"</span><span class="op">)</span></span>
<span><span class="co"># Changing the symbols</span></span>
<span><span class="va">plt2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">mtcars</span>, p_values <span class="op">=</span> <span class="cn">TRUE</span>, p_adjust <span class="op">=</span> <span class="st">"bonferroni"</span>,</span>
<span>                 p_thresholds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"+"</span> <span class="op">=</span> <span class="fl">0.01</span>, <span class="st">"*"</span> <span class="op">=</span> <span class="fl">0.05</span>, <span class="st">"ns"</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plt1</span> <span class="op">+</span> <span class="va">plt2</span></span></code></pre></div>
<p><img src="correlation_files/figure-html/unnamed-chunk-6-1.png" alt="Two mtcars correlation heatmaps. The cells are coloured by correlation and contain text that depends on the p-values of the correlation coefficients. In the first one cells are marked with up to three asterisks. The second plot instead has a mix of cells with a plus symbol, an asterisk, and 'ns' written in them." width="960"></p>
<p>In a mixed layout it is possible to display p-values in only half of
the plot by passing a vector or list of length two to the
<code>p_values</code> argument. If <code>cell_labels</code> is
<code>TRUE</code> (so that correlation values are written in the cells),
the symbols from <code>p_thresholds</code> are added at the end of the
correlation values.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># P-values only in the bottom right, mode 'none' for labels with empty background</span></span>
<span><span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">mtcars</span>, layout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tl"</span>, <span class="st">"br"</span><span class="op">)</span>, mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hm"</span>, <span class="st">"none"</span><span class="op">)</span>, p_adjust <span class="op">=</span> <span class="st">"bonferroni"</span>,</span>
<span>         p_values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span>, cell_labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="correlation_files/figure-html/unnamed-chunk-7-1.png" alt="A mtcars correlation heatmaps with filled cells in the top left and labelled white cells in the bottom right. There are correlation values written in the bottom right, with asterisks signifying the p-value." width="700"></p>
<p>It is also possible to write out the p-values instead of correlation
values by setting both <code>cell_labels</code> and
<code>cell_label_p</code> to <code>TRUE</code>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># P-values and labels only in one half, correlation labels in the other</span></span>
<span><span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">mtcars</span>, layout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tl"</span>, <span class="st">"br"</span><span class="op">)</span>, mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hm"</span>, <span class="st">"none"</span><span class="op">)</span>, p_adjust <span class="op">=</span> <span class="st">"bonferroni"</span>,</span>
<span>         p_values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span>, cell_labels <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>         cell_label_p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="correlation_files/figure-html/unnamed-chunk-8-1.png" alt="A mtcars correlation heatmaps with filled cells in the top left and labelled white cells in the bottom right. There are labels in both triangles; correlation values in the top left and p-values with asterisks in the bottom right." width="700"></p>
<p>This is also carried over to â€˜textâ€™ mode.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Same as previous but text mode</span></span>
<span><span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">mtcars</span>, layout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tl"</span>, <span class="st">"br"</span><span class="op">)</span>, mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hm"</span>, <span class="st">"text"</span><span class="op">)</span>, p_adjust <span class="op">=</span> <span class="st">"bonferroni"</span>,</span>
<span>         p_values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>         <span class="co"># In text mode the labels are displayed regardless so cell_labels can be FALSE</span></span>
<span>         cell_labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>         cell_label_p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="correlation_files/figure-html/unnamed-chunk-9-1.png" alt="A mtcars correlation heatmaps with filled cells in the top left and labelled white cells in the bottom right. There are labels in both triangles; correlation values in the top left and p-values with asterisks in the bottom right. The p-value labels are coloured with the same scale as the filled cells in the top left triangle (scaling with the correlation values)." width="700"></p>
<p>By returning the data and using <code>ggplot2</code> functions it is
possible to be more creative with the p-value marking than
<code><a href="../reference/ggcorrhm.html">ggcorrhm()</a></code> allows out of the box.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">mtcars</span>, p_values <span class="op">=</span> <span class="cn">TRUE</span>, p_thresholds <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>              p_adjust <span class="op">=</span> <span class="st">"bonferroni"</span>, return_data <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>              layout <span class="op">=</span> <span class="st">"br"</span>, include_diag <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">p</span><span class="op">$</span><span class="va">plot_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">p</span><span class="op">$</span><span class="va">plot_data</span>,</span>
<span>                      p_lty <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">p_adj</span> <span class="op">&lt;</span> <span class="fl">0.05</span> <span class="op">~</span> <span class="fl">1</span>, <span class="cn">TRUE</span> <span class="op">~</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>                      p_lwd <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">p_adj</span> <span class="op">&lt;</span> <span class="fl">0.05</span> <span class="op">~</span> <span class="fl">1</span>, <span class="cn">TRUE</span> <span class="op">~</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>                      p_size <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">p_adj</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">mtcars</span>, border_lty <span class="op">=</span> <span class="va">p</span><span class="op">$</span><span class="va">plot_data</span><span class="op">$</span><span class="va">p_lty</span>, border_lwd <span class="op">=</span> <span class="va">p</span><span class="op">$</span><span class="va">plot_data</span><span class="op">$</span><span class="va">p_lwd</span>,</span>
<span>         layout <span class="op">=</span> <span class="st">"br"</span>, include_diag <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>size <span class="op">=</span> <span class="va">p_size</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">p</span><span class="op">$</span><span class="va">plot_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>               <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">p_adj</span> <span class="op">&lt;</span> <span class="fl">0.05</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">row</span><span class="op">)</span> <span class="op">!=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">col</span><span class="op">)</span><span class="op">)</span>,</span>
<span>             shape <span class="op">=</span> <span class="st">"*"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_size.html" class="external-link">scale_size</a></span><span class="op">(</span>range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>size <span class="op">=</span> <span class="st">"-log10(p_adj)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="correlation_files/figure-html/unnamed-chunk-10-1.png" alt="mtcars correlation heatmap showing the bottom right triangle. Some cells are marked with asterisks whose sizes scale with -log10 of the adjusted p-values. Those cells also have thick grey border. Other cells have thin, dotted borders." width="700"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">mtcars</span>, p_values <span class="op">=</span> <span class="cn">TRUE</span>, p_thresholds <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>              p_adjust <span class="op">=</span> <span class="st">"bonferroni"</span>, return_data <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>              layout <span class="op">=</span> <span class="st">"tl"</span>, include_diag <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">mtcars</span>, layout <span class="op">=</span> <span class="st">"tl"</span>, include_diag <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">p</span><span class="op">$</span><span class="va">plot_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>               <span class="co"># Mark cells above a threshold</span></span>
<span>               <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">p_adj</span> <span class="op">&gt;=</span> <span class="fl">0.05</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">row</span><span class="op">)</span> <span class="op">!=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">col</span><span class="op">)</span><span class="op">)</span>,</span>
<span>             shape <span class="op">=</span> <span class="fl">4</span>, size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code></pre></div>
<p><img src="correlation_files/figure-html/unnamed-chunk-11-1.png" alt="A top left correlation heatmap of mtcars. Some cells are marked with a large x (indicating that the adjusted p-value is above 0.05)." width="700"></p>
</div>
<div class="section level2">
<h2 id="other-packages">Other packages<a class="anchor" aria-label="anchor" href="#other-packages"></a>
</h2>
<p>A benefit of making the plot with <code>ggplot2</code> is the
possibility of modifying and arranging the plot using
<code>ggplot2</code> and its many extensions. <code>ggcorrheatmap</code>
is convenient for making simple correlation heatmaps, with options for
extensive customisation of the appearance and layout, and built-in
support for clustering (with dendrograms) and annotation. Another
package for making correlation heatmaps with <code>ggplot2</code> is
<code>ggcorrplot</code> which is faster and has more ways of visualising
p-values. If having the plot made with <code>ggplot2</code> is not
necessary, the <code>corrplot</code> package can make flexible
correlation plots with many alternative visualisations.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Leo Dahl.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>

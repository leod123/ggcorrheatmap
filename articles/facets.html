<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Facets • ggcorrheatmap</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Facets">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ggcorrheatmap</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/heatmap.html">Making a heatmap</a></li>
    <li><a class="dropdown-item" href="../articles/correlation.html">Correlation heatmaps</a></li>
    <li><a class="dropdown-item" href="../articles/annotation.html">Annotation</a></li>
    <li><a class="dropdown-item" href="../articles/clustering.html">Clustering</a></li>
    <li><a class="dropdown-item" href="../articles/facets.html">Facets</a></li>
    <li><a class="dropdown-item" href="../articles/mixed.html">Mixed layouts</a></li>
    <li><a class="dropdown-item" href="../articles/legends.html">Scales and legends</a></li>
    <li><a class="dropdown-item" href="../articles/tidy_input.html">Using tidy data</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/leod123/ggcorrheatmap/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Facets</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/leod123/ggcorrheatmap/blob/v0.2.0/vignettes/articles/facets.Rmd" class="external-link"><code>vignettes/articles/facets.Rmd</code></a></small>
      <div class="d-none name"><code>facets.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/leod123/ggcorrheatmap" class="external-link">ggcorrheatmap</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span></code></pre></div>
<p>Gaps can be introduced into heatmaps with the <code>split_rows</code>
and <code>split_cols</code> arguments (the gaps are made by adding
facets to the plot). The simplest way to use these arguments is to
provide numeric vectors with the indices of the positions to split at
(counting from the top for rows and left for columns).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plt1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gghm.html">gghm</a></span><span class="op">(</span><span class="va">mtcars</span>, legend_order <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plt2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gghm.html">gghm</a></span><span class="op">(</span><span class="va">mtcars</span>, legend_order <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>             split_rows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">20</span><span class="op">)</span>, split_cols <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plt1</span> <span class="op">+</span> <span class="va">plt2</span></span></code></pre></div>
<p><img src="facets_files/figure-html/unnamed-chunk-2-1.png" alt="Two heatmaps of the mtcars data. The second one has gaps after rows 10 and 20 and column 6." width="700"></p>
<p>Without facets, the heatmaps use <code><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">ggplot2::coord_fixed()</a></code>
to make the cells square. As this does not work with facets using free
scales, the cells will stretch with the plot when there are gaps.</p>
<p>When <code>split_rows</code> and <code>split_cols</code> are shorter
than the number of rows or columns, respectively, they work as shown
above. It is also possible to provide vectors of the same lengths as the
corresponding dimensions. In this case they are treated as the facet
memberships for the rows or columns and the facet names are displayed as
well. <code>split_rows_side</code> and <code>split_cols_side</code>
change the sides where the names are displayed.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gghm.html">gghm</a></span><span class="op">(</span><span class="va">mtcars</span>,</span>
<span>     <span class="co"># Two facets '123' and '456' for columns</span></span>
<span>     split_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">123</span>, <span class="fl">6</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">456</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span>,</span>
<span>     <span class="co"># Three facets 'AAA', 'BB', and 'C' for rows</span></span>
<span>     split_rows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"AAA"</span>, <span class="fl">10</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"BB"</span>, <span class="fl">10</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"C"</span>, <span class="fl">12</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="facets_files/figure-html/unnamed-chunk-3-1.png" alt="A heatmap of the mtcars data with gaps at rows 10 and 20 and column 6. The groups of rows created by the gaps are labelled AAA, BB, and C, while the column groups are labelled 123 and 456." width="700"></p>
<p>Rows or columns may end up in a different order compared to the input
depending on the facetting (e.g. disp is in the second facet in the
first plot below even though it’s the third column in the input). Within
each facet the rows/columns will be ordered as they were in the input as
far as possible. The facets themselves are ordered by the order of
appearance in the <code>split_rows</code> and <code>split_cols</code>
vectors. If they are factor vectors the levels will decide the
order.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Make a more jumbled facet membership vector</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">row_facets</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AAA"</span>, <span class="st">"BB"</span>, <span class="st">"C"</span><span class="op">)</span>, <span class="fl">32</span>, <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">col_facets</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">123</span>, <span class="fl">456</span><span class="op">)</span>, <span class="fl">11</span>, <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plt1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gghm.html">gghm</a></span><span class="op">(</span><span class="va">mtcars</span>, legend_order <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>             split_rows <span class="op">=</span> <span class="va">row_facets</span>,</span>
<span>             split_cols <span class="op">=</span> <span class="va">col_facets</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Make the second plot with a different facet order</span></span>
<span><span class="va">row_facets2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">row_facets</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BB"</span>, <span class="st">"AAA"</span>, <span class="st">"C"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">col_facets2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">col_facets</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"456"</span>, <span class="st">"123"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plt2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gghm.html">gghm</a></span><span class="op">(</span><span class="va">mtcars</span>, legend_order <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>             split_rows <span class="op">=</span> <span class="va">row_facets2</span>,</span>
<span>             split_cols <span class="op">=</span> <span class="va">col_facets2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plt1</span> <span class="op">+</span> <span class="va">plt2</span></span></code></pre></div>
<p><img src="facets_files/figure-html/unnamed-chunk-4-1.png" alt="Two mtcars heatmaps, the first one split at rows 12 and 23 and column 7. The column row groups are named C, BB, and AAA and the column groups 123 and 456. The second heatmap has the same splits but in a different order (BB, AAA, C in the rows and 456, 123 in the columns). The rows and columns are in a different order from the mtcars data due to being in different groups." width="700"></p>
<p>It is also possible to provide a named facet membership vector (where
the names are the row/column names of the input). The facet memberships
are then matched with the names so that the order does not matter. Below
is an example of facetting by clusters (which only bunches together the
rows or columns by cluster but does not reorder according to the
clustering within the clusters).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Perform hierarchical clustering and make clusters using the stats::cutree() function</span></span>
<span><span class="co"># Luckily the output is a named vector of cluster memberships</span></span>
<span><span class="va">row_clust</span> <span class="op">&lt;-</span> <span class="fu">cutree</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">col_clust</span> <span class="op">&lt;-</span> <span class="fu">cutree</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/gghm.html">gghm</a></span><span class="op">(</span><span class="va">mtcars</span>, scale_data <span class="op">=</span> <span class="st">"col"</span>,</span>
<span>     split_rows <span class="op">=</span> <span class="va">row_clust</span>,</span>
<span>     split_cols <span class="op">=</span> <span class="va">col_clust</span><span class="op">)</span></span></code></pre></div>
<p><img src="facets_files/figure-html/unnamed-chunk-5-1.png" alt="mtcars correlation heatmap with the rows in three groups and columns in two, based on clustering. The row groups are labelled 1, 2, and 3 and the columns 1 and 2." width="700"></p>
<p>When the heatmap is symmetric (for example a correlation heatmap), it
is recommended to specify facets using indices (or using the same facet
membership vector) as the heatmap may become asymmetric if the rows and
columns end up in a different order because of the facets.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Just using indices</span></span>
<span><span class="va">plt1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">mtcars</span>, split_rows <span class="op">=</span> <span class="fl">5</span>, split_cols <span class="op">=</span> <span class="fl">5</span>, legend_order <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Same facets"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Example 1: same memberships but facets in a different order</span></span>
<span><span class="va">facet_vec1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">facet_vec2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">facet_vec1</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2"</span>, <span class="st">"1"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">plt2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">mtcars</span>, legend_order <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                 split_rows <span class="op">=</span> <span class="va">facet_vec1</span>,</span>
<span>                 split_cols <span class="op">=</span> <span class="va">facet_vec2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Same facets but different order"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Make two random facet membership vectors</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">plt3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">mtcars</span>, legend_order <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                 split_rows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, <span class="fl">11</span>, <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                 split_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">11</span>, <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Different facets"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plt1</span> <span class="op">+</span> <span class="va">plt2</span> <span class="op">+</span> <span class="va">plt3</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>design <span class="op">=</span> <span class="st">"#AA#\nBBCC"</span><span class="op">)</span></span></code></pre></div>
<p><img src="facets_files/figure-html/unnamed-chunk-6-1.png" alt="Three mtcars correlation heatmaps. The first one has gaps at row 5 and column 5. The second one has the same splits but the column groups have switched place, resulting in the diagonal running from the top left to the bottom right in the top right and bottom left groups. The third heatmap has the row and column orders all jumbled and the diagonal not along the diagonal anymore." width="604.8"></p>
<p>If the symmetric heatmap uses a layout where the y axis is flipped
(top left or bottom right layouts), the rows are counted from the
bottom.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Two from the top</span></span>
<span><span class="va">plt1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">mtcars</span>, split_rows <span class="op">=</span> <span class="fl">2</span>, split_cols <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                 layout <span class="op">=</span> <span class="st">"bl"</span><span class="op">)</span></span>
<span><span class="co"># Two from the bottom</span></span>
<span><span class="va">plt2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">mtcars</span>, split_rows <span class="op">=</span> <span class="fl">2</span>, split_cols <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                 layout <span class="op">=</span> <span class="st">"br"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plt1</span> <span class="op">+</span> <span class="va">plt2</span></span></code></pre></div>
<p><img src="facets_files/figure-html/unnamed-chunk-7-1.png" alt="Two mtcars correlation heatmaps showing only the bottom left and bottom right triangle, respectively. The first one has a row split at row 2 and a column split at column 2. The second one has a column split at row 9 instead (2 from the bottom) with the columns in the opposite order compared to the first heatmap." width="768"></p>
<div class="section level2">
<h2 id="changing-facet-appearance">Changing facet appearance<a class="anchor" aria-label="anchor" href="#changing-facet-appearance"></a>
</h2>
<p><code>ggplot2</code> functions can be used to change the gap sizes
and how the facet names look.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Make gradient data for plotting</span></span>
<span><span class="va">plt_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">20</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">x</span> <span class="op">+</span> <span class="fl">19</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/gghm.html">gghm</a></span><span class="op">(</span><span class="va">plt_dat</span>,</span>
<span>     split_rows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, each <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>     split_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, each <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    <span class="co"># panel.spacing.x and .y + ggplot2::unit() for gap sizes</span></span>
<span>    panel.spacing.x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="st">"line"</span><span class="op">)</span>,</span>
<span>    panel.spacing.y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"line"</span><span class="op">)</span>,</span>
<span>    <span class="co"># strip.background.x and .y for changing the rectangles where the names are written</span></span>
<span>    strip.background.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"skyblue"</span>, colour <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>    strip.background.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"grey75"</span>, colour <span class="op">=</span> <span class="st">"grey50"</span>,</span>
<span>                                      linewidth <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="co"># strip.text.x and .y (adding the position can help) for text</span></span>
<span>    strip.text.x.bottom <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span>, colour <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span>,</span>
<span>    strip.text.y.right <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, angle <span class="op">=</span> <span class="fl">0</span>, colour <span class="op">=</span> <span class="st">"grey25"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="facets_files/figure-html/unnamed-chunk-8-1.png" alt="A 20x20 heatmap with a gradient of values going from low in the top left to high in the bottom right. The rows and columns are each divided into 4 facets named a, b, c, and d (rows) and A, B, C, and D (columns). The column gaps are larger than the row gaps. The row facet labels on the right are grey with dashed outlines and the column group labels at the bottom are light blue." width="700"></p>
<p>The <code>split_rows_side</code> and <code>split_cols_side</code>
arguments control the sides of the facet strips.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gghm.html">gghm</a></span><span class="op">(</span><span class="va">plt_dat</span>,</span>
<span>     split_rows_side <span class="op">=</span> <span class="st">"left"</span>, split_cols_side <span class="op">=</span> <span class="st">"top"</span>,</span>
<span>     split_rows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, each <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>     split_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, each <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    panel.spacing.x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="st">"line"</span><span class="op">)</span>,</span>
<span>    panel.spacing.y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"line"</span><span class="op">)</span>,</span>
<span>    strip.background.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"skyblue"</span>, colour <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>    strip.background.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"grey75"</span>, colour <span class="op">=</span> <span class="st">"grey50"</span>,</span>
<span>                                      linewidth <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>    strip.text.x.top <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span>, colour <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span>,</span>
<span>    strip.text.y.left <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, angle <span class="op">=</span> <span class="fl">0</span>, colour <span class="op">=</span> <span class="st">"grey25"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="facets_files/figure-html/unnamed-chunk-9-1.png" alt="The same heatmap as in the previous figure. The row and column facets labels are moved to the left and top, respectively." width="700"></p>
</div>
<div class="section level2">
<h2 id="clustering-and-annotation">Clustering and annotation<a class="anchor" aria-label="anchor" href="#clustering-and-annotation"></a>
</h2>
<p>If clustering is applied, <code>split_rows</code> and
<code>split_cols</code> work differently and only take single numeric
values. The number is given to <code><a href="https://rdrr.io/r/stats/cutree.html" class="external-link">stats::cutree()</a></code> to divide
the data into clusters that then define the facets of the plot. In this
case the dendrograms cannot be shown.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plt1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gghm.html">gghm</a></span><span class="op">(</span><span class="va">mtcars</span>, scale_data <span class="op">=</span> <span class="st">"col"</span>, col_scale <span class="op">=</span> <span class="st">"A"</span>,</span>
<span>             cluster_rows <span class="op">=</span> <span class="cn">TRUE</span>, cluster_cols <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plt2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gghm.html">gghm</a></span><span class="op">(</span><span class="va">mtcars</span>, scale_data <span class="op">=</span> <span class="st">"col"</span>, col_scale <span class="op">=</span> <span class="st">"A"</span>,</span>
<span>             cluster_rows <span class="op">=</span> <span class="cn">TRUE</span>, cluster_cols <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>             split_rows <span class="op">=</span> <span class="fl">3</span>, split_cols <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plt1</span> <span class="op">+</span> <span class="va">plt2</span></span></code></pre></div>
<p><img src="facets_files/figure-html/unnamed-chunk-10-1.png" alt="Two mtcars heatmaps with scaled columns and clustered in both directions. The first plot has dendrograms for the row and column clusterings. The second heatmap has no dendrograms but the rows and columns are grouped into 3 and 2 groups, respectively, highlighting clusters." width="700"></p>
<p>When annotation is added, the annotation will also be split into the
facets.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/gghm.html">gghm</a></span><span class="op">(</span><span class="va">volcano</span>,</span>
<span>     split_rows <span class="op">=</span> <span class="fl">45</span>,</span>
<span>     split_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">50</span>, by <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>     annot_rows_df <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">volcano</span><span class="op">)</span>,</span>
<span>                                b <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">volcano</span><span class="op">)</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>     annot_cols_df <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>c <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">volcano</span><span class="op">)</span>, <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                                d <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">volcano</span><span class="op">)</span>, <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>,</span>
<span>     <span class="co"># Make annotations more visible</span></span>
<span>     annot_size <span class="op">=</span> <span class="fl">1.5</span>, annot_dist <span class="op">=</span> <span class="fl">1</span>,</span>
<span>     <span class="co"># Remove row/col names, cell borders and legends</span></span>
<span>     show_names_x <span class="op">=</span> <span class="cn">FALSE</span>, show_names_y <span class="op">=</span> <span class="cn">FALSE</span>, border_col <span class="op">=</span> <span class="fl">0</span>, legend_order <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></code></pre></div>
<p><img src="facets_files/figure-html/unnamed-chunk-11-1.png" alt="A heatmap of the volcano data with 1 row gap in the middle and 5 column gaps (at around 10 column intervals). There are two row and two column annotations, both with splits like in the heatmap (1 in the row and 5 in the column annotations)." width="528"></p>
<p>When annotations exist in the rows while the columns are facetted (or
vice versa), the annotations are placed in the first or last facet
depending on the side. Unfortunately this means that the facet strip
will be stretched to fit the annotations too.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">facet_mem</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"B"</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"C"</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">mtcars</span>, split_rows <span class="op">=</span> <span class="va">facet_mem</span>, split_cols <span class="op">=</span> <span class="va">facet_mem</span>,</span>
<span>         annot_rows_df <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span>,</span>
<span>                                    a <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">11</span>, b <span class="op">=</span> <span class="fl">11</span><span class="op">:</span><span class="fl">1</span>, c <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">11</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>strip.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"pink"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="facets_files/figure-html/unnamed-chunk-12-1.png" alt="A correlation heatmap of mtcars. The rows and columns are split at indices 3 and 7 and there are three row annotations. The facets are labelled with pink rectangles. The right-most column facet stretches to include the row annotations too." width="700"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Leo Dahl.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>

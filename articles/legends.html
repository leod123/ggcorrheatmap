<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Scales and legends • ggcorrheatmap</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Scales and legends">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ggcorrheatmap</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.2.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/heatmap.html">Making a heatmap</a></li>
    <li><a class="dropdown-item" href="../articles/correlation.html">Correlation heatmaps</a></li>
    <li><a class="dropdown-item" href="../articles/annotation.html">Annotation</a></li>
    <li><a class="dropdown-item" href="../articles/clustering.html">Clustering</a></li>
    <li><a class="dropdown-item" href="../articles/mixed.html">Mixed layouts</a></li>
    <li><a class="dropdown-item" href="../articles/legends.html">Scales and legends</a></li>
    <li><a class="dropdown-item" href="../articles/tidy_input.html">Using tidy data</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/leod123/ggcorrheatmap/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Scales and legends</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/leod123/ggcorrheatmap/blob/main/vignettes/articles/legends.Rmd" class="external-link"><code>vignettes/articles/legends.Rmd</code></a></small>
      <div class="d-none name"><code>legends.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/leod123/ggcorrheatmap" class="external-link">ggcorrheatmap</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span>  <span class="co"># Arrange plots and legends</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/" class="external-link">cowplot</a></span><span class="op">)</span>    <span class="co"># For extracting and arranging legends</span></span></code></pre></div>
<div class="section level2">
<h2 id="scales">Scales<a class="anchor" aria-label="anchor" href="#scales"></a>
</h2>
<p>As explained in some of the other articles, the colour scale argument
<code>col_scale</code> takes NULL (for default scales), a character (for
Brewer and Viridis scales) and <code>ggplot2</code> scale objects. When
passing scale objects, make sure the correct aesthetic is used (fill or
colour/color depending on plotting mode).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plt1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gghm.html">gghm</a></span><span class="op">(</span><span class="va">volcano</span>, col_name <span class="op">=</span> <span class="st">"Default"</span>,</span>
<span>             border_col <span class="op">=</span> <span class="cn">NA</span>, show_names_x <span class="op">=</span> <span class="cn">FALSE</span>, show_names_y <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plt2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gghm.html">gghm</a></span><span class="op">(</span><span class="va">volcano</span>,</span>
<span>             <span class="co"># Brewer Spectral palette</span></span>
<span>             col_scale <span class="op">=</span> <span class="st">"A"</span>, col_name <span class="op">=</span> <span class="st">"Character"</span>,</span>
<span>             border_col <span class="op">=</span> <span class="cn">NA</span>, show_names_x <span class="op">=</span> <span class="cn">FALSE</span>, show_names_y <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plt3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gghm.html">gghm</a></span><span class="op">(</span><span class="va">volcano</span>,</span>
<span>             <span class="co"># Custom scale</span></span>
<span>             col_scale <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradient2</a></span><span class="op">(</span></span>
<span>               high <span class="op">=</span> <span class="st">"pink"</span>, mid <span class="op">=</span> <span class="st">"white"</span>, low <span class="op">=</span> <span class="st">"lightblue"</span>,</span>
<span>               midpoint <span class="op">=</span> <span class="fl">140</span>, name <span class="op">=</span> <span class="st">"Custom"</span></span>
<span>             <span class="op">)</span>,</span>
<span>             border_col <span class="op">=</span> <span class="cn">NA</span>, show_names_x <span class="op">=</span> <span class="cn">FALSE</span>, show_names_y <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plt1</span> <span class="op">+</span> <span class="va">plt2</span> <span class="op">+</span> <span class="va">plt3</span> <span class="op">&amp;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>        legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>vjust <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="legends_files/figure-html/unnamed-chunk-2-1.png" alt="Three heatmaps of the volcano data. The first one uses the default dark blue to light blue gradient for the cells, the second one uses the Viridis magma palette, and the third a custom scale going from light blue to white to pink." width="700"></p>
<p>This is also true for the annotation scale arguments
<code>annot_rows_col</code> and <code>annot_cols_col</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">row_annot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>,</span>
<span>                        Default <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,</span>
<span>                        Character <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,</span>
<span>                        Custom <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="va">row_annot_fill</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Default <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                       Character <span class="op">=</span> <span class="st">"Spectral"</span>,</span>
<span>                       Custom <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradient2</a></span><span class="op">(</span></span>
<span>                         high <span class="op">=</span> <span class="st">"pink"</span>, mid <span class="op">=</span> <span class="st">"white"</span>, low <span class="op">=</span> <span class="st">"lightblue"</span>,</span>
<span>                         midpoint <span class="op">=</span> <span class="fl">6</span></span>
<span>                       <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/gghm.html">gghm</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>,</span>
<span>     annot_rows_df <span class="op">=</span> <span class="va">row_annot</span>,</span>
<span>     annot_rows_col <span class="op">=</span> <span class="va">row_annot_fill</span>,</span>
<span>     <span class="co"># Make annotation larger and hide heatmap legend</span></span>
<span>     annot_size <span class="op">=</span> <span class="fl">1</span>,</span>
<span>     legend_order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">30</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="legends_files/figure-html/unnamed-chunk-3-1.png" alt="A heatmap of the first ten rows and five columns of mtcars. Three row annotations can be seen on the right side, the first one using the Viridis scale, the second one the Brewer Spectral, and the third one a custom scale going from light blue to white to pink." width="480"></p>
<p>When <code>col_scale</code> is a character, “rev_” or “_rev” can be
added to the beginning or end, respectively, to reverse the scale. This
also works for annotation scales.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">row_annot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"Default"</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">volcano</span><span class="op">)</span>,</span>
<span>                        <span class="st">"Reversed"</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">volcano</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">row_annot_colr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Default"</span> <span class="op">=</span> <span class="st">"A"</span>, <span class="st">"Reversed"</span> <span class="op">=</span> <span class="st">"A_rev"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/gghm.html">gghm</a></span><span class="op">(</span><span class="va">volcano</span>, show_names_x <span class="op">=</span> <span class="cn">FALSE</span>, show_names_y <span class="op">=</span> <span class="cn">FALSE</span>, border_col <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>     col_scale <span class="op">=</span> <span class="st">"rev_A"</span>, col_name <span class="op">=</span> <span class="st">"Reversed"</span>,</span>
<span>     annot_rows_df <span class="op">=</span> <span class="va">row_annot</span>,</span>
<span>     annot_rows_col <span class="op">=</span> <span class="va">row_annot_colr</span>,</span>
<span>     <span class="co"># Make the annotation larger for visibility</span></span>
<span>     annot_size <span class="op">=</span> <span class="fl">3</span>, annot_dist <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Change the margins a bit too</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">40</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="legends_files/figure-html/unnamed-chunk-4-1.png" alt="A heatmap of the volcano data with cells coloured using the Viridis magma palette but reversed so that low values are light and high are dark. Two row annotations are seen to the right, both have the same values but one is using the default magma palette and the other the reversed one." width="480"></p>
<p>The default scale for the main heatmap is different for
<code><a href="../reference/ggcorrhm.html">ggcorrhm()</a></code> as it assumes that correlations are plotted.
There are also more arguments to modify the scale, such as the colours
or binning.</p>
<p>When the plot is using a <a href="mixed.html">mixed layout</a>,
<code>col_scale</code> can also take a vector or list to apply different
scales to the different triangles.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plt_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">x</span> <span class="op">+</span> <span class="fl">9</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/gghm.html">gghm</a></span><span class="op">(</span><span class="va">plt_dat</span>, layout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tl"</span>, <span class="st">"br"</span><span class="op">)</span>,</span>
<span>     mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hm"</span>, <span class="st">"hm"</span><span class="op">)</span>,</span>
<span>     <span class="co"># For Viridis options, both the short and long versions work</span></span>
<span>     col_scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"magma"</span>, <span class="st">"RdYlGn"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="legends_files/figure-html/unnamed-chunk-5-1.png" alt="A heatmap of a 10x10 matrix with values arranged so that there is a gradient across the heatmap with low values in the bottom left and high values in the top right. The top left triangle uses the Viridis magma scale, while the bottom right triangle is using the Brewer RdYlGn palette." width="700"></p>
<p><code>col_scale</code> can still be one value to apply the same scale
to both triangles. This does not work for scale objects, as the two
triangles may use different aesthetics (fill or colour). This means that
there will be two colour legends for the main heatmap if the two
triangles use different aesthetics, even if they use the same colours.
<code><a href="../reference/ggcorrhm.html">ggcorrhm()</a></code> hides one of the legends by default and the <a href="legends.html#legend-order">legend order section</a> goes into more
detail on how this can be done.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gghm.html">gghm</a></span><span class="op">(</span><span class="va">plt_dat</span>, layout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tl"</span>, <span class="st">"br"</span><span class="op">)</span>,</span>
<span>     mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hm"</span>, <span class="st">"text"</span><span class="op">)</span>, col_scale <span class="op">=</span> <span class="st">"A"</span><span class="op">)</span></span></code></pre></div>
<p><img src="legends_files/figure-html/unnamed-chunk-6-1.png" alt="A heatmap of the same gradient data as the previous figure. The bottom right triangle now has coloured numbers (cell values) in the cells, using the same colour palette (Viridis magma) as the top left triangle. Two legends showing the same values and scale are on the right." width="700"></p>
<p>As also explained in the <a href="mixed.html#mixed-scales">mixed
layout</a> article, the scale-modifying arguments <code>bins</code>,
<code>na_col</code>, <code>limits</code>, and in <code><a href="../reference/ggcorrhm.html">ggcorrhm()</a></code>
also <code>high</code>, <code>mid</code>, <code>low</code>,
<code>midpoint</code>, and <code>size_range</code> can be applied
triangle-wise. If only one scale is provided but a scale-modifying
argument is applied differently per triangle, two scales are created
anyway.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Only one scale supplied, but it is split into two by</span></span>
<span><span class="co"># specifying two different binnings</span></span>
<span><span class="fu"><a href="../reference/gghm.html">gghm</a></span><span class="op">(</span><span class="va">plt_dat</span>, layout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tr"</span>, <span class="st">"bl"</span><span class="op">)</span>, mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hm"</span>, <span class="st">"hm"</span><span class="op">)</span>,</span>
<span>     col_scale <span class="op">=</span> <span class="st">"G"</span>, bins <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4L</span>, <span class="fl">8L</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="legends_files/figure-html/unnamed-chunk-7-1.png" alt="A 10x10 heatmap showing a gradient of values going from low values (starting at 1) in the top left to high values (up to 19) in the bottom right. The Viridis mako colour scale is used, shifting from black (low values) through blue and teal and ending at a pale green. The top right triangle of the heatmap is divided in to four bins while the bottom left triangle has eight." width="700"></p>
<p>When using scale objects, arguments that change scales and legends
such as <code>col_name</code> or <code>legend_order</code> and, for
<code><a href="../reference/ggcorrhm.html">ggcorrhm()</a></code>, <code>high</code>, <code>mid</code>,
<code>low</code> etc will be ignored to instead give the user full
control. This allows for more flexibility, such as changing the breaks,
bin sizes, or changing how out of bounds values are treated.</p>
<p>The default way <code>ggplot2</code> deals with values outside of the
scale range (out of bound value) is to replace them with NAs. The
<code>oob</code> argument of the scale functions can change the
behaviour, e.g. so that OOB values use the extreme colours of the
scale.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Normal limits</span></span>
<span><span class="va">plt1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gghm.html">gghm</a></span><span class="op">(</span><span class="va">plt_dat</span>, col_scale <span class="op">=</span> <span class="st">"RdYlGn_rev"</span>,</span>
<span>             cell_labels <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Narrower limits with handling of oob values</span></span>
<span><span class="va">plt2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gghm.html">gghm</a></span><span class="op">(</span><span class="va">plt_dat</span>, layout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tr"</span>, <span class="st">"bl"</span><span class="op">)</span>,</span>
<span>     mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hm"</span>, <span class="st">"hm"</span><span class="op">)</span>,</span>
<span>     col_scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>       <span class="co"># scale_fill_distiller to use Brewer palettes with continuous data</span></span>
<span>       <span class="co"># The default direction in distiller is -1, opposite of gghm</span></span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_distiller</a></span><span class="op">(</span></span>
<span>         palette <span class="op">=</span> <span class="st">"RdYlGn"</span>,</span>
<span>         <span class="co"># Values outside the limits are replaced with NAs</span></span>
<span>         limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">13</span><span class="op">)</span>,</span>
<span>         <span class="co"># Can then change the colour using the na.value argument</span></span>
<span>         <span class="co"># (corresponding to na_col in gghm)</span></span>
<span>         na.value <span class="op">=</span> <span class="st">"beige"</span></span>
<span>       <span class="op">)</span>,</span>
<span>       </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_distiller</a></span><span class="op">(</span></span>
<span>         palette <span class="op">=</span> <span class="st">"RdYlGn"</span>,</span>
<span>         limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">13</span><span class="op">)</span>,</span>
<span>         <span class="co"># Change oob strategy 'oob' argument</span></span>
<span>         <span class="co"># scales::squish assigns the extreme colours to values outside the range</span></span>
<span>         oob <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/oob.html" class="external-link">squish</a></span></span>
<span>       <span class="op">)</span></span>
<span>     <span class="op">)</span>, cell_labels <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plt1</span> <span class="op">+</span> <span class="va">plt2</span></span></code></pre></div>
<p><img src="legends_files/figure-html/unnamed-chunk-8-1.png" alt="Two figures of the gradient plot from before, now with low numbers in the top left and high numbers in the bottom right. The values are written in the cells with black text, showing that the gradient goes from 1 to 19. The first plot is simply coloured using the Brewer RdYlGn palette. The second plot uses the same palette, but the limits have been set to 7 and 13, narrowing the colour gradient that was visible in the first plot. Values outside the range are beige in the top right triangle, and green or red in the bottom left (corresponding to the lowest and highest ends of the scale)." width="960"></p>
<p>When binning scales with the <code>bins</code> argument, a number of
the ‘double’ class will prioritise breaks at nice numbers while an
integer will prioritise the number of bins. As a side note, out-of-bound
values with binned scales also default to using the ‘squish’ strategy
shown above.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Make plot data between -1 and 1 (like correlation data)</span></span>
<span><span class="va">plt_dat_cor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">x</span> <span class="op">+</span> <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simple mixed layout with mixed scales</span></span>
<span><span class="va">plt1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">plt_dat_cor</span>, cor_in <span class="op">=</span> <span class="cn">TRUE</span>, show_names_diag <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 border_col <span class="op">=</span> <span class="fl">0</span>, layout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tl"</span>, <span class="st">"br"</span><span class="op">)</span>, mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hm"</span>, <span class="st">"hm"</span><span class="op">)</span>,</span>
<span>                 col_scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Spectral"</span>, <span class="st">"H"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># With many scale arguments applied</span></span>
<span><span class="va">plt2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">plt_dat_cor</span>, cor_in <span class="op">=</span> <span class="cn">TRUE</span>, show_names_diag <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 border_col <span class="op">=</span> <span class="fl">0</span>, layout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tl"</span>, <span class="st">"br"</span><span class="op">)</span>, mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hm"</span>, <span class="st">"hm"</span><span class="op">)</span>,</span>
<span>                 col_scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Spectral"</span>, <span class="st">"H"</span><span class="op">)</span>,</span>
<span>                 <span class="co"># Provide a list as a mix of integer and float would be coerced if atomic vector</span></span>
<span>                 <span class="co"># Integer vs double, results in 11 and 10 bins</span></span>
<span>                 bins <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">11L</span>, <span class="fl">11</span><span class="op">)</span>,</span>
<span>                 <span class="co"># NULL to use default limits (-1 to 1 in ggcorrhm)</span></span>
<span>                 limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">.5</span>, <span class="fl">.5</span><span class="op">)</span>, <span class="cn">NULL</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plt1</span> <span class="op">+</span> <span class="va">plt2</span></span></code></pre></div>
<p><img src="legends_files/figure-html/unnamed-chunk-9-1.png" alt="Two 100x100 heatmaps with values from -1 to 1 in a gradient going from the bottom left to the top right. The heatmaps are using the Brewer Spectral colour scale in the top left triangle and the Viridis turbo scale in the bottom right. The first heatmap simply shows the gradient. The second heatmap has binned scales, with 11 bins in the top left triangle (with breaks at numbers with many decimals and limits at -0.5 and 0.5) and 10 bins in the bottom right triangle (evenly spaced at intervals of 0.2 going from -1 to 1)." width="960"></p>
<p>By using scale objects, breaks in both continuous and binned scales
can be put wherever desired.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plt_dat_cor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, length.out <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">x</span> <span class="op">+</span> <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plt1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">plt_dat_cor</span>, cor_in <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plt2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">plt_dat_cor</span>, cor_in <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                 layout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tr"</span>, <span class="st">"bl"</span><span class="op">)</span>,</span>
<span>                 mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hm"</span>, <span class="st">"hm"</span><span class="op">)</span>,</span>
<span>                 col_scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>                   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradient2</a></span><span class="op">(</span></span>
<span>                     <span class="co"># Mimic the default correlation scale</span></span>
<span>                     high <span class="op">=</span> <span class="st">"sienna2"</span>, mid <span class="op">=</span> <span class="st">"white"</span>, low <span class="op">=</span> <span class="st">"skyblue2"</span>,</span>
<span>                     <span class="co"># If not binned this only changes the legend but not the colours</span></span>
<span>                     breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">11</span><span class="op">)</span></span>
<span>                   <span class="op">)</span>,</span>
<span>                   <span class="co"># Binned scales can be made with e.g.</span></span>
<span>                   <span class="co"># scale_fill_fermenter, scale_fill_viridis_b, scale_fill_steps etc</span></span>
<span>                   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_steps.html" class="external-link">scale_fill_steps2</a></span><span class="op">(</span></span>
<span>                     high <span class="op">=</span> <span class="st">"sienna2"</span>, mid <span class="op">=</span> <span class="st">"white"</span>, low <span class="op">=</span> <span class="st">"skyblue2"</span>,</span>
<span>                     <span class="co"># Specify exact break points for bins</span></span>
<span>                     breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">0.75</span>, <span class="op">-</span><span class="fl">0.25</span>, <span class="fl">0</span>, <span class="fl">0.25</span>, <span class="fl">0.75</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>                   <span class="op">)</span></span>
<span>                 <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plt1</span> <span class="op">+</span> <span class="va">plt2</span></span></code></pre></div>
<p><img src="legends_files/figure-html/unnamed-chunk-10-1.png" alt="The same kind of gradient heatmaps as shown in the previous plots, but the values now range from -1 (top left) to 1 (bottom right). A diverging colour scale going from blue to white to red is used for the cell colours. The first plot simply shows off the gradient, while the second uses two binned scales ranging between -0.7 to 0.7. The scale in the top right triangle has five bins with breaks at 0.42, 0.14, -0.42, and -0.14, while the bottom left triangle has four bins with breaks at 0.4, 0, and -0.4." width="960"></p>
<p>Size scales can be customised as well. <code><a href="../reference/ggcorrhm.html">ggcorrhm()</a></code> uses
an absolute value transform for the default size scale and hides the
legend as it becomes inaccurate (as can be seen in the plot below).
<code>scale_size_area</code> can be passed to <code>size_scale</code> to
still scale with the absolute value and keep a meaningful legend, at the
cost of not being able to set the lower limit for the sizes.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">mtcars</span>, layout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tr"</span>, <span class="st">"bl"</span><span class="op">)</span>, mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">23</span>, <span class="fl">23</span><span class="op">)</span>,</span>
<span>         size_scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>           <span class="co"># Can make a binned size scale</span></span>
<span>           <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_size.html" class="external-link">scale_size_binned</a></span><span class="op">(</span>n.breaks <span class="op">=</span> <span class="fl">6</span>, range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">6</span><span class="op">)</span>,</span>
<span>                             <span class="co"># Absolute value transform but legend loses meaning</span></span>
<span>                             transform <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/new_transform.html" class="external-link">trans_new</a></span><span class="op">(</span><span class="st">"abs"</span>, <span class="va">abs</span>, <span class="va">abs</span><span class="op">)</span>,</span>
<span>                             name <span class="op">=</span> <span class="st">"scale_size_binned\n(absolute value)"</span>,</span>
<span>                             guide <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_bins.html" class="external-link">guide_bins</a></span><span class="op">(</span>order <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>           <span class="co"># scale_size_area, scale_size_binned_area also scale with absolute value</span></span>
<span>           <span class="co"># but fewer options to control sizes</span></span>
<span>           <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_size.html" class="external-link">scale_size_area</a></span><span class="op">(</span>max_size <span class="op">=</span> <span class="fl">10</span>, name <span class="op">=</span> <span class="st">"scale_size_area"</span><span class="op">)</span></span>
<span>         <span class="op">)</span>, border_lwd <span class="op">=</span> <span class="fl">1</span>, legend_order <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></code></pre></div>
<p><img src="legends_files/figure-html/unnamed-chunk-11-1.png" alt="mtcars correlation heatmap with diamonds instead of cells. In the top right triangle the diamonds are smaller than in the bottom left. The sizes of all diamonds scale with the absolute value of the correlations, but the legend for the top right diamonds goes from 0 to 1 while the legend for the other triangle properly shows the negative values too." width="700"></p>
</div>
<div class="section level2">
<h2 id="legend-order">Legend order<a class="anchor" aria-label="anchor" href="#legend-order"></a>
</h2>
<p>Legends have a set default order:</p>
<ol style="list-style-type: decimal">
<li>Main heatmap colours.</li>
<li>Main heatmap sizes.</li>
<li>Row annotations in order.</li>
<li>Column annotations in order.</li>
</ol>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">row_annot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">row_annot</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"3"</span></span>
<span></span>
<span><span class="va">col_annot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span>, <span class="fl">11</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">col_annot</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"4"</span></span>
<span></span>
<span><span class="fu"><a href="../reference/gghm.html">gghm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span>, mode <span class="op">=</span> <span class="fl">23</span>,</span>
<span>     col_name <span class="op">=</span> <span class="st">"1"</span>, size_name <span class="op">=</span> <span class="st">"2"</span>,</span>
<span>     annot_rows_df <span class="op">=</span> <span class="va">row_annot</span>,</span>
<span>     annot_cols_df <span class="op">=</span> <span class="va">col_annot</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Make the legends horizontal to fit better</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.direction <span class="op">=</span> <span class="st">"horizontal"</span><span class="op">)</span></span></code></pre></div>
<p><img src="legends_files/figure-html/unnamed-chunk-12-1.png" alt="A heatmap of the first 10 rows of mtcars (scaled), with coloured diamonds instead of cells. The heatmap colours range from dark blue to light blue. There is one row annotation (using the viridis D option) and one column annotation (using the viridis A option), named 3 and 4, respectively. Four legends are on the right side of the plot for the main heatmap colours, main heatmap sizes, row annotations, and column annotations. The legends are named 1, 2, 3, and 4." width="700"></p>
<p>If the layout is mixed, the legends of the first triangle appear
before those of the second triangle.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gghm.html">gghm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span>, layout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tr"</span>, <span class="st">"bl"</span><span class="op">)</span>, mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"15"</span>, <span class="st">"hm"</span><span class="op">)</span>,</span>
<span>     col_scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"H"</span>, <span class="st">"A"</span><span class="op">)</span>, col_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Triangle 1"</span>, <span class="st">"Triangle 2"</span><span class="op">)</span>,</span>
<span>     size_name <span class="op">=</span> <span class="st">"Triangle 1"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.direction <span class="op">=</span> <span class="st">"horizontal"</span><span class="op">)</span></span></code></pre></div>
<p><img src="legends_files/figure-html/unnamed-chunk-13-1.png" alt="mtcars correlation heatmap with cells in the bottom left triangle and squares with sizes varying with the value in the top right. The deafult ggplot2 colour scale (dark blue to light blue) is used for both triangles. Three legends are on the right, the first one a colour scale, the second one a size scale, and the third one another colour scale." width="700"></p>
<p>The order can be changed by using the <code>legend_order</code>
argument. This argument takes a numeric vector, the first element
specifying the order for the first legend (of the default order), the
second element for the second legend and so on. If a value is
<code>NA</code>, that legend is hidden.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">annot_rows</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">11</span>, <span class="fl">11</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">annot_rows</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"4"</span>, <span class="st">"5"</span><span class="op">)</span></span>
<span><span class="va">annot_cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span>,</span>
<span>                         <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, <span class="fl">11</span>, <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                         <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, <span class="fl">11</span>, <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">annot_cols</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"6"</span>, <span class="st">"7"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plt1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gghm.html">gghm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span>, layout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tl"</span>, <span class="st">"br"</span><span class="op">)</span>, mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">19</span>, <span class="fl">21</span><span class="op">)</span>,</span>
<span>             col_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span>, <span class="st">"3"</span><span class="op">)</span>, size_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2"</span><span class="op">)</span>,</span>
<span>             annot_rows_df <span class="op">=</span> <span class="va">annot_rows</span>,</span>
<span>             annot_cols_df <span class="op">=</span> <span class="va">annot_cols</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plt2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gghm.html">gghm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span>, layout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tl"</span>, <span class="st">"br"</span><span class="op">)</span>, mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">19</span>, <span class="fl">21</span><span class="op">)</span>,</span>
<span>             col_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span>, <span class="st">"3"</span><span class="op">)</span>, size_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2"</span><span class="op">)</span>,</span>
<span>             annot_rows_df <span class="op">=</span> <span class="va">annot_rows</span>,</span>
<span>             annot_cols_df <span class="op">=</span> <span class="va">annot_cols</span>,</span>
<span>             legend_order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">2</span>, <span class="cn">NA</span>, <span class="fl">1</span>, <span class="fl">5</span>, <span class="cn">NA</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plt1</span> <span class="op">/</span> <span class="va">plt2</span> <span class="op">&amp;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.direction <span class="op">=</span> <span class="st">"horizontal"</span><span class="op">)</span></span></code></pre></div>
<p><img src="legends_files/figure-html/unnamed-chunk-14-1.png" alt="Two mtcars correlation heatmaps with circles instead of cells. Both have two row and two column annotations each. The first heatmap has seven legends on the right (colour, size, colour, row annotation colours 1-2, column annotation colours 1-2), named 1 to 7. The second heatmap is the same as the first but with the legends ordered 4, 2, 7, 1, 5. The 3 and 6 legends are missing." width="768"></p>
<p>A single NA value hides all legends.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gghm.html">gghm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span>, layout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tl"</span>, <span class="st">"br"</span><span class="op">)</span>, mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">19</span>, <span class="fl">21</span><span class="op">)</span>,</span>
<span>     col_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span>, <span class="st">"3"</span><span class="op">)</span>, size_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2"</span><span class="op">)</span>,</span>
<span>     annot_rows_df <span class="op">=</span> <span class="va">annot_rows</span>,</span>
<span>     annot_cols_df <span class="op">=</span> <span class="va">annot_cols</span>,</span>
<span>     legend_order <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></code></pre></div>
<p><img src="legends_files/figure-html/unnamed-chunk-15-1.png" alt="The mtcars correlation heatmap with circles as above, but with no legends." width="700"></p>
<p>Scales can be specified as <code>ggplot2</code> scale objects. In
this case the user has complete control over the scale and it is
unaffected by arguments like <code>legend_order</code> or
<code>col_name</code>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gghm.html">gghm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span>, layout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tl"</span>, <span class="st">"br"</span><span class="op">)</span>, mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">19</span>, <span class="fl">21</span><span class="op">)</span>,</span>
<span>     col_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span>, <span class="st">"3"</span><span class="op">)</span>, size_name <span class="op">=</span> <span class="st">"2"</span>,</span>
<span>     col_scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>       <span class="co"># Keep default scale for first triangle</span></span>
<span>       <span class="cn">NULL</span>,</span>
<span>       <span class="co"># Pass a scale object for second triangle</span></span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_c</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"scale object 1"</span>, option <span class="op">=</span> <span class="st">"G"</span>,</span>
<span>                            guide <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_colourbar.html" class="external-link">guide_colourbar</a></span><span class="op">(</span>order <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>     <span class="op">)</span>,</span>
<span>     annot_rows_df <span class="op">=</span> <span class="va">annot_rows</span>,</span>
<span>     annot_cols_df <span class="op">=</span> <span class="va">annot_cols</span>,</span>
<span>     annot_rows_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>       <span class="co"># Scale object for second row annotation</span></span>
<span>       <span class="st">"5"</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_distiller</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"scale object 2"</span>,</span>
<span>                                  palette <span class="op">=</span> <span class="st">"Purples"</span><span class="op">)</span></span>
<span>     <span class="op">)</span>,</span>
<span>     annot_cols_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>       <span class="co"># Scale object for first column annotation</span></span>
<span>       <span class="st">"6"</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_brewer</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"scale object 3"</span>,</span>
<span>                               palette <span class="op">=</span> <span class="st">"RdBu"</span>,</span>
<span>                               <span class="co"># Hide the legend</span></span>
<span>                               guide <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span>     <span class="op">)</span>,</span>
<span>     <span class="co"># (Try to) Remove all legends</span></span>
<span>     legend_order <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.direction <span class="op">=</span> <span class="st">"horizontal"</span><span class="op">)</span></span></code></pre></div>
<p><img src="legends_files/figure-html/unnamed-chunk-16-1.png" alt="mtcars correlation heatmap with circles like above but with some colours altered. The top left triangle uses the dark to light blue colour scale, while the bottom right triangle uses the Viridis mako scale (black to teal or emerald-like green). The second row annotation uses the Brewer Purples scale (white to purple). The second column annotation has red, white, and blue. Only the bottom right triangle and second row annotation have legends to the right." width="700"></p>
</div>
<div class="section level2">
<h2 id="legends-in-correlation-heatmaps">Legends in correlation heatmaps<a class="anchor" aria-label="anchor" href="#legends-in-correlation-heatmaps"></a>
</h2>
<p><code><a href="../reference/ggcorrhm.html">ggcorrhm()</a></code> tries to hide some legends by default when
using mixed layouts to reduce clutter.</p>
<p>For example, when both triangles use the same colour scale, one of
the scales is hidden. This only happens when the default scale is used
(customised with <code>high</code>, <code>mid</code>, etc is ok) or when
<code>col_scale</code> is a character. If <code>col_scale</code>
contains <code>ggplot2</code> scale objects both legends will be shown
(unless specified not to in the scale object).</p>
<p>Default size legends are also hidden as they use an absolute value
transformation and show different information from the colour scale.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># If both triangles use the same colour scale</span></span>
<span><span class="co"># (when col_scale is NULL or a one character value)</span></span>
<span><span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">mtcars</span>, layout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tl"</span>, <span class="st">"br"</span><span class="op">)</span>,</span>
<span>         mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hm"</span>, <span class="st">"18"</span><span class="op">)</span>, col_scale <span class="op">=</span> <span class="st">"RdYlBu"</span><span class="op">)</span></span></code></pre></div>
<p><img src="legends_files/figure-html/unnamed-chunk-17-1.png" alt="mtcars correlation heatmap with cells in the top left and diamonds in the bottom right. The heatmap uses the Brewer RdYlBu scale that ranges from blue to yellow to red. There is only one legend on the right, showing the colour scale." width="700"></p>
<p>The legends can be included again by using the
<code>legend_order</code> argument or using scale objects for the
scales.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">mtcars</span>, layout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tl"</span>, <span class="st">"br"</span><span class="op">)</span>,</span>
<span>         mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hm"</span>, <span class="st">"18"</span><span class="op">)</span>, col_scale <span class="op">=</span> <span class="st">"RdYlBu"</span>,</span>
<span>         <span class="co"># Elements beyond the number of legends are ignored</span></span>
<span>         <span class="co"># On a related note, if legend_order is shorter than</span></span>
<span>         <span class="co"># the number of legends, legends not in the vector are hidden</span></span>
<span>         legend_order <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p><img src="legends_files/figure-html/unnamed-chunk-18-1.png" alt="mtcars correlation heatmap with cells and diamonds and the RdYlBu scale like above. There are three legends one the right, the first two for the colour scale and the last one for the sizes (showing the absolute values)." width="700"></p>
</div>
<div class="section level2">
<h2 id="arranging-legends">Arranging legends<a class="anchor" aria-label="anchor" href="#arranging-legends"></a>
</h2>
<p>When there are many legends, some of them may be cut off and it can
be tricky to make them fit. One way is to change the positions, sizes or
orientations of legends as shown in some of the plots above. Another way
is to change the size of the figure until the legends fit. A more
advanced way is to use packages like <code>cowplot</code> and
<code>patchwork</code> to stitch together a legend-less version of the
plot with the legends, which also makes it possible to arrange the
legends in grids.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot with legends</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">mtcars</span>, cluster_rows <span class="op">=</span> <span class="cn">TRUE</span>, cluster_cols <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>              annot_rows_df <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span>,</span>
<span>                                         a <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">11</span>, b <span class="op">=</span> <span class="fl">11</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>              annot_cols_df <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span>,</span>
<span>                                         c <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">11</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot without legends</span></span>
<span><span class="va">pl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggcorrhm.html">ggcorrhm</a></span><span class="op">(</span><span class="va">mtcars</span>, cluster_rows <span class="op">=</span> <span class="cn">TRUE</span>, cluster_cols <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>               annot_rows_df <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span>,</span>
<span>                                          a <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">11</span>, b <span class="op">=</span> <span class="fl">11</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>               annot_cols_df <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span>,</span>
<span>                                          c <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">11</span><span class="op">)</span>,</span>
<span>               legend_order <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Show plot with default legends</span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="legends_files/figure-html/unnamed-chunk-19-1.png" alt="mtcars correlation heatmap with clustered rows and columns, as well as two row annotations and one column annotation. Four legends can be seen to the right, but they do not all fit and the first and last one cannot be seen fully." width="700"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract the four legends</span></span>
<span><span class="va">lgd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://wilkelab.org/cowplot/reference/get_legend.html" class="external-link">get_legend</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">[[</span><span class="st">"grobs"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Arrange in a grid (cowplot)</span></span>
<span><span class="va">lgd_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span>plotlist <span class="op">=</span> <span class="va">lgd</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine legend-less plot and legends with cowplot</span></span>
<span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">pl</span>, <span class="va">lgd_grid</span>, rel_widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="legends_files/figure-html/unnamed-chunk-20-1.png" alt="The same heatmap with annotations as the previous figure, but the legends are now all visible, arranged in a 2x2 grid to the right of the plot." width="700"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Code for the same layout as above</span></span>
<span><span class="co"># # Arrange in a grid (patchwork)</span></span>
<span><span class="co"># lgd_grid &lt;- wrap_plots(lgd)</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># # Combine with patchwork</span></span>
<span><span class="co"># wrap_plots(pl, lgd_grid, widths = c(3, 1))</span></span>
<span></span>
<span><span class="co"># Try a different layout with patchwork. Turn the legends horizontal</span></span>
<span><span class="va">lgd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://wilkelab.org/cowplot/reference/get_legend.html" class="external-link">get_legend</a></span><span class="op">(</span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.direction <span class="op">=</span> <span class="st">"horizontal"</span>,</span>
<span>                            legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>vjust <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="st">"grobs"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Append the plot to the legend list to give to patchwork::wrap_plots</span></span>
<span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html" class="external-link">wrap_plots</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">pl</span><span class="op">)</span>, <span class="va">lgd</span><span class="op">)</span>,</span>
<span>           design <span class="op">=</span> <span class="st">"</span></span>
<span><span class="st">           ##BBB##</span></span>
<span><span class="st">           AAAAAAA</span></span>
<span><span class="st">           AAAAAAA</span></span>
<span><span class="st">           AAAAAAA</span></span>
<span><span class="st">           AAAAAAA</span></span>
<span><span class="st">           CCDDEEE</span></span>
<span><span class="st">           "</span><span class="op">)</span></span></code></pre></div>
<p><img src="legends_files/figure-html/unnamed-chunk-21-1.png" alt="The same heatmap as the previous plot. The legends are now horizontal and split into two groups, the Pearson r legend above and the annotation legends below the heatmap." width="672"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Leo Dahl.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>

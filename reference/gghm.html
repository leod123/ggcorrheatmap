<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Make a heatmap with ggplot2. — gghm • ggcorrheatmap</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Make a heatmap with ggplot2. — gghm"><meta name="description" content="Make a heatmap of a matrix/data frame using ggplot2. Square matrices where the row- and column names are the same
can use triangular layouts that either only show one triangle or plot different things in the different triangles."><meta property="og:description" content="Make a heatmap of a matrix/data frame using ggplot2. Square matrices where the row- and column names are the same
can use triangular layouts that either only show one triangle or plot different things in the different triangles."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ggcorrheatmap</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/heatmap.html">Making a heatmap</a></li>
    <li><a class="dropdown-item" href="../articles/correlation.html">Correlation heatmaps</a></li>
    <li><a class="dropdown-item" href="../articles/annotation.html">Annotation</a></li>
    <li><a class="dropdown-item" href="../articles/clustering.html">Clustering</a></li>
    <li><a class="dropdown-item" href="../articles/facets.html">Facets</a></li>
    <li><a class="dropdown-item" href="../articles/mixed.html">Mixed layouts</a></li>
    <li><a class="dropdown-item" href="../articles/legends.html">Scales and legends</a></li>
    <li><a class="dropdown-item" href="../articles/tidy_input.html">Using tidy data</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/leod123/ggcorrheatmap/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Make a heatmap with ggplot2.</h1>
      <small class="dont-index">Source: <a href="https://github.com/leod123/ggcorrheatmap/blob/main/R/gghm.R" class="external-link"><code>R/gghm.R</code></a></small>
      <div class="d-none name"><code>gghm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Make a heatmap of a matrix/data frame using ggplot2. Square matrices where the row- and column names are the same
can use triangular layouts that either only show one triangle or plot different things in the different triangles.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gghm</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  layout <span class="op">=</span> <span class="st">"full"</span>,</span>
<span>  mode <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">layout</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="st">"heatmap"</span> <span class="kw">else</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"heatmap"</span>, <span class="st">"text"</span><span class="op">)</span>,</span>
<span>  scale_data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  col_scale <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  col_name <span class="op">=</span> <span class="st">"value"</span>,</span>
<span>  limits <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bins <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  size_scale <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  size_name <span class="op">=</span> <span class="st">"value"</span>,</span>
<span>  legend_order <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  include_diag <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  split_diag <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  show_names_diag <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  names_diag_params <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  show_names_x <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  names_x_side <span class="op">=</span> <span class="st">"top"</span>,</span>
<span>  show_names_y <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  names_y_side <span class="op">=</span> <span class="st">"left"</span>,</span>
<span>  na_col <span class="op">=</span> <span class="st">"grey50"</span>,</span>
<span>  na_remove <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  return_data <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cell_labels <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cell_label_col <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  cell_label_size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  cell_label_digits <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  border_col <span class="op">=</span> <span class="st">"grey"</span>,</span>
<span>  border_lwd <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  border_lty <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  cell_bg_col <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>  cell_bg_alpha <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  annot_rows_df <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  annot_cols_df <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  annot_rows_col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  annot_cols_col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  annot_rows_side <span class="op">=</span> <span class="st">"right"</span>,</span>
<span>  annot_cols_side <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>  annot_dist <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  annot_gap <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  annot_size <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  annot_border_col <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">border_col</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="va">border_col</span> <span class="kw">else</span> <span class="st">"grey"</span>,</span>
<span>  annot_border_lwd <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">border_lwd</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="va">border_lwd</span> <span class="kw">else</span> <span class="fl">0.5</span>,</span>
<span>  annot_border_lty <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">border_lty</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="va">border_lty</span> <span class="kw">else</span> <span class="fl">1</span>,</span>
<span>  annot_na_col <span class="op">=</span> <span class="va">na_col</span>,</span>
<span>  annot_na_remove <span class="op">=</span> <span class="va">na_remove</span>,</span>
<span>  annot_rows_params <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  annot_cols_params <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  show_annot_names <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  annot_names_size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  annot_rows_names_side <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>  annot_cols_names_side <span class="op">=</span> <span class="st">"left"</span>,</span>
<span>  annot_rows_names_params <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  annot_cols_names_params <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  annot_rows_name_params <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  annot_cols_name_params <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cluster_rows <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cluster_cols <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cluster_distance <span class="op">=</span> <span class="st">"euclidean"</span>,</span>
<span>  cluster_method <span class="op">=</span> <span class="st">"complete"</span>,</span>
<span>  show_dend_rows <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  show_dend_cols <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  dend_rows_side <span class="op">=</span> <span class="st">"right"</span>,</span>
<span>  dend_cols_side <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>  dend_col <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  dend_dist <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  dend_height <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>  dend_lwd <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>  dend_lty <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  dend_rows_params <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dend_cols_params <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dend_rows_extend <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dend_cols_extend <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  split_rows <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  split_cols <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  split_rows_side <span class="op">=</span> <span class="st">"right"</span>,</span>
<span>  split_cols_side <span class="op">=</span> <span class="st">"bottom"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Matrix or data frame in wide format to make a heatmap of. If rownames are present they are used for the y axis labels, otherwise the row number is used.
If a column named <code>.names</code> (containing unique row identifiers) is present it will be used as rownames.</p></dd>


<dt id="arg-layout">layout<a class="anchor" aria-label="anchor" href="#arg-layout"></a></dt>
<dd><p>String specifying the layout of the output heatmap. Possible layouts include
'topleft', 'topright', 'bottomleft', 'bottomright', or the 'whole'/'full' heatmap (default and only possible option if the matrix is not square).
A combination of the first letters of each word also works (i.e. f, w, tl, tr, bl, br).
If layout is of length two with two opposing triangles, a mixed layout will be used. For mixed layouts,
<code>mode</code> needs a vector of length two (applied in the same order as layout). See details for more information.</p></dd>


<dt id="arg-mode">mode<a class="anchor" aria-label="anchor" href="#arg-mode"></a></dt>
<dd><p>A string specifying plotting mode. Possible values are <code>heatmap</code>/<code>hm</code> for a normal heatmap, a number from 1 to 25 to draw the corresponding shape,
<code>text</code> to write the cell values instead of filling cells (colour scaling with value), and <code>none</code> for blank cells.</p></dd>


<dt id="arg-scale-data">scale_data<a class="anchor" aria-label="anchor" href="#arg-scale-data"></a></dt>
<dd><p>Character string specifying scaling of the matrix. NULL or "none" for no scaling, "rows" for rows, and "columns" for
columns. Can also be a substring of the beginning of the words.</p></dd>


<dt id="arg-col-scale">col_scale<a class="anchor" aria-label="anchor" href="#arg-col-scale"></a></dt>
<dd><p>Colour scale to use for cells. If NULL, the default ggplot2 scale is used. If a string, the corresponding Brewer or Viridis scale is used.
A string with a scale name with "rev_" in the beginning or "_rev" at the end will result in the reversed scale. Can also be a ggplot2 scale object to overwrite the scale.
In mixed layouts, a list of two scales can be provided.</p></dd>


<dt id="arg-col-name">col_name<a class="anchor" aria-label="anchor" href="#arg-col-name"></a></dt>
<dd><p>String to use for the colour scale legend title. Can be two values in mixed layouts for dual scales.</p></dd>


<dt id="arg-limits">limits<a class="anchor" aria-label="anchor" href="#arg-limits"></a></dt>
<dd><p>Numeric vector of length two for the limits of the colour scale. NULL uses the default.</p></dd>


<dt id="arg-bins">bins<a class="anchor" aria-label="anchor" href="#arg-bins"></a></dt>
<dd><p>Number of bins to divide the scale into (if continuous values). A 'double' class value uses 'nice.breaks' to put the breaks at nice numbers which may not result
in the specified number of bins. If an integer the number of bins will be prioritised.</p></dd>


<dt id="arg-size-scale">size_scale<a class="anchor" aria-label="anchor" href="#arg-size-scale"></a></dt>
<dd><p><code>ggplot2::scale_size_*</code> call to use for size scaling if <code>mode</code> is a number from 1 to 25 (R pch). In mixed layouts, can also be a list
of length two containing the two scales to use.</p></dd>


<dt id="arg-size-name">size_name<a class="anchor" aria-label="anchor" href="#arg-size-name"></a></dt>
<dd><p>String to use for the size scale legend title. Can be two values in mixed layouts for dual scales.</p></dd>


<dt id="arg-legend-order">legend_order<a class="anchor" aria-label="anchor" href="#arg-legend-order"></a></dt>
<dd><p>Integer vector specifying the order of legends (first value is for the first legend, second for the second, etc). The default (NULL) shows all legends.
NAs hide the corresponding legends, a single NA hides all. Ignored for <code>ggplot2</code> scale objects in <code>col_scale</code> and <code>size_scale</code>.</p></dd>


<dt id="arg-include-diag">include_diag<a class="anchor" aria-label="anchor" href="#arg-include-diag"></a></dt>
<dd><p>Logical indicating if the diagonal cells (of a square matrix with identical dimnames) should be plotted.
Mostly only useful for getting a cleaner look with symmetric correlation matrices with triangular layouts, where the diagonal is known to be 1.</p></dd>


<dt id="arg-split-diag">split_diag<a class="anchor" aria-label="anchor" href="#arg-split-diag"></a></dt>
<dd><p>Logical indicating if the diagonal cells should be drawn as triangles, splitting the diagonal in two.</p></dd>


<dt id="arg-show-names-diag">show_names_diag<a class="anchor" aria-label="anchor" href="#arg-show-names-diag"></a></dt>
<dd><p>Logical indicating if names should be written in the diagonal cells.</p></dd>


<dt id="arg-names-diag-params">names_diag_params<a class="anchor" aria-label="anchor" href="#arg-names-diag-params"></a></dt>
<dd><p>List with named parameters (such as size, angle, etc) passed on to geom_text when writing the column names in the diagonal.</p></dd>


<dt id="arg-show-names-x-show-names-y">show_names_x, show_names_y<a class="anchor" aria-label="anchor" href="#arg-show-names-x-show-names-y"></a></dt>
<dd><p>Logical indicating if names should be written on the x and y axes. Labels can be customised using <code><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">ggplot2::theme()</a></code> on the output plot.</p></dd>


<dt id="arg-names-x-side">names_x_side<a class="anchor" aria-label="anchor" href="#arg-names-x-side"></a></dt>
<dd><p>String specifying position of the x axis names ("top" or "bottom").</p></dd>


<dt id="arg-names-y-side">names_y_side<a class="anchor" aria-label="anchor" href="#arg-names-y-side"></a></dt>
<dd><p>String specifying position of the y axis names ("left" or "right").</p></dd>


<dt id="arg-na-col">na_col<a class="anchor" aria-label="anchor" href="#arg-na-col"></a></dt>
<dd><p>Colour to use for cells with NA (both main heatmap and annotation).</p></dd>


<dt id="arg-na-remove">na_remove<a class="anchor" aria-label="anchor" href="#arg-na-remove"></a></dt>
<dd><p>Logical indicating if NA values in the heatmap should be omitted (meaning no cell border is drawn).
If NAs are kept, the fill colour can be set in the <code>ggplot2</code> scale.</p></dd>


<dt id="arg-return-data">return_data<a class="anchor" aria-label="anchor" href="#arg-return-data"></a></dt>
<dd><p>Logical indicating if the data used for plotting and clustering results should be returned.</p></dd>


<dt id="arg-cell-labels">cell_labels<a class="anchor" aria-label="anchor" href="#arg-cell-labels"></a></dt>
<dd><p>Logical specifying if the cells should be labelled with the values. Alternatively, a matrix or data frame with the same shape and dimnames as <code>x</code>
containing values to write in the cells. If mode is <code>text</code>, the cell label colours will scale with the cell values and <code>cell_label_col</code> is ignored.</p></dd>


<dt id="arg-cell-label-col">cell_label_col<a class="anchor" aria-label="anchor" href="#arg-cell-label-col"></a></dt>
<dd><p>Colour to use for cell labels, passed to <code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">ggplot2::geom_text()</a></code>.</p></dd>


<dt id="arg-cell-label-size">cell_label_size<a class="anchor" aria-label="anchor" href="#arg-cell-label-size"></a></dt>
<dd><p>Size of cell labels, used as the <code>size</code> argument in <code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">ggplot2::geom_text()</a></code>.</p></dd>


<dt id="arg-cell-label-digits">cell_label_digits<a class="anchor" aria-label="anchor" href="#arg-cell-label-digits"></a></dt>
<dd><p>Number of digits to display when cells are labelled (if numeric values). Default is 2, passed to <code><a href="https://rdrr.io/r/base/Round.html" class="external-link">base::round()</a></code>. NULL for no rounding.</p></dd>


<dt id="arg-border-col">border_col<a class="anchor" aria-label="anchor" href="#arg-border-col"></a></dt>
<dd><p>Colour of cell borders. If <code>mode</code> is not a number, <code>border_col</code> can be set to NA to remove borders completely.</p></dd>


<dt id="arg-border-lwd">border_lwd<a class="anchor" aria-label="anchor" href="#arg-border-lwd"></a></dt>
<dd><p>Size of cell borders. If <code>mode</code> is a number, <code>border_col</code> can be set to 0 to remove borders.</p></dd>


<dt id="arg-border-lty">border_lty<a class="anchor" aria-label="anchor" href="#arg-border-lty"></a></dt>
<dd><p>Line type of cell borders. Either a number or its corresponding name, or a string of length 2, 4, 6, or 8. See 'lty' of <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">graphics::par()</a></code> for details.
Not supported for numeric <code>mode</code>.</p></dd>


<dt id="arg-cell-bg-col">cell_bg_col<a class="anchor" aria-label="anchor" href="#arg-cell-bg-col"></a></dt>
<dd><p>Colour to use for cell backgrounds in modes 'text' and 'none'.</p></dd>


<dt id="arg-cell-bg-alpha">cell_bg_alpha<a class="anchor" aria-label="anchor" href="#arg-cell-bg-alpha"></a></dt>
<dd><p>Alpha for cell colours in modes 'text' and 'none'.</p></dd>


<dt id="arg-annot-rows-df-annot-cols-df">annot_rows_df, annot_cols_df<a class="anchor" aria-label="anchor" href="#arg-annot-rows-df-annot-cols-df"></a></dt>
<dd><p>Data frame for row and column annotations. The names of the columns in the data must be included,
either as row names or in a column named <code>.names</code>. Each other column specifies an annotation where the column name
will be used as the annotation name (in the legend and next to the annotation). Numeric columns will use a continuous
colour scale while factor or character columns use discrete scales.</p></dd>


<dt id="arg-annot-rows-col-annot-cols-col">annot_rows_col, annot_cols_col<a class="anchor" aria-label="anchor" href="#arg-annot-rows-col-annot-cols-col"></a></dt>
<dd><p>Named list for row and column annotation colour scales. The names should specify which annotation each scale applies to.
Elements can be strings or ggplot2 "Scale" class objects. If a string, it is used as the brewer palette or viridis option.
If a scale object it is used as is, allowing more flexibility. This may change the order that legends are drawn in,
specify order using the <code>guide</code> argument in the <code>ggplot2</code> scale function.</p></dd>


<dt id="arg-annot-rows-side">annot_rows_side<a class="anchor" aria-label="anchor" href="#arg-annot-rows-side"></a></dt>
<dd><p>String specifying which side row annotation should be drawn ('left' or 'right', defaults to 'left').</p></dd>


<dt id="arg-annot-cols-side">annot_cols_side<a class="anchor" aria-label="anchor" href="#arg-annot-cols-side"></a></dt>
<dd><p>String specifying which side column annotation should be drawn ('bottom' or 'top', defaults to 'bottom').</p></dd>


<dt id="arg-annot-dist">annot_dist<a class="anchor" aria-label="anchor" href="#arg-annot-dist"></a></dt>
<dd><p>Distance between heatmap and first annotation cell where 1 is the size of one heatmap cell. Used for both row and column annotation.</p></dd>


<dt id="arg-annot-gap">annot_gap<a class="anchor" aria-label="anchor" href="#arg-annot-gap"></a></dt>
<dd><p>Distance between each annotation where 1 is the size of one heatmap cell. Used for both row and column annotation.</p></dd>


<dt id="arg-annot-size">annot_size<a class="anchor" aria-label="anchor" href="#arg-annot-size"></a></dt>
<dd><p>Size (width for row annotation, height for column annotation) of annotation cells compared to a heatmap cell. Used for both row and column annotation.</p></dd>


<dt id="arg-annot-border-col">annot_border_col<a class="anchor" aria-label="anchor" href="#arg-annot-border-col"></a></dt>
<dd><p>Colour of cell borders in annotation. By default it is the same as <code>border_col</code> of the main heatmap if it is of length 1, otherwise uses default (grey).</p></dd>


<dt id="arg-annot-border-lwd">annot_border_lwd<a class="anchor" aria-label="anchor" href="#arg-annot-border-lwd"></a></dt>
<dd><p>Line width of cell borders in annotation. By default it is the same as <code>border_lwd</code> of the main heatmap if it is of length 1, otherwise uses default (0.5).</p></dd>


<dt id="arg-annot-border-lty">annot_border_lty<a class="anchor" aria-label="anchor" href="#arg-annot-border-lty"></a></dt>
<dd><p>Line type of cell borders in annotation. By default it is the same as <code>border_lty</code> of the main heatmap if it is of length 1, otherwise uses default (solid).</p></dd>


<dt id="arg-annot-na-col">annot_na_col<a class="anchor" aria-label="anchor" href="#arg-annot-na-col"></a></dt>
<dd><p>Colour to use for NA values in annotations. Annotation-specific colour can be set in the ggplot2 scales in
the <code>annot_*_fill</code> arguments.</p></dd>


<dt id="arg-annot-na-remove">annot_na_remove<a class="anchor" aria-label="anchor" href="#arg-annot-na-remove"></a></dt>
<dd><p>Logical indicating if NAs in the annotations should be removed (producing empty spaces).</p></dd>


<dt id="arg-annot-rows-params-annot-cols-params">annot_rows_params, annot_cols_params<a class="anchor" aria-label="anchor" href="#arg-annot-rows-params-annot-cols-params"></a></dt>
<dd><p>Named list with parameters for row and column annotations to overwrite the defaults set by the <code>annot_*</code> arguments, each name corresponding to the <code>*</code> part
(see details for more information).</p></dd>


<dt id="arg-show-annot-names">show_annot_names<a class="anchor" aria-label="anchor" href="#arg-show-annot-names"></a></dt>
<dd><p>Logical controlling if names of annotations should be shown in the drawing area.</p></dd>


<dt id="arg-annot-names-size">annot_names_size<a class="anchor" aria-label="anchor" href="#arg-annot-names-size"></a></dt>
<dd><p>Size of annotation names.</p></dd>


<dt id="arg-annot-rows-names-side">annot_rows_names_side<a class="anchor" aria-label="anchor" href="#arg-annot-rows-names-side"></a></dt>
<dd><p>String specifying which side the row annotation names should be on. Either "top" or "bottom".</p></dd>


<dt id="arg-annot-cols-names-side">annot_cols_names_side<a class="anchor" aria-label="anchor" href="#arg-annot-cols-names-side"></a></dt>
<dd><p>String specifying which side the column annotation names should be on. Either "left" or "right".</p></dd>


<dt id="arg-annot-rows-names-params-annot-cols-names-params">annot_rows_names_params, annot_cols_names_params<a class="anchor" aria-label="anchor" href="#arg-annot-rows-names-params-annot-cols-names-params"></a></dt>
<dd><p>Named list of parameters for row and column annotation names. Given to <code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">ggplot2::geom_text()</a></code>.</p></dd>


<dt id="arg-annot-rows-name-params-annot-cols-name-params">annot_rows_name_params, annot_cols_name_params<a class="anchor" aria-label="anchor" href="#arg-annot-rows-name-params-annot-cols-name-params"></a></dt>
<dd><p>Deprecated and kept for backward compatibility. Named list of parameters given to <code><a href="https://rdrr.io/r/grid/grid.text.html" class="external-link">grid::textGrob()</a></code> for annotation names.
Does not work well with heatmap splits.</p></dd>


<dt id="arg-cluster-rows-cluster-cols">cluster_rows, cluster_cols<a class="anchor" aria-label="anchor" href="#arg-cluster-rows-cluster-cols"></a></dt>
<dd><p>Logical indicating if rows or columns should be clustered. Can also be <code>hclust</code> or <code>dendrogram</code> objects.</p></dd>


<dt id="arg-cluster-distance">cluster_distance<a class="anchor" aria-label="anchor" href="#arg-cluster-distance"></a></dt>
<dd><p>String with the distance metric to use for clustering, given to <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">stats::dist()</a></code>.</p></dd>


<dt id="arg-cluster-method">cluster_method<a class="anchor" aria-label="anchor" href="#arg-cluster-method"></a></dt>
<dd><p>String with the clustering method to use, given to <code><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">stats::hclust()</a></code>.</p></dd>


<dt id="arg-show-dend-rows-show-dend-cols">show_dend_rows, show_dend_cols<a class="anchor" aria-label="anchor" href="#arg-show-dend-rows-show-dend-cols"></a></dt>
<dd><p>Logical indicating if a dendrogram should be drawn for the rows or columns.</p></dd>


<dt id="arg-dend-rows-side">dend_rows_side<a class="anchor" aria-label="anchor" href="#arg-dend-rows-side"></a></dt>
<dd><p>Which side to draw the row dendrogram on ('left' or 'right', defaults to 'left').</p></dd>


<dt id="arg-dend-cols-side">dend_cols_side<a class="anchor" aria-label="anchor" href="#arg-dend-cols-side"></a></dt>
<dd><p>Which side to draw the column dendrogram on ('bottom' or 'top', defaults to 'bottom').</p></dd>


<dt id="arg-dend-col">dend_col<a class="anchor" aria-label="anchor" href="#arg-dend-col"></a></dt>
<dd><p>Colour to use for dendrogram lines, applied to both row and column dendrograms.</p></dd>


<dt id="arg-dend-dist">dend_dist<a class="anchor" aria-label="anchor" href="#arg-dend-dist"></a></dt>
<dd><p>Distance from heatmap (or annotation) to leaves of dendrogram, measured in heatmap cells (1 is the size of one cell).</p></dd>


<dt id="arg-dend-height">dend_height<a class="anchor" aria-label="anchor" href="#arg-dend-height"></a></dt>
<dd><p>Number by which to scale dendrogram height, applied to both row and column dendrograms.</p></dd>


<dt id="arg-dend-lwd">dend_lwd<a class="anchor" aria-label="anchor" href="#arg-dend-lwd"></a></dt>
<dd><p>Linewidth of dendrogram lines, applied to both row and column dendrograms.</p></dd>


<dt id="arg-dend-lty">dend_lty<a class="anchor" aria-label="anchor" href="#arg-dend-lty"></a></dt>
<dd><p>Dendrogram line type, applied to both row and column dendrograms.</p></dd>


<dt id="arg-dend-rows-params-dend-cols-params">dend_rows_params, dend_cols_params<a class="anchor" aria-label="anchor" href="#arg-dend-rows-params-dend-cols-params"></a></dt>
<dd><p>Named list for row or column dendrogram parameters to overwrite common parameter values. See details for more information.</p></dd>


<dt id="arg-dend-rows-extend-dend-cols-extend">dend_rows_extend, dend_cols_extend<a class="anchor" aria-label="anchor" href="#arg-dend-rows-extend-dend-cols-extend"></a></dt>
<dd><p>Named list or functional sequence for specifying <code>dendextend</code> functions to apply to the row or column dendrogram. See details for usage.</p></dd>


<dt id="arg-split-rows-split-cols">split_rows, split_cols<a class="anchor" aria-label="anchor" href="#arg-split-rows-split-cols"></a></dt>
<dd><p>Vectors for splitting the rows and columns into facets. Can be a numeric vector shorter than the number of rows/columns to split the heatmap after those indices,
or a vector of the same length as the number of rows/columns containing the facet memberships. In the latter case names can be used to match with rows/columns.
Alternatively, if clustering is applied a single numeric value is accepted for the number of clusters to divide the plot into.</p></dd>


<dt id="arg-split-rows-side-split-cols-side">split_rows_side, split_cols_side<a class="anchor" aria-label="anchor" href="#arg-split-rows-side-split-cols-side"></a></dt>
<dd><p>Which side the row/column facet strips should be drawn on ('left'/'right', 'top'/'bottom').</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The heatmap as a <code>ggplot</code> object.
If <code>return_data</code> is TRUE the output is a list containing the plot (named 'plot'),
the plotting data ('plot_data', with factor columns 'row' and 'col', a column 'value' containing the cell values, and 'layout' which part of the heatmap each cell belongs to),
and the result of the clustering ('row_clustering' and/or 'col_clustering).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>When using mixed layouts (<code>layout</code> is length two), <code>mode</code> needs to be length two as well, specifying the mode to use in each triangle.
The <code>cell_label_*</code> and <code>border_*</code> arguments can all be length one to apply to the whole heatmap, length two vectors to apply to each triangle,
or lists of length two, each element containing one value (apply to whole triangle) or a value per cell (apply cell-wise in triangle).
<code>cell_labels</code> can also be specified per triangle, either as a logical vector of length two, or a list of length two containing a mix of
logicals and matrices/data frames.</p>
<p>It is also possible to provide two scales for filling or colouring the triangles differently.
In this case the <code>col_scale</code> must be one character value (scale used for both triangles) or NULL or a list of length two
containing the scales to use (character or scale object, or NULL for default). <code>size_scale</code> works in the same way (but takes no character values).
In addition, the scale-modifying arguments <code>bins</code>, <code>na_col</code> and <code>limits</code> can also be specified per triangle. <code>limits</code> must be a list of length two (or one) where each
element is a numeric vector of length two.</p>
<p>The annotation parameter arguments <code>annot_rows_params</code> and <code>annot_cols_params</code> should be named lists, where the possible options correspond to
the different <code>annot_*</code> arguments. The possible options are "dist" (distance between heatmap and annotation), "gap" (distance between annotations),
"size" (cell size), "show_names" (logical, if the annotation names should be displayed), "border_col" (colour of border) and "border_lwd" (border line width).
Any unused options will use the defaults set by the <code>annot_*</code> arguments.</p>
<p>The dendrogram parameters arguments <code>dend_rows_params</code> and <code>dend_cols_params</code> should be named lists, analogous to the annotation parameter arguments. Possible options are
"col" (line colour), "dist" (distance from heatmap to dendrogram), "height" (height scaling), "lwd" (line width), and "lty" (line type).</p>
<p>The <code>dend_rows_extend</code> and <code>dend_cols_extend</code> arguments make it possible to customise the dendrograms using the <code>dendextend</code> package.
The argument should be a named list, each element named after the <code>dendextend</code> function to use (consecutive usage of the <code>set</code> function
is supported due to duplicate list names being possible). Each element should contain any arguments given to the <code>dendextend</code> function,
such as the <code>what</code> argument used in the <code>set</code> function. Alternatively, <code>dendextend</code> functions can be provided in a functional sequence ("fseq" object)
by piping together functions using the <code>%&gt;%</code> pipe. Functions modifying the labels do not work as the dendrogram labels are not displayed (they are in the axis text).
As dendextend::as.ggdend() is used for conversion of the dendrogram, anything not supported by as.ggdend() will not work (such as "nodes_bg" or "rect.dendrogram").
See examples and the clustering article for example usage.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use part of the mtcars data (for visibility)</span></span></span>
<span class="r-in"><span><span class="va">hm_in</span> <span class="op">&lt;-</span> <span class="va">mtcars</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span>, <span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Basic usage</span></span></span>
<span class="r-in"><span><span class="fu">gghm</span><span class="op">(</span><span class="va">hm_in</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="gghm-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Different layout (using a symmetric matrix)</span></span></span>
<span class="r-in"><span><span class="fu">gghm</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span>, layout <span class="op">=</span> <span class="st">"tl"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="gghm-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Mixed layouts</span></span></span>
<span class="r-in"><span><span class="fu">gghm</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span>, layout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tr"</span>, <span class="st">"bl"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     <span class="co"># Hide one of the legends</span></span></span>
<span class="r-in"><span>     legend_order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="gghm-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># With clustering</span></span></span>
<span class="r-in"><span><span class="fu">gghm</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">hm_in</span><span class="op">)</span>, cluster_rows <span class="op">=</span> <span class="cn">TRUE</span>, cluster_cols <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="gghm-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Adjusting cluster dendrograms using common and specific options</span></span></span>
<span class="r-in"><span><span class="fu">gghm</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">hm_in</span><span class="op">)</span>, cluster_rows <span class="op">=</span> <span class="cn">TRUE</span>, cluster_cols <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>     <span class="co"># Common options</span></span></span>
<span class="r-in"><span>     dend_lwd <span class="op">=</span> <span class="fl">0.7</span>, dend_col <span class="op">=</span> <span class="st">"magenta"</span>,</span></span>
<span class="r-in"><span>     <span class="co"># Specific options</span></span></span>
<span class="r-in"><span>     dend_rows_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, dend_cols_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="gghm-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># With annotation and specifying colour scales</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">annot_rows</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">hm_in</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                         annot1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">hm_in</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                         annot2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">hm_in</span><span class="op">)</span>, <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Specify colour scale for one of the annotations (viridis mako)</span></span></span>
<span class="r-in"><span><span class="va">annot_fill</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>annot1 <span class="op">=</span> <span class="st">"G"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">gghm</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">hm_in</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     <span class="co"># Change colours of heatmap (Brewer Purples)</span></span></span>
<span class="r-in"><span>     col_scale <span class="op">=</span> <span class="st">"Purples"</span>,</span></span>
<span class="r-in"><span>     annot_rows_df <span class="op">=</span> <span class="va">annot_rows</span>, annot_rows_col <span class="op">=</span> <span class="va">annot_fill</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>     <span class="co"># Use ggplot2::theme to adjust margins to fit the annotation names</span></span></span>
<span class="r-in"><span>     <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">10</span>, <span class="fl">60</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="gghm-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Using the dend_*_extend arguments</span></span></span>
<span class="r-in"><span><span class="fu">gghm</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">hm_in</span><span class="op">)</span>, cluster_rows <span class="op">=</span> <span class="cn">TRUE</span>, dend_rows_extend <span class="op">=</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"set"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"branches_lty"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>       <span class="co"># Empty list element (or NULL) if no arguments to be given</span></span></span>
<span class="r-in"><span>       <span class="st">"highlight_branches_col"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="gghm-7.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Leo Dahl.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>


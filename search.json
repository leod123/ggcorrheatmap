[{"path":"https://leod123.github.io/ggcorrheatmap/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2024 ggcorrheatmap authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/articles/annotation.html","id":"controlling-colours","dir":"Articles","previous_headings":"","what":"Controlling colours","title":"Annotation","text":"colours used annotation selected order eight brewer palettes (categorical annotations, ggplot2::scale_fill_brewer()) eight viridis options (continuous annotations, ggplot2::scale_fill_viridis_c()), starting beginning eight annotations.  colours can changed passing named list ggplot2 fill scales strings specifying brewer palettes viridis options annot_rows_col annot_cols_col arguments. Annotations included list get default colours. supplying scale object, order legends may change (default main heatmap annotation first, followed row annotations order column annotations order). order can adjusted using guide argument scale functions, e.g. guide = ggplot2::guide_legend(order = 3).","code":"mat_in <- matrix(1:9, nrow = 3, ncol = 3, byrow = TRUE) # Works without rownames or '.names' column as they are by default set to the same numbers here row_annot <- as.data.frame(replicate(12, letters[1:3])) col_annot <- as.data.frame(replicate(12, 1:3)) gghm(mat_in, annot_rows_df = row_annot, annot_cols_df = col_annot,      # Hide the legends      legend_order = NA) # Make annotation with eight columns, half categorical and half continuous col_annot <- as.data.frame(replicate(8, 1:8)) %>%   rename_with(function(x) {paste(c(\"custom\", \"default\"), rep(1:4, each = 2), sep = \"\")}) %>%   mutate(across(1:4, as.character)) col_annot$.names <- colnames(mtcars)[1:8]  col_annot_fill <- list(custom1 = \"Oranges\",                        custom2 = scale_fill_discrete(guide = \"none\"),                        custom3 = \"mako\",                        custom4 = scale_fill_continuous(guide = \"none\")) ggcorrhm(mtcars[, 1:8], annot_cols_df = col_annot,          annot_cols_col = col_annot_fill, legend_order = NA)"},{"path":"https://leod123.github.io/ggcorrheatmap/articles/annotation.html","id":"annotation-positioning","dir":"Articles","previous_headings":"","what":"Annotation positioning","title":"Annotation","text":"annot_rows_side annot_cols_side arguments control side annotation placed (‘left’ ‘right’ row annotations, ‘top’ ‘bottom’ column annotation). triangular layout (symmetric matrices) limits positions non-empty sides.  sizes gaps annotations heatmap can adjusted annot_size, annot_dist (distance heatmap) annot_gap (gap annotations) arguments.  arguments control annotations include show_annot_names (show/hide names), annot_legend (show/hide legends), border_col (cell border colour), border_lwd (cell border linewidth). border arguments main heatmap applied annotations well. parameters applied row column annotations can applied independently row column annotation using annot_rows_params annot_cols_params arguments. named lists names specify change (dist, gap, size, show_names, border_col, border_lwd).","code":"set.seed(123) annot <- data.frame(.names = colnames(mtcars), annot1 = rnorm(ncol(mtcars)))  plt1 <- gghm(cor(mtcars), annot_rows_df = annot, annot_cols_df = annot,              annot_rows_side = \"left\", annot_cols_side = \"top\",              annot_cols_names_side = \"right\") +   # Adjust legend position and margins   theme(legend.position = \"left\",         plot.margin = margin(10, 50, 30, 10)) plt2 <- gghm(cor(mtcars), annot_rows_df = annot, annot_cols_df = annot,              annot_rows_side = \"left\", annot_cols_side = \"top\",              layout = \"br\", include_diag = TRUE, show_names_diag = TRUE,              show_names_x = FALSE, show_names_y = FALSE) +   theme(plot.margin = margin(20, 10, 10, 50))  plt1 + plt2 set.seed(123) row_annot <- as.data.frame(replicate(4, rnorm(ncol(mtcars)))) rownames(row_annot) <- colnames(mtcars) ggcorrhm(mtcars, annot_rows_df = row_annot,          legend_order = NA,          # annot_dist controls the distance between the heatmap and the annotation          annot_dist = 0,          # annot_gap controls the gap between annotations          annot_gap = 1,          # annot_size controls the size (width if row, height if column) of the annotations          annot_size = 2) df_in <- matrix(1:9, nrow = 3, ncol = 3, byrow = TRUE) row_annot <- data.frame(annot1 = 1:3, annot2 = 4:6) col_annot <- data.frame(annot3 = letters[1:3], annot4 = letters[4:6])  gghm(df_in, annot_rows_df = row_annot, annot_cols_df = col_annot,      legend_order = NA,      # border_col and border_lwd control both the heatmap and annotations      border_col = \"yellow\", border_lwd = 1,      annot_rows_params = list(        # Hide labels        show_names = FALSE      ),      annot_cols_params = list(        # 'border_col' and 'border_lwd' control the border colour and linewidth        border_col = \"white\", border_lwd = .3,        # 'dist', 'gap', and 'size' work as described in the previous chunk        dist = 1, gap = 0.3, size = 0.3      ))"},{"path":"https://leod123.github.io/ggcorrheatmap/articles/annotation.html","id":"annotation-labels","dir":"Articles","previous_headings":"","what":"Annotation labels","title":"Annotation","text":"sizes names can changed using annot_names_size argument. customisation possible passing named lists annot_rows_name_params annot_cols_name_params arguments. lists passed grid::textGrob(), see help page (example ) arguments supported.  annotation labels long cut , plot margins can adjusted using ggplot2::theme() function plot.margin argument. Alternatively, figure height can increased, heatmap set use fixed aspect ratio (ggplot2::coord_fixed()). can overwritten adding ggplot2::coord_cartesian() output plot.","code":"df_in <- matrix(1:9, nrow = 3, ncol = 3, byrow = TRUE) row_annot <- data.frame(annot1 = 1:3, annot2 = 4:6) col_annot <- data.frame(annot3 = letters[1:3], annot4 = letters[4:6])  gghm(df_in, annot_rows_df = row_annot, annot_cols_df = col_annot,      legend_order = NA,      annot_rows_name_params = list(        # Use 'grid::gpar' for the 'gp' argument for a number of text-related parameters        gp = grid::gpar(col = \"magenta\", alpha = 0.5, fontsize = 20, fontface = \"bold\")      ),      annot_cols_name_params = list(        # 'rot' instead of 'angle' to change the angle        rot = -45, hjust = 0.7, vjust = 0      ))"},{"path":"https://leod123.github.io/ggcorrheatmap/articles/annotation.html","id":"dealing-with-missing-values","dir":"Articles","previous_headings":"","what":"Dealing with missing values","title":"Annotation","text":"NAs annotation default coloured grey. colour can changed using annot_na_col argument, specifying colour na.value argument ggplot2 scale supplied using annot_rows_col annot_cols_col arguments. annot_na_remove argument can set TRUE display cells . annotation data frame contain names axis, rows/columns left empty. side note, annot_na_remove default set na_remove setting NAs removed main heatmap removes NAs annotation unless annot_na_remove changed. Similarly, annot_na_col argument also set default na_col.  can seen plots previous sections, legends may cut many annotations. Fitting legends can tricky covered legends article.","code":"set.seed(123) # Row annotation with NAs row_annot <- data.frame(.names = colnames(mtcars),                         a = sample(c(\"A\", \"B\", NA), ncol(mtcars), TRUE),                         b = sample(c(\"V\", \"W\", NA), ncol(mtcars), TRUE)) row_fill <- list(a = scale_fill_brewer(palette = \"Purples\", na.value = \"green\",                                        # Adjust the order of the legend                                        guide = guide_legend(order = 2)))  # Column annotation with missing names col_annot <- data.frame(.names = sample(colnames(mtcars), 7),                         c = rnorm(7),                         d = runif(7))  plt1 <- ggcorrhm(mtcars, annot_rows_df = row_annot, annot_cols_df = col_annot,                  annot_na_remove = TRUE) plt2 <- ggcorrhm(mtcars, annot_rows_df = row_annot, annot_cols_df = col_annot,                  annot_na_remove = FALSE, annot_rows_col = row_fill,                  annot_na_col = \"blue\")  plt1 + plt2"},{"path":"https://leod123.github.io/ggcorrheatmap/articles/clustering.html","id":"dendrogram-position","dir":"Articles","previous_headings":"","what":"Dendrogram position","title":"Clustering","text":"positions dendrograms can changed dend_rows_side (‘left’ ‘right’) dend_cols_side (‘top’ ‘bottom’) arguments. triangular layouts (symmetric matrices) dendrograms placed non-empty sides heatmap.  annotation dendrogram side, dendrogram moved make place annotation.","code":"# The dendrogram sides can be adjusted with the 'dend_rows_side' and 'dend_cols_side' arguments plt1 <- ggcorrhm(mtcars, cluster_rows = TRUE, cluster_cols = TRUE,                  dend_rows_side = \"left\", dend_cols_side = \"top\")  # Dendrograms can be hidden by setting 'show_dend_rows' and/or 'show_dend_cols' to FALSE plt2 <- ggcorrhm(mtcars, cluster_rows = TRUE, cluster_cols = TRUE, layout = \"bl\",                  show_dend_rows = FALSE, dend_cols_side = \"top\")  plt1 + plt2 annot <- data.frame(.names = colnames(mtcars), a = 1:11) ggcorrhm(mtcars, cluster_rows = TRUE, cluster_cols = TRUE,          annot_rows_df = annot, annot_cols_df = annot,          dend_rows_side = \"left\")"},{"path":"https://leod123.github.io/ggcorrheatmap/articles/clustering.html","id":"changing-how-the-dendrograms-look","dir":"Articles","previous_headings":"","what":"Changing how the dendrograms look","title":"Clustering","text":"dend_col, dend_dist, dend_height, dend_lwd, dend_lty arguments change colour, distance heatmap, height (scaling), linewidth, linetype dendrograms, respectively.  apply changes one dendrograms, use dend_rows_params dend_cols_params arguments. arguments take named list containing one col, dist, height, lwd, lty.","code":"ggcorrhm(mtcars, cluster_rows = TRUE, cluster_cols = TRUE,          dend_col = \"cyan\", dend_height = 2, dend_lwd = 1, dend_lty = 2) ggcorrhm(mtcars, cluster_rows = TRUE, cluster_cols = TRUE,          dend_rows_params = list(col = \"cyan\", height = 2),          dend_cols_params = list(lwd = 1, lty = 2, dist = 1))"},{"path":"https://leod123.github.io/ggcorrheatmap/articles/clustering.html","id":"more-customisation-using-dendextend","dir":"Articles","previous_headings":"","what":"More customisation using dendextend","title":"Clustering","text":"Finer customisation dendrograms can done dend_rows_extend dend_cols_extend arguments. use dendextend package change dendrogram appearance. input can either named list lists, element named dendextend function use contains list arguments pass, functional sequence (fseq object) strings together functions use. examples shown , see dendextend vignette vignette(\"dendextend\", package = \"dendextend\") details use functions.  also possible display nodes dendrograms.  Leaves can reordered using functions like ladderize rotate, though recommended one dimension matrix symmetric diagonal may end strange places. Triangular layouts supported clustering causes matrix become asymmetric.   Finally, since cluster_rows cluster_cols can take dendrogram objects, possible dendextend customisation externally. dend_rows_extend dend_cols_extend applied top , meaning two approaches can combined.","code":"# List method ggcorrhm(mtcars, cluster_rows = TRUE, cluster_cols = TRUE, dend_height = 1,          # Multiple elements can use the same function as lists don't require unique names          dend_rows_extend = list(            set = list(\"branches_k_col\", k = 3),            set = list(\"branches_lty\", c(1, 2, 3))          ),          # NULL or empty list if no arguments are to be passed          dend_cols_extend = list(            highlight_branches_lwd = list(values = seq(1, 4)),            highlight_branches_col = list()          )) #> Loading required namespace: colorspace # The equivalent call using the fseq method # library(dplyr) # library(dendextend) # ggcorrhm(mtcars, cluster_rows = TRUE, cluster_cols = TRUE, #          dend_rows_extend = . %>% #            set(\"branches_k_col\", k = 3) %>% #            set(\"branches_lty\", c(1, 2, 3)), #          dend_cols_extend = . %>% #            highlight_branches_lwd(values = seq(1, 4)) %>% #            highlight_branches_col()) # Get clustered labels clust <- hclust(dist(cor(mtcars))) clust_lab <- clust$labels[clust$order]  ggcorrhm(mtcars, cluster_rows = TRUE, cluster_cols = TRUE, dend_height = 1,          # Here using the fseq method          dend_rows_extend = . %>%            # More on customising segments            # Can specify branches to affect by labels using the 'by_labels_branches_*' options            set(\"by_labels_branches_col\", value = clust_lab[1:5], TF_values = \"red\") %>%            set(\"by_labels_branches_lty\", value = c(\"drat\", \"vs\"), TF_values = 3) %>%            set(\"by_labels_branches_lwd\", value = clust_lab[6:11], TF_values = 1) %>%            # Node and leaf options            # Specify all nodes before leaves so the leaf options are not overwritten            # pch must be specified for a node to be drawn            set(\"nodes_pch\", 19) %>%            set(\"nodes_cex\", 2) %>%            set(\"nodes_col\", \"orange\") %>%            set(\"leaves_pch\", 21) %>%            set(\"leaves_cex\", 3) %>%            set(\"leaves_col\", \"purple\"),          dend_cols_extend = . %>%            highlight_branches_col() %>%            # Node options            set(\"nodes_pch\", c(15, 16, 17)) %>%            set(\"nodes_cex\", 2:4) %>%            set(\"nodes_col\", 1:5)) plt1 <- gghm(scale(mtcars[11:15, ]), cluster_rows = TRUE, na_remove = TRUE) # Remove NaNs introduced by scaling plt2 <- gghm(scale(mtcars[11:15, ]), cluster_rows = TRUE, na_remove = TRUE,              # dendextend::rotate() to flip the order of rows              dend_rows_extend = . %>% rotate(5:1))  plt1 / plt2 # Only the rows are reordered, causing the matrix to become asymmetric # If the layout were triangular (or mixed), the warning would be slightly different # and the same plot as below would be produced (forced full layout). ggcorrhm(mtcars, cluster_rows = TRUE, cluster_cols = TRUE,          dend_rows_extend = list(ladderize = NULL)) #> Warning: The clustering has ordered rows and columns differently and caused the matrix #> to become asymmetric. The diagonal may be scrambled due to the unequal row and #> column orders. # Cluster data before clust1 <- mtcars %>% cor() %>% dist() %>% hclust() %>% as.dendrogram() # Apply some dendextend functions clust2 <- clust1 %>% highlight_branches_col() %>%   set(\"nodes_pch\", 20) %>% set(\"nodes_col\", \"green\") %>% set(\"nodes_cex\", 2) %>%   set(\"leaves_pch\", 18) %>% set(\"leaves_col\", \"yellow\") %>% set(\"leaves_cex\", 3)  ggcorrhm(mtcars, cluster_rows = clust1, cluster_cols = clust2,          # Increase height and linewidth for visibility          dend_height = .6, dend_lwd = 1,          # Apply some customisation to the row dendrogram too          dend_rows_extend = . %>% raise.dendrogram(3) %>%            # Rotating the row dendrogram of a symmetric matrix to be in the            # reverse order will give a diagonal that runs from the bottom left            # to the top right, but a warning will still be produced. Mixed layouts             # allow for such diagonals without warnings            rotate(11:1)) #> Warning: The clustering has ordered rows and columns differently and caused the matrix #> to become asymmetric. The diagonal may be scrambled due to the unequal row and #> column orders."},{"path":"https://leod123.github.io/ggcorrheatmap/articles/correlation.html","id":"changing-the-colours","dir":"Articles","previous_headings":"","what":"Changing the colours","title":"Correlation heatmaps","text":"ggcorrhm() sets fill scale use ggplot2::scale_fill_gradient2() limits set [-1, 1]. Unique ggcorrhm() arguments high, mid low control legend colours. Like gghm(), bins limits arguments create binned scale change limits, respectively.  complete control needed, col_scale argument can used overwrite default scale. can string specifying Brewer Viridis scale, ggplot2 scale object.","code":"ggcorrhm(mtcars, high = \"green\", low = \"magenta\", mid = \"yellow\", bins = 4L) plt1 <- ggcorrhm(mtcars, col_scale = \"RdYlGn\")  # Arguments like bins and limits still work with brewer and viridis scales plt2 <- ggcorrhm(mtcars, col_scale = \"PuOr\", bins = 5L)  plt1 + plt2"},{"path":"https://leod123.github.io/ggcorrheatmap/articles/correlation.html","id":"changing-the-layout","dir":"Articles","previous_headings":"","what":"Changing the layout","title":"Correlation heatmaps","text":"symmetric heatmaps, layout argument can used get triangular layouts. possible layouts full matrix, top left, top right, bottom left, bottom right. Note top right bottom left layouts just top right bottom left triangles symmetric matrix, top left bottom right layouts actually bottom left top right layouts flipped y axis retain diagonal. means layouts may y axis order reversed.","code":"plt1 <- ggcorrhm(mtcars, layout = \"topleft\") # The diagonal is displayed by default but can be hidden using the `include_diag` argument # Layouts can be specified by the first letters e.g. br, tl, f (for full), w (whole, same as full) plt2 <- ggcorrhm(mtcars, layout = \"br\", include_diag = FALSE)  plt1 + plt2"},{"path":"https://leod123.github.io/ggcorrheatmap/articles/correlation.html","id":"label-customisation","dir":"Articles","previous_headings":"","what":"Label customisation","title":"Correlation heatmaps","text":"symmetric matrices, axis names drawn diagonal. show_names_diag, show_names_x show_names_y arguments control names drawn. looks names displayed diagonal symmetric matrix can adjusted names_diag_params argument, takes named list parameters pass ggplot2::geom_text(). names displayed x y axes, use ggplot2::theme() generated plot object change appearance.","code":"plt1 <- ggcorrhm(mtcars, layout = \"bl\", legend_order = NA, include_diag = FALSE,                  names_diag_params = list(                    angle = 45, vjust = 0.5, hjust = 0.5, colour = \"magenta\"                  )) # Also take vectorised input set.seed(123) plt2 <- ggcorrhm(mtcars, layout = \"br\", include_diag = FALSE,                  names_diag_params = list(                    angle = c(0, rep(-45, 9), 90),                    hjust = c(rep(0.7, 10), 0.3),                    colour = sample(c(\"red\", \"green\", \"blue\"), 11, TRUE)                  ))  plt1 + plt2"},{"path":"https://leod123.github.io/ggcorrheatmap/articles/correlation.html","id":"legend-position","dir":"Articles","previous_headings":"","what":"Legend position","title":"Correlation heatmaps","text":"legend can moved around adding theme output plot using ggplot2::theme(). Use legend.position.inside argument move legend plotting area make use empty space triangular layouts.","code":"plt1 <- ggcorrhm(mtcars) +   theme(legend.position = \"top\",         legend.title = element_text(vjust = 0.8)) plt2 <- ggcorrhm(mtcars, layout = \"br\") +   theme(legend.position = \"inside\",         legend.position.inside = c(0.3, 0.75))  plt1 + plt2"},{"path":"https://leod123.github.io/ggcorrheatmap/articles/correlation.html","id":"clustering-and-annotation","dir":"Articles","previous_headings":"","what":"Clustering and annotation","title":"Correlation heatmaps","text":"Just like gghm(), heatmap can clustered annotated. Triangular layouts limit positions annotation dendrograms non-empty sides heatmap.","code":"set.seed(123) # Make a correlation heatmap with a triangular layout, annotations and clustering row_annot <- data.frame(.names = colnames(mtcars),                         annot1 = sample(letters[1:3], ncol(mtcars), TRUE),                         annot2 = rnorm(ncol(mtcars))) ggcorrhm(mtcars, layout = \"tl\",          cluster_rows = TRUE, cluster_cols = TRUE,          show_dend_rows = FALSE,          annot_rows_df = row_annot,          annot_rows_names_side = \"top\")"},{"path":"https://leod123.github.io/ggcorrheatmap/articles/correlation.html","id":"cell-text","dir":"Articles","previous_headings":"","what":"Cell text","title":"Correlation heatmaps","text":"cell_labels argument labels cells values user-supplied values, explained heatmap article. cell_labels matrix/data frame shape matrix plotted (using row column names), ggcorrhm correlation matrix. keep mind triangular layouts top left bottom right triangles display bottom left top right triangles y axis order flipped, reflected cell labels .","code":"lab_mat <- matrix(1:121, nrow = 11, ncol = 11, byrow = TRUE,                   dimnames = list(colnames(mtcars), colnames(mtcars)))  plt_list <- lapply(c(\"tl\", \"tr\", \"bl\", \"br\"), function(lt) {   # Play a bit with the legend for the last plot   legend_order <- if (lt == \"br\") 1 else NA   ggcorrhm(mtcars, layout = lt, legend_order = legend_order,            cell_labels = lab_mat, show_names_diag = FALSE) +     theme(legend.position = \"inside\",           legend.position.inside = c(0.025, 1.075)) })  wrap_plots(plt_list)"},{"path":"https://leod123.github.io/ggcorrheatmap/articles/correlation.html","id":"cell-shape","dir":"Articles","previous_headings":"","what":"Cell shape","title":"Correlation heatmaps","text":"Correlation heatmaps sometimes plotted circles. Passing value 1 25 mode argument allows different cell shapes. Shapes 21-25 support filling use fill scales 1-20 filled use colour scales (relevant scale object passed). shape size set vary values size_range argument (found gghm()), scaling absolute value correlation. size_scale can provided overwrite behaviour. size legend hidden default using ggcorrhm() show absolute values correlations (legend can shown legend_order argument necessary). Setting mode ‘text’ writes values empty cells, text colour scaling correlation values.  ’s also possible draw mixed layouts providing two values layout mode. See mixed layouts article details.","code":"# If mode is a number, the R pch symbols are used, meaning 21 produces filled circles. plt1 <- ggcorrhm(mtcars, mode = 21) + labs(title = \"mode = 21\") # It is also possible to use shapes other than circles. Only 21-25 support filling. # Change the size range using the size_range argument plt2 <- ggcorrhm(mtcars, mode = 23, size_range = c(2, 7)) +   # Can add a grid in the background with ggplot2::theme()   theme(panel.grid.major = element_line()) +   labs(title = \"mode = 23\")  plt1 + plt2 # Default modes for mixed layouts is 'heatmap' and 'text' ggcorrhm(mtcars, layout = c(\"tr\", \"bl\"))"},{"path":"https://leod123.github.io/ggcorrheatmap/articles/correlation.html","id":"p-values","dir":"Articles","previous_headings":"","what":"P-values","title":"Correlation heatmaps","text":"ggcorrhm() adds support correlation p-values can calculated setting p_values argument TRUE. values can adjusted multiple testing passing string specifying adjustment method p_adjust argument. correlation matrix symmetric, diagonal excluded half -diagonal values used adjustment. calculated p-values included data return_data TRUE. P-values adjusted p-values correlations diagonal symmetric matrix set 0 correlations always 1. default, cells marked asterisks p_values TRUE. p_thresholds argument controls p-value thresholds. p_thresholds must NULL (thresholds symbols) named numeric vector values specify thresholds (ascending order) names symbols use adjusted p-value threshold. stats::symnum() used convert p-values last value p_thresholds must 1 (higher number) set upper bound. default, p_thresholds set c(\"***\" = 0.001, \"**\" = 0.01, \"*\" = 0.05\", 1). can seen, 1 left unnamed p-values 0.05 1 unmarked.  mixed layout possible display p-values half plot passing vector list length two p_values argument. cell_labels TRUE (correlation values written cells), symbols p_thresholds added end correlation values.  also possible write p-values instead correlation values setting cell_labels cell_label_p TRUE.  also carried ‘text’ mode.  returning data using ggplot2 functions possible creative p-value marking ggcorrhm() allows box.","code":"# P-value symbols added to the plot plt1 <- ggcorrhm(mtcars, p_values = TRUE, p_adjust = \"bonferroni\") # Changing the symbols plt2 <- ggcorrhm(mtcars, p_values = TRUE, p_adjust = \"bonferroni\",                  p_thresholds = c(\"+\" = 0.01, \"*\" = 0.05, \"ns\" = 1))  plt1 + plt2 # P-values only in the bottom right, mode 'none' for labels with empty background ggcorrhm(mtcars, layout = c(\"tl\", \"br\"), mode = c(\"hm\", \"none\"), p_adjust = \"bonferroni\",          p_values = c(FALSE, TRUE), cell_labels = c(FALSE, TRUE)) # P-values and labels only in one half, correlation labels in the other ggcorrhm(mtcars, layout = c(\"tl\", \"br\"), mode = c(\"hm\", \"none\"), p_adjust = \"bonferroni\",          p_values = c(FALSE, TRUE), cell_labels = TRUE,          cell_label_p = c(FALSE, TRUE)) # Same as previous but text mode ggcorrhm(mtcars, layout = c(\"tl\", \"br\"), mode = c(\"hm\", \"text\"), p_adjust = \"bonferroni\",          p_values = c(FALSE, TRUE),          # In text mode the labels are displayed regardless so cell_labels can be FALSE          cell_labels = c(TRUE, FALSE),          cell_label_p = c(FALSE, TRUE)) p <- ggcorrhm(mtcars, p_values = TRUE, p_thresholds = NULL,               p_adjust = \"bonferroni\", return_data = TRUE,               layout = \"br\", include_diag = FALSE) p$plot_data <- mutate(p$plot_data,                       p_lty = case_when(p_adj < 0.05 ~ 1, TRUE ~ 3),                       p_lwd = case_when(p_adj < 0.05 ~ 1, TRUE ~ 0.5),                       p_size = -log10(p_adj)) ggcorrhm(mtcars, border_lty = p$plot_data$p_lty, border_lwd = p$plot_data$p_lwd,          layout = \"br\", include_diag = FALSE) +   geom_point(aes(size = p_size), data = p$plot_data %>%                filter(p_adj < 0.05, as.character(row) != as.character(col)),              shape = \"*\") +   scale_size(range = c(4, 8)) +   labs(size = \"-log10(p_adj)\") p <- ggcorrhm(mtcars, p_values = TRUE, p_thresholds = NULL,               p_adjust = \"bonferroni\", return_data = TRUE,               layout = \"tl\", include_diag = FALSE) ggcorrhm(mtcars, layout = \"tl\", include_diag = FALSE) +   geom_point(data = p$plot_data %>%                # Mark cells above a threshold                filter(p_adj >= 0.05, as.character(row) != as.character(col)),              shape = 4, size = 8)"},{"path":"https://leod123.github.io/ggcorrheatmap/articles/correlation.html","id":"other-packages","dir":"Articles","previous_headings":"","what":"Other packages","title":"Correlation heatmaps","text":"benefit making plot ggplot2 possibility modifying arranging plot using ggplot2 many extensions. ggcorrheatmap convenient making simple correlation heatmaps, options extensive customisation appearance layout, built-support clustering (dendrograms) annotation. Another package making correlation heatmaps ggplot2 ggcorrplot faster ways visualising p-values. plot made ggplot2 necessary, corrplot package can make flexible correlation plots many alternative visualisations.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/articles/heatmap.html","id":"specifying-colours","dir":"Articles","previous_headings":"","what":"Specifying colours","title":"Making a heatmap","text":"colours heatmap can adjusted passing string specifying Brewer Viridis scale ggplot2::scale_fill_* function call col_scale argument. limits can changed giving vector limits argument.  bins argument creates binned scale (continuous data). bins float number (class ‘double’), ggplot2 try put breaks nice numbers cost changing number bins. bins integer exact number bins instead prioritised, breaks may end strange numbers.  values input matrix discrete discrete scale used. input data frame mixed types (e.g. columns character vectors numeric), resulting heatmap discrete.  gghm() fill, colour size legends shown default. legend order can changed using legend_order argument. ggcorrhm() tries hide legends default. Legends scales covered scales legends article.","code":"# Use the Viridis D (can also be \"viridis\") option gghm(mtcars, col_scale = \"D\") plt1 <- gghm(mtcars, col_scale = \"A\", bins = 6) plt2 <- gghm(mtcars, col_scale = \"A\", bins = 6L)  plt1 + plt2 # Heatmap with discrete values # Border colour and linewidth can be changed using the `border_col` and `border_lwd` arguments set.seed(123) gghm(replicate(15, sample(letters[1:3], 15, TRUE)),      col_scale = \"Pastel2\", border_col = \"thistle1\",      border_lwd = 1)"},{"path":"https://leod123.github.io/ggcorrheatmap/articles/heatmap.html","id":"plotting-modes","dir":"Articles","previous_headings":"","what":"Plotting modes","title":"Making a heatmap","text":"mode argument takes string determines values plotted. ‘heatmap’ ‘hm’ gives default heatmap, ‘text’ results values written , number 1 25 changes cells corresponding shapes (pch). also ‘none’ mode draws empty tiles. ‘text’ mode text colour scales values cells. Instead fill_scale, use col_scale argument set scale.  shape modes, 1-20 use colour scales 21-25 use fill scales. sizes scale cell values scale can customised passing ggplot2::scale_size_* functions size_scale argument. fillable shapes border colour linewidth can changed using border_col border_lwd arguments.","code":"gghm(mtcars[1:15, ], mode = \"text\",      # Viridis \"A\" (\"magma\")      col_scale = \"A\") gghm(mtcars[1:15, ], mode = 22,      border_col = \"lightblue\", border_lwd = 1,      col_scale = \"G\",      # The range argument sets the range of sizes to plot      size_scale = scale_size_continuous(range = c(1, 7))) gghm(mtcars[1:15, ], mode = \"none\")"},{"path":"https://leod123.github.io/ggcorrheatmap/articles/heatmap.html","id":"cell-borders","dir":"Articles","previous_headings":"","what":"Cell borders","title":"Making a heatmap","text":"Cell borders default grey, can removed setting border_col (border colour) border_lwd (border linewidth) NA border_lty (border linetype) 0 (mode number) border_lwd 0 (mode number).  border_col, border_lwd, border_lty can take either values length 1 length input data. Using return_data argument get plotting data makes easier implement conditional customisation borders.","code":"# Use the volcano data # It contains many rows and columns making the axes hard to read. # Can either turn off labels with `show_names_x` and `show_names_y`, or use # ggplot2::scale_x/y_discrete to change the labels # (keep in mind that the y label order is reversed in the default layout and that overwriting the scale can change the label positions) gghm(volcano, col_scale = \"H\",      border_col = NA, border_lwd = 0,      show_names_x = FALSE, show_names_y = FALSE) # Single values as input plt1 <- gghm(cor(mtcars), col_scale = \"G\",              border_col = \"orange\", border_lwd = 1, border_lty = 2)  # Two-step approach: # - Make a plot with the data of interest, retrieve the plotting data # - Make col, lwd, lty vectors based on some condition in the plotting data and pass to gghm plt_dat <- gghm(cor(mtcars), return_data = TRUE)$plot_data plt_dat <- mutate(plt_dat,                   # The plotting data contains the columns 'row', 'col', and 'value', so avoid those names                   colr = case_when(row == \"hp\" ~ \"red\", col == \"vs\" ~ \"yellow\", TRUE ~ \"grey\"),                   lwd = case_when(row == \"hp\" | col == \"vs\" ~ 1.5, TRUE ~ 0.5),                   lty = case_when(value > 0.5 ~ 1, TRUE ~ 2)) plt2 <- gghm(cor(mtcars), col_scale = \"G\",              border_col = plt_dat$colr,              border_lwd = plt_dat$lwd,              border_lty = plt_dat$lty)  # Make one figure with both plots using the patchwork package plt1 + plt2"},{"path":"https://leod123.github.io/ggcorrheatmap/articles/heatmap.html","id":"handling-nas","dir":"Articles","previous_headings":"","what":"Handling NAs","title":"Making a heatmap","text":"NAs data can removed using na_remove argument set specific colour using na_col col_scale arguments. Setting na_remove TRUE removes NAs plot, can still interfere clustering whole row column NAs.","code":"# Introduce NAs df_na <- as.matrix(mtcars) set.seed(123) df_na[sample(length(df_na), 100)] <- NA  # With NAs and the default colour na_plt1 <- gghm(df_na, legend_order = NA,                 # Darker borders for demonstration                 border_col = \"black\", border_lwd = .3) +   labs(title = \"NAs default\") # Colour NAs using scale function na_plt2 <- gghm(df_na, legend_order = NA, show_names_y = FALSE,                 border_col = \"black\", border_lwd = .3,                 na_col = \"white\") +   labs(title = \"Change NA colour\") # Remove NAs, removes the border as well na_plt3 <- gghm(df_na, legend_order = NA, show_names_y = FALSE,                 border_col = \"black\", border_lwd = .3,                 na_remove = TRUE) +   labs(title = \"NAs removed\")  na_plt1 + na_plt2 + na_plt3 & theme(plot.title = element_text(hjust = 0.5))"},{"path":"https://leod123.github.io/ggcorrheatmap/articles/heatmap.html","id":"clustering-and-annotation","dir":"Articles","previous_headings":"","what":"Clustering and annotation","title":"Making a heatmap","text":"Clustering can applied rows columns using cluster_rows cluster_cols arguments. See clustering article clustering.  Row column annotation added providing data frames annot_rows_df annot_cols_df arguments. details annotation can found annotation article.  Clustering annotation can course added simultaneously.","code":"gghm(scale(mtcars), cluster_rows = TRUE, cluster_cols = TRUE) set.seed(123) # Make annotation data, use 15 rows for visibility row_annot <- data.frame(.names = rownames(mtcars)[1:15],                         a = sample(letters[1:4], 15, TRUE))  gghm(mtcars[1:15, ], annot_rows_df = row_annot, annot_rows_names_side = \"top\") gghm(scale(mtcars)[1:15, ], cluster_rows = TRUE,      annot_rows_df = row_annot, annot_rows_names_side = \"top\")"},{"path":"https://leod123.github.io/ggcorrheatmap/articles/heatmap.html","id":"cell-labels","dir":"Articles","previous_headings":"","what":"Cell labels","title":"Making a heatmap","text":"Cell labels can displayed using cell_labels argument takes either logical matrix data frame. logical, cell values displayed. matrix/data frame, values used instead. matrix contain row column names input, rows columns different names cells NAs silently dropped.  cell_label_col, cell_label_size cell_label_digits control colours, sizes number decimals (numeric) labels. Keep mind data frames passed cell_labels converted matrices, data frame contains numbers strings numbers converted strings numbers rounded. case numbers can rounded passed. mentioned , ‘text’ mode makes cells text scales cell values. cell_labels TRUE matrix/data frame, labels displayed instead, meaning user-supplied cell labels can use colour scale (also meaning ‘text’ mode cell_labels FALSE ‘text’ mode cell_labels TRUE).","code":"set.seed(123) # Make 5x5 matrix to plot with values between 1 and 10 plot_data <- as.matrix(replicate(5, sample(1:10, 5, TRUE)))  # Make label data with letters label_mat <- plot_data label_mat[] <- letters[1:25] # Use a lighter scale for visibility fill_scl <- scale_fill_gradient(high = \"pink\", low = \"white\")  plt1 <- gghm(plot_data, col_scale = fill_scl, cell_labels = TRUE, cell_label_size = 5) +   labs(title = \"Using cell values\") plt2 <- gghm(plot_data, col_scale = fill_scl, cell_labels = label_mat, cell_label_size = 5) +   labs(title = \"Using external values\")  plt1 + plt2 & theme(plot.title = element_text(size = 18)) plt1 <- gghm(plot_data, cell_labels = TRUE, col_scale = fill_scl,              cell_label_size = 5, cell_label_col = \"#63B8FF\", cell_label_digits = 4) +   labs(title = \"size, colours, decimals\")  # Text requires colour instead of fill scale col_scl <- scale_colour_gradient(high = \"pink\", low = \"white\") plt2 <- gghm(plot_data, cell_labels = label_mat, mode = \"text\",              col_scale = col_scl, cell_label_size = 8) +   labs(title = \"'text' mode\")  plt1 + plt2 & theme(plot.title = element_text(size = 18))"},{"path":"https://leod123.github.io/ggcorrheatmap/articles/heatmap.html","id":"external-customisation","dir":"Articles","previous_headings":"","what":"External customisation","title":"Making a heatmap","text":"plotting data can returned setting return_data argument TRUE, allowing customisation e.g. cell labels adding geoms finished plot shown . explained ‘Cell borders’ section, arguments values passed ggplot2::geom_* functions can vectors one value per cell. drawing order can get bit confusing; full, top right bottom left layouts cells drawn top left moving column; contrast, top left bottom right layouts cells drawn bottom left moving column (due y-axis levels reversed). rows ordered drawing order data returned return_data TRUE can used reference. However, general, passing vectors static aesthetics ggplot2 can become tricky adding another geom output plot robust.  many arguments, allowing quite flexibility heatmap layout. arguments showcased articles, hopefully can help. go making correlation heatmaps, clustering annotation, making mixed layout heatmaps, ways deal legends.","code":"plot_list <- gghm(scale(mtcars), return_data = TRUE, border_col = NA,                   col_scale = scale_fill_gradient2(low = \"deepskyblue\", mid = \"white\", high = \"salmon\"))  # Add own labels based on value (also possible by supplying a matrix to cell_labels) plot_list$plot_data$lab <- ntile(plot_list$plot_data$value, 5)  plt1 <- plot_list$plot +   geom_text(aes(label = lab), plot_list$plot_data, size = 3)  # Or maybe points (cell_labels uses `geom_text` so the asterisks would not be positioned in the middle of the cells) plot_list$plot_data$lab <- ifelse(plot_list$plot_data$value > 1 |                                   plot_list$plot_data$value < -1, \"*\", NA) plt2 <- plot_list$plot +   geom_point(data = subset(plot_list$plot_data, !is.na(lab)), shape = \"*\", size = 4)  plt1 + plt2"},{"path":"https://leod123.github.io/ggcorrheatmap/articles/heatmap.html","id":"other-packages","dir":"Articles","previous_headings":"","what":"Other packages","title":"Making a heatmap","text":"ggcorrheatmap supports making general heatmaps, heatmap package relatively lacking features. pheatmap package ComplexHeatmap package can used making heatmaps many options customisation (although ggplot2).","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/articles/legends.html","id":"scales","dir":"Articles","previous_headings":"","what":"Scales","title":"Scales and legends","text":"explained articles, colour scale argument col_scale takes NULL (default scales), character (Brewer Viridis scales) ggplot2 scale objects. passing scale objects, make sure correct aesthetic used (fill colour/color depending plotting mode).  also true annotation scale arguments annot_rows_col annot_cols_col.  col_scale character, “rev_” “_rev” can added beginning end, respectively, reverse scale. also works annotation scales.  default scale main heatmap different ggcorrhm() assumes correlations plotted. also arguments modify scale, colours binning. plot using mixed layout, col_scale can also take vector list apply different scales different triangles.  col_scale can still one value apply scale triangles. work scale objects, two triangles may use different aesthetics (fill colour). means two colour legends main heatmap two triangles use different aesthetics, even use colours. ggcorrhm() hides one legends default legend order section goes detail can done.  using scale objects, arguments change scales legends col_name legend_order , ggcorrhm(), high, mid, low etc ignored instead give user full control. allows flexibility, changing breaks, bin sizes, changing bounds values treated. default way ggplot2 deals values outside scale range (bound value) replace NAs. oob argument scale functions can change behaviour, e.g. OOB values use extreme colours scale.  binning scales bins argument, number ‘double’ class prioritise breaks nice numbers integer prioritise number bins. side note, --bound values binned scales also default using ‘squish’ strategy shown .  using scale objects, breaks continuous binned scales can put wherever desired.","code":"plt1 <- gghm(volcano, col_name = \"Default\",              border_col = NA, show_names_x = FALSE, show_names_y = FALSE)  plt2 <- gghm(volcano,              # Brewer Spectral palette              col_scale = \"A\", col_name = \"Character\",              border_col = NA, show_names_x = FALSE, show_names_y = FALSE)  plt3 <- gghm(volcano,              # Custom scale              col_scale = scale_fill_gradient2(                high = \"pink\", mid = \"white\", low = \"lightblue\",                midpoint = 140, name = \"Custom\"              ),              border_col = NA, show_names_x = FALSE, show_names_y = FALSE)  plt1 + plt2 + plt3 &   theme(legend.position = \"bottom\",         legend.title = element_text(vjust = 0.8)) row_annot <- data.frame(.names = rownames(mtcars)[1:10],                         Default = 1:10,                         Character = 1:10,                         Custom = 1:10)  row_annot_fill <- list(Default = NULL,                        Character = \"Spectral\",                        Custom = scale_fill_gradient2(                          high = \"pink\", mid = \"white\", low = \"lightblue\",                          midpoint = 6                        ))  gghm(mtcars[1:10, 1:5],      annot_rows_df = row_annot,      annot_rows_col = row_annot_fill,      # Make annotation larger and hide heatmap legend      annot_size = 1,      legend_order = c(NA, 1:3)) +   theme(plot.margin = margin(0, 0, 30, 0)) row_annot <- data.frame(\"Default\" = 1:nrow(volcano),                         \"Reversed\" = 1:nrow(volcano)) row_annot_colr <- list(\"Default\" = \"A\", \"Reversed\" = \"A_rev\")  gghm(volcano, show_names_x = FALSE, show_names_y = FALSE, border_col = NA,      col_scale = \"rev_A\", col_name = \"Reversed\",      annot_rows_df = row_annot,      annot_rows_col = row_annot_colr,      # Make the annotation larger for visibility      annot_size = 3, annot_dist = 1.5) +   # Change the margins a bit too   theme(plot.margin = margin(0, 0, 40, 0)) plt_dat <- matrix(   sapply(1:10, function(x) seq(x, x + 9)),   nrow = 10 ) gghm(plt_dat, layout = c(\"tl\", \"br\"),      mode = c(\"hm\", \"hm\"),      # For Viridis options, both the short and long versions work      col_scale = c(\"magma\", \"RdYlGn\")) gghm(plt_dat, layout = c(\"tl\", \"br\"),      mode = c(\"hm\", \"text\"), col_scale = \"A\") # Normal limits plt1 <- gghm(plt_dat, col_scale = \"RdYlGn\",              cell_labels = TRUE)  # Narrower limits with handling of oob values plt2 <- gghm(plt_dat, layout = c(\"tr\", \"bl\"),      mode = c(\"hm\", \"hm\"),      col_scale = list(        # scale_fill_distiller to use Brewer palettes with continuous data        scale_fill_distiller(          palette = \"RdYlGn\",          # Values outside the limits are replaced with NAs          limits = c(7, 13),          # Can then change the colour using the na.value argument          # (corresponding to na_col in gghm)          na.value = \"beige\"        ),                scale_fill_distiller(          palette = \"RdYlGn\",          limits = c(7, 13),          # Change oob strategy 'oob' argument          # scales::squish assigns the extreme colours to values outside the range          oob = scales::squish        )      ), cell_labels = TRUE)  plt1 + plt2 # Make plot data between -1 and 1 (like correlation data) plt_dat_cor <- matrix(   sapply(seq(-1, 0, length.out = 10), function(x) {     seq(x, x + 1, length.out = 10)   }),   nrow = 10 )  plt1 <- ggcorrhm(plt_dat_cor, cor_in = TRUE, bins = 5) plt2 <- ggcorrhm(plt_dat_cor, cor_in = TRUE, bins = 5L)  plt1 + plt2 plt1 <- ggcorrhm(plt_dat_cor, cor_in = TRUE)  plt2 <- ggcorrhm(plt_dat_cor, cor_in = TRUE,                  layout = c(\"tr\", \"bl\"),                  mode = c(\"hm\", \"hm\"),                  col_scale = list(                    scale_fill_gradient2(                      # Mimic the default correlation scale                      high = \"sienna2\", mid = \"white\", low = \"skyblue2\",                      # If not binned this only changes the legend but not the colours                      breaks = seq(-1, 1, length.out = 11)                    ),                    # Binned scales can be made with e.g.                    # scale_fill_fermenter, scale_fill_viridis_b, scale_fill_steps etc                    scale_fill_steps2(                      high = \"sienna2\", mid = \"white\", low = \"skyblue2\",                      # Specify exact break points for bins                      breaks = c(-1, -0.75, -0.25, 0, 0.25, 0.75, 1)                    )                  ))  plt1 + plt2"},{"path":"https://leod123.github.io/ggcorrheatmap/articles/legends.html","id":"legend-order","dir":"Articles","previous_headings":"","what":"Legend order","title":"Scales and legends","text":"Legends set default order: Main heatmap colours. Main heatmap sizes. Row annotations order. Column annotations order.  layout mixed, legends first triangle appear second triangle.  order can changed using legend_order argument. argument takes numeric vector, first element specifying order first legend (default order), second element second legend . value NA, legend hidden.  single NA value hides legends.  Scales can specified ggplot2 scale objects. case user complete control scale unaffected arguments like legend_order col_name.","code":"row_annot <- data.frame(.names = rownames(mtcars)[1:10], 1:10) colnames(row_annot)[2] <- \"3\"  col_annot <- data.frame(.names = colnames(mtcars), 11:1) colnames(col_annot)[2] <- \"4\"  gghm(scale(mtcars)[1:10, ], mode = 23,      col_name = \"1\", size_name = \"2\",      annot_rows_df = row_annot,      annot_cols_df = col_annot) +   # Make the legends horizontal to fit better   theme(legend.direction = \"horizontal\") gghm(cor(mtcars), layout = c(\"tr\", \"bl\"), mode = c(\"15\", \"hm\")) +   theme(legend.direction = \"horizontal\") set.seed(123) annot_rows <- data.frame(.names = colnames(mtcars), 1:11, 11:1) colnames(annot_rows)[2:3] <- c(\"4\", \"5\") annot_cols <- data.frame(.names = colnames(mtcars),                          sample(letters[1:3], 11, TRUE),                          sample(LETTERS[1:2], 11, TRUE)) colnames(annot_cols)[2:3] <- c(\"6\", \"7\")  plt1 <- gghm(cor(mtcars), layout = c(\"tl\", \"br\"), mode = c(19, 21),              col_name = c(\"1\", \"3\"), size_name = c(\"2\"),              annot_rows_df = annot_rows,              annot_cols_df = annot_cols)  plt2 <- gghm(cor(mtcars), layout = c(\"tl\", \"br\"), mode = c(19, 21),              col_name = c(\"1\", \"3\"), size_name = c(\"2\"),              annot_rows_df = annot_rows,              annot_cols_df = annot_cols,              legend_order = c(4, 2, NA, 1, 5, NA, 3))  plt1 / plt2 &   theme(legend.direction = \"horizontal\") gghm(cor(mtcars), layout = c(\"tl\", \"br\"), mode = c(19, 21),      col_name = c(\"1\", \"3\"), size_name = c(\"2\"),      annot_rows_df = annot_rows,      annot_cols_df = annot_cols,      legend_order = NA) gghm(cor(mtcars), layout = c(\"tl\", \"br\"), mode = c(19, 21),      col_name = c(\"1\", \"3\"), size_name = \"2\",      col_scale = list(        # Keep default scale for first triangle        NULL,        # Pass a scale object for second triangle        scale_fill_viridis_c(name = \"scale object 1\", option = \"G\",                             guide = guide_colourbar(order = 1))      ),      annot_rows_df = annot_rows,      annot_cols_df = annot_cols,      annot_rows_col = list(        # Scale object for second row annotation        \"5\" = scale_fill_distiller(name = \"scale object 2\",                                   palette = \"Purples\")      ),      annot_cols_col = list(        # Scale object for first column annotation        \"6\" = scale_fill_brewer(name = \"scale object 3\",                                palette = \"RdBu\",                                # Hide the legend                                guide = \"none\")      ),      # (Try to) Remove all legends      legend_order = NA) +   theme(legend.direction = \"horizontal\")"},{"path":"https://leod123.github.io/ggcorrheatmap/articles/legends.html","id":"legends-in-correlation-heatmaps","dir":"Articles","previous_headings":"","what":"Legends in correlation heatmaps","title":"Scales and legends","text":"ggcorrhm() tries hide legends default using mixed layouts reduce clutter. example, triangles use colour scale, one scales hidden. happens default scale used (customised high, mid, etc ok) col_scale character. col_scale contains ggplot2 scale objects legends shown (unless specified scale object). Default size legends also hidden use absolute value transformation show different information colour scale.  legends can included using legend_order argument using scale objects scales.","code":"# If both triangles use the same colour scale # (when col_scale is NULL or a one character value) ggcorrhm(mtcars, layout = c(\"tl\", \"br\"),          mode = c(\"hm\", \"18\"), col_scale = \"RdYlBu\") ggcorrhm(mtcars, layout = c(\"tl\", \"br\"),          mode = c(\"hm\", \"18\"), col_scale = \"RdYlBu\",          # Elements beyond the number of legends are ignored          # On a related note, if legend_order is shorter than          # the number of legends, legends not in the vector are hidden          legend_order = 1:10)"},{"path":"https://leod123.github.io/ggcorrheatmap/articles/legends.html","id":"arranging-legends","dir":"Articles","previous_headings":"","what":"Arranging legends","title":"Scales and legends","text":"many legends, may cut can tricky make fit. One way change positions, sizes orientations legends shown plots . Another way change size figure legends fit. advanced way use packages like cowplot patchwork stitch together legendless version plot legends, also makes possible arrange legends grids.","code":"# Plot with legends p <- ggcorrhm(mtcars, cluster_rows = TRUE, cluster_cols = TRUE,               annot_rows_df = data.frame(.names = colnames(mtcars),                                          a = 1:11, b = 11:1),               annot_cols_df = data.frame(.names = colnames(mtcars),                                          c = 1:11))  # Plot without legends pl <- ggcorrhm(mtcars, cluster_rows = TRUE, cluster_cols = TRUE,                annot_rows_df = data.frame(.names = colnames(mtcars),                                           a = 1:11, b = 11:1),                annot_cols_df = data.frame(.names = colnames(mtcars),                                           c = 1:11),                legend_order = NA)  # Show plot with default legends p # Extract the four legends lgd <- get_legend(p)[[\"grobs\"]][1:4]  # Arrange in a grid (cowplot) lgd_grid <- plot_grid(plotlist = lgd, nrow = 2, ncol = 2)  # Combine legend-less plot and legends with cowplot plot_grid(pl, lgd_grid, rel_widths = c(3, 1)) # Code for the same layout as above # # Arrange in a grid (patchwork) # lgd_grid <- wrap_plots(lgd) #  # # Combine with patchwork # wrap_plots(pl, lgd_grid, widths = c(3, 1))  # Try a different layout with patchwork. Turn the legends horizontal lgd <- get_legend(p + theme(legend.direction = \"horizontal\",                             legend.title = element_text(vjust = 0.8)))[[\"grobs\"]][1:4]  # Append the plot to the legend list to give to patchwork::wrap_plots wrap_plots(append(list(pl), lgd),            design = \"            ##BBB##            AAAAAAA            AAAAAAA            AAAAAAA            AAAAAAA            CCDDEEE            \")"},{"path":"https://leod123.github.io/ggcorrheatmap/articles/mixed.html","id":"basics","dir":"Articles","previous_headings":"","what":"Basics","title":"Mixed layouts","text":"matrix plotted symmetric possible plot mixed layouts giving two triangles (opposite ) layout argument. Two modes must provided, default modes heatmap first triangle text second. first triangle layout gets diagonal (include_diag TRUE).  add grid shape modes use ggplot2::theme panel.grid* arguments. part heatmap uses ‘text’ ‘none’ modes, grid visible cells. cell_bg_col cell_bg_alpha arguments control cell background colour alpha parameter. default, cell colour set white alpha 0.  Since mixed layouts consist two triangular layout heatmaps, clustering can applied rows columns clustered (like simple triangular layouts).  return_data TRUE extra column called layout, showing triangle cell belongs .","code":"plt1 <- ggcorrhm(mtcars, layout = c(\"tl\", \"br\")) plt2 <- ggcorrhm(mtcars, layout = c(\"tl\", \"br\"), mode = c(\"21\", \"23\"))  plt1 + plt2 # Grid + default cell background plt1 <- ggcorrhm(mtcars, layout = c(\"tl\", \"br\"), mode = c(\"21\", \"text\")) +   labs(title = \"cell_bg_alpha = 0\") +   # Add grid, make darker for demonstration   theme(panel.grid.major = element_line(colour = \"grey\"))  plt2 <- ggcorrhm(mtcars, layout = c(\"tl\", \"br\"), mode = c(\"21\", \"text\"),                  cell_bg_alpha = 1) +   labs(title = \"cell_bg_alpha = 1\") +   theme(panel.grid.major = element_line(colour = \"grey\"))  plt1 + plt2 ggcorrhm(mtcars, layout = c(\"tr\", \"bl\"), cluster_rows = TRUE) #> Warning: Cannot cluster only one dimension for triangular layouts, clustering both rows #> and columns instead. head(ggcorrhm(mtcars, layout = c(\"tl\", \"br\"), return_data = TRUE)$plot_data) #>    row col      value layout #> 1  mpg mpg  1.0000000     tl #> 2  cyl mpg -0.8521620     tl #> 3 disp mpg -0.8475514     tl #> 4   hp mpg -0.7761684     tl #> 5 drat mpg  0.6811719     tl #> 6   wt mpg -0.8676594     tl"},{"path":"https://leod123.github.io/ggcorrheatmap/articles/mixed.html","id":"parameter-behaviour","dir":"Articles","previous_headings":"","what":"Parameter behaviour","title":"Mixed layouts","text":"layout mixed, arguments can take vectors lists length two. vector, element applied whole corresponding triangle layout. list provided, elements can whatever values applicable non-mixed layouts, .e. single value apply whole triangle, vector one value cell. arguments work like border_col, border_lwd, border_lty, cell_labels, cell_label_col, cell_label_size, cell_label_digits, cell_bg_col, cell_bg_alpha, (ggcorrhm) p_values cell_label_p.  mentioned , p-values can added one half heatmap desired. P-values correlation matrices mixed layouts explored correlation matrix article.","code":"colr <- c(\"#70369D\", \"#59369D\", \"#4A44AB\", \"#486ED8\", \"#5B9892\", \"#79C314\", \"#C6DB28\", \"#FBDD2B\", \"#FEB30A\", \"#F56B08\", \"#E81416\")  ggcorrhm(mtcars, layout = c(\"bl\", \"tr\"), mode = c(\"none\", \"hm\"),          # One value for the whole heatmap (border linewidth)          border_lwd = 1.5,          # Length two vector, each value being used for the whole corresponding triangle          border_lty = c(1, 3),          # A list with values for each triangle          border_col = list(            # The first triangle is 66 values (if the diagonal is drawn), second 55            # If not known, can return the plotting data to see how many cells are in each triangle            # Since the matrix must be symmetric the numbers can also be calculated            # Total: ncol*ncol, triangle without diagonal: (total - ncol) / 2, with diagonal: without + ncol            # First triangle, provide all values, moving down each column from the left            rev(unlist(sapply(seq_along(colr), function(i) rep(colr[i], i)))),            # Second triangle, recycle one value            \"white\"          ),          # Also draw cell labels on the first triangle and set the same colours as the cells          cell_labels = c(TRUE, FALSE),          cell_label_col = list(            # Provide the same values as for the cell border colours, but minus one as the diagonal            # names are written instead of cell labels and are controlled differently            rev(unlist(sapply(seq_along(colr), function(i) rep(colr[i], i - 1)))),            1 # Anything as there are no labels          ),          names_diag_param = list(colour = rev(colr))) plt1 <- ggcorrhm(mtcars, layout = c(\"tl\", \"br\"), p_values = TRUE,                  cell_label_size = c(4, 2)) plt2 <- ggcorrhm(mtcars, layout = c(\"tl\", \"br\"), p_values = c(FALSE, TRUE),                  cell_label_size = 2)  plt1 + plt2"},{"path":"https://leod123.github.io/ggcorrheatmap/articles/mixed.html","id":"mixed-scales","dir":"Articles","previous_headings":"","what":"Mixed scales","title":"Mixed layouts","text":"mixed layouts two triangles can use different scales colours sizes using col_scale argument.   Use guide argument ggplot2 scale functions set order hide legends scale object passed col_scale argument.  one scales NULL, default scale used instead (can customised high, mid, low etc arguments).","code":"ggcorrhm(mtcars, layout = c(\"tr\", \"bl\"),          col_scale = c(\"G\", \"H\")) # Two fill scales ggcorrhm(mtcars, layout = c(\"br\", \"tl\"), mode = c(\"21\", \"hm\"),          show_names_diag = FALSE,          col_scale = list(            # When a scale object is passed, arguments of gghm/ggcorrhm            # that modify legends will be ignored            scale_fill_gradient2(high = \"pink\", mid = \"white\", low = \"lightblue\",                                 limits = c(-1, 1), name = \"Bottom right\"),            \"RdYlGn\"          ),          # col_name can also take two values          col_name = c(\"This name will be ignored\", \"Top left\")) # Two colour scales ggcorrhm(mtcars, layout = c(\"tr\", \"bl\"), mode = c(\"19\", \"text\"),          col_scale = list(            scale_colour_gradient(high = \"lightsalmon4\", low = \"white\", limits = c(-1, 1),                                  # Can use the guide argument to change order of legends (or hide them)                                  guide = guide_colourbar(order = 1),                                  name = \"First legend\"),            scale_colour_distiller(palette = \"Spectral\", limits = c(-1, 1),                                   name = \"Second legend\")          ), cell_label_size = 4,          col_name = c(\"Names that will\", \"be ignored\")) # NULL uses the default that changes with high, mid, low etc ggcorrhm(mtcars, layout = c(\"tl\", \"br\"), mode = c(\"hm\", \"hm\"),          col_scale = list(            NULL,            # Give a scale object to not be affected by the default scale arguments            scale_fill_distiller(palette = \"PRGn\", limits = c(-1, 1))          ), bins = 5L, high = \"pink\", mid = \"beige\", low = \"lightblue\")"},{"path":"https://leod123.github.io/ggcorrheatmap/articles/mixed.html","id":"some-extra-plots","dir":"Articles","previous_headings":"","what":"Some extra plots","title":"Mixed layouts","text":"using triangular layouts, annotations dendrograms moved non-empty sides heatmap convenience. Using mixed layouts mode “none” possible “hack” annotations dendrograms onto empty sides triangular layouts.  Finally, default full layout reverses y axis levels rows order input diagonal runs top left bottom right. opposite layout desired can made using mixed layout top left bottom right triangle, like plot .","code":"annot <- data.frame(.names = colnames(mtcars), a = 1:11) ggcorrhm(mtcars, layout = c(\"tl\", \"br\"), mode = c(\"hm\", \"none\"),          annot_rows_df = annot, annot_cols_df = annot,          cluster_rows = TRUE, cluster_cols = TRUE,          # Hide cell borders only in the 'none' triangle          border_lwd = c(0.1, 0)) plt1 <- ggcorrhm(mtcars, layout = \"f\") plt2 <- ggcorrhm(mtcars, layout = c(\"tl\", \"br\"), mode = c(\"hm\", \"hm\"))  plt1 + plt2"},{"path":"https://leod123.github.io/ggcorrheatmap/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Leo Dahl. Author, maintainer, copyright holder.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Dahl L (2025). ggcorrheatmap: Flexible 'ggplot' Correlation Heatmaps. R package version 0.0.0.9000, https://github.com/leod123/ggcorrheatmap.","code":"@Manual{,   title = {ggcorrheatmap: Flexible 'ggplot' Correlation Heatmaps},   author = {Leo Dahl},   year = {2025},   note = {R package version 0.0.0.9000},   url = {https://github.com/leod123/ggcorrheatmap}, }"},{"path":"https://leod123.github.io/ggcorrheatmap/index.html","id":"ggcorrheatmap","dir":"","previous_headings":"","what":"Flexible ggplot Correlation Heatmaps","title":"Flexible ggplot Correlation Heatmaps","text":"ggcorrheatmap convenient package generating correlation heatmaps made ggplot2, support triangular layouts, clustering annotation. output ggplot2 object can customise appearance using familiar ggplot2 functions. Besides correlation heatmaps, also support making general heatmaps.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Flexible ggplot Correlation Heatmaps","text":"can install development version ggcorrheatmap GitHub :","code":"# install.packages(\"devtools\") devtools::install_github(\"leod123/ggcorrheatmap\")"},{"path":"https://leod123.github.io/ggcorrheatmap/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"Flexible ggplot Correlation Heatmaps","text":"example generate correlation heatmap clustered rows columns row annotation, using triangular layout excludes redundant cells.  mixed layout displays different things different triangles.  also possible make normal heatmap, flexible output.","code":"library(ggcorrheatmap)  set.seed(123) # Make a correlation heatmap with a triangular layout, annotations and clustering row_annot <- data.frame(.names = colnames(mtcars),                         annot1 = sample(letters[1:3], ncol(mtcars), TRUE),                         annot2 = rnorm(ncol(mtcars))) ggcorrhm(mtcars, layout = \"bottomright\",          cluster_rows = TRUE, cluster_cols = TRUE,          show_dend_rows = FALSE, annot_rows_df = row_annot) # With correlation values and p-values ggcorrhm(mtcars, layout = c(\"topright\", \"bottomleft\"),          cell_labels = c(FALSE, TRUE), p_values = c(FALSE, TRUE)) gghm(scale(mtcars), cluster_rows = TRUE, cluster_cols = TRUE)"},{"path":"https://leod123.github.io/ggcorrheatmap/reference/add_annotation.html","id":null,"dir":"Reference","previous_headings":"","what":"Add annotations to ggplot heatmap — add_annotation","title":"Add annotations to ggplot heatmap — add_annotation","text":"Add annotations ggplot heatmap","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/add_annotation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add annotations to ggplot heatmap — add_annotation","text":"","code":"add_annotation(   plt,   context = c(\"rows\", \"cols\"),   annot_df,   annot_pos,   annot_size,   annot_border_lwd = 0.5,   annot_border_col = \"grey\",   annot_border_lty = 1,   show_annot_names = T,   na_remove = F,   col_scale = NULL,   names_side,   name_params = NULL )"},{"path":"https://leod123.github.io/ggcorrheatmap/reference/add_annotation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add annotations to ggplot heatmap — add_annotation","text":"plt ggplot object geom_tile layer add annotations . context Dimension add annotations , either \"rows\" \"columns\". annot_df Data frame containing annotations. first column must contain labels used heatmap rows columns. columns contain corresponding annotations. column names used labels legend. annot_pos Positions annotations. x positions row annotations, y positions column annotations. Positions given middle coordinate annotation cells. annot_size Size annotations, width row annotations, height column annotations. annot_border_lwd Linewidth border lines annotation cells. annot_border_col Colour border lines annotation cells. annot_border_lty Linetype border lines annotation cells. show_annot_names Logical indicating annotation names drawn. na_remove Logical indicating NA values removed. col_scale Named list fill scales use, named columns annotation data frame. element either scale_fill_* object string specifying brewer palette viridis option. names_side String specifying side labels drawn . \"top\" \"bottom\" row annotation, \"left\" \"right\" column annotation. name_params named list parameters give grid::textGrob modify annotation label appearance.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/add_annotation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add annotations to ggplot heatmap — add_annotation","text":"ggplot object added annotations.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/add_dendrogram.html","id":null,"dir":"Reference","previous_headings":"","what":"Add dendrogram to ggplot object. — add_dendrogram","title":"Add dendrogram to ggplot object. — add_dendrogram","text":"Add dendrogram ggplot object.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/add_dendrogram.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add dendrogram to ggplot object. — add_dendrogram","text":"","code":"add_dendrogram(plt, dendro, dend_col = \"black\", dend_lwd = 0.3, dend_lty = 1)"},{"path":"https://leod123.github.io/ggcorrheatmap/reference/add_dendrogram.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add dendrogram to ggplot object. — add_dendrogram","text":"plt ggplot object add dendrogram . dendro Dendrogram segment node data obtained prepare_dendrogram function. dend_col String specifying colour dendrogram (used colours changed using options). dend_lwd Line width dendrogram segments (used changed using options). dend_lty Line type dendrogram (used changed using options).","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/add_dendrogram.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add dendrogram to ggplot object. — add_dendrogram","text":"ggplot object dendrogram added.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/add_diag_names.html","id":null,"dir":"Reference","previous_headings":"","what":"Add diagonal names to heatmap. — add_diag_names","title":"Add diagonal names to heatmap. — add_diag_names","text":"Add diagonal names heatmap.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/add_diag_names.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add diagonal names to heatmap. — add_diag_names","text":"","code":"add_diag_names(plt, x_long, names_diag_params = NULL)"},{"path":"https://leod123.github.io/ggcorrheatmap/reference/add_diag_names.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add diagonal names to heatmap. — add_diag_names","text":"plt Plot object add names . x_long Long format plotting data. names_diag_params Parameters diagonal names.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/add_diag_names.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add diagonal names to heatmap. — add_diag_names","text":"Plot labels added.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/apply_dendextend.html","id":null,"dir":"Reference","previous_headings":"","what":"Successively apply dendextend functions to a dendrogram. — apply_dendextend","title":"Successively apply dendextend functions to a dendrogram. — apply_dendextend","text":"Successively apply dendextend functions dendrogram.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/apply_dendextend.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Successively apply dendextend functions to a dendrogram. — apply_dendextend","text":"","code":"apply_dendextend(dend_list, dendro)"},{"path":"https://leod123.github.io/ggcorrheatmap/reference/apply_dendextend.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Successively apply dendextend functions to a dendrogram. — apply_dendextend","text":"dend_list List specifying dendextend functions apply. usage see details gghm. dendro Dendrogram object obtained stats::.dendrogram.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/apply_dendextend.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Successively apply dendextend functions to a dendrogram. — apply_dendextend","text":"dendrogram object modified dendextend functions.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/check_annot_df.html","id":null,"dir":"Reference","previous_headings":"","what":"Check names of annotation — check_annot_df","title":"Check names of annotation — check_annot_df","text":"Check names annotation","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/check_annot_df.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check names of annotation — check_annot_df","text":"","code":"check_annot_df(annot_df, names_in, context)"},{"path":"https://leod123.github.io/ggcorrheatmap/reference/check_annot_df.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check names of annotation — check_annot_df","text":"annot_df Annotation data frame (annot_rows_df, annot_cols_df). names_in Names exist data (rownames, colnames).","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/check_annot_df.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check names of annotation — check_annot_df","text":"Annotation data frame (rownames moved column named '.names' necessary).","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/check_dendrogram_pos.html","id":null,"dir":"Reference","previous_headings":"","what":"Check that dendrograms are positioned correctly — check_dendrogram_pos","title":"Check that dendrograms are positioned correctly — check_dendrogram_pos","text":"Check dendrograms positioned correctly","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/check_dendrogram_pos.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check that dendrograms are positioned correctly — check_dendrogram_pos","text":"","code":"check_dendrogram_pos(dat, context = c(\"row\", \"col\"), dendro)"},{"path":"https://leod123.github.io/ggcorrheatmap/reference/check_dendrogram_pos.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check that dendrograms are positioned correctly — check_dendrogram_pos","text":"dat Long format data plotting. context Dimension dendrogram added. used directly get columns long data thus need \"row\" \"col\". dendro dendrogram segments nodes list.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/check_dendrogram_pos.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check that dendrograms are positioned correctly — check_dendrogram_pos","text":"dendro returned positions correct. Otherwise error.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/check_layout.html","id":null,"dir":"Reference","previous_headings":"","what":"Check that layout and mode are correct — check_layout","title":"Check that layout and mode are correct — check_layout","text":"Check layout mode correct","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/check_layout.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check that layout and mode are correct — check_layout","text":"","code":"check_layout(layout, mode)"},{"path":"https://leod123.github.io/ggcorrheatmap/reference/check_layout.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check that layout and mode are correct — check_layout","text":"layout Plot layout. mode Plot mode.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/check_layout.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check that layout and mode are correct — check_layout","text":"Error incorrect layout mode, otherwise nothing.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/check_logical.html","id":null,"dir":"Reference","previous_headings":"","what":"Check (supposed) logical values. — check_logical","title":"Check (supposed) logical values. — check_logical","text":"Check (supposed) logical values.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/check_logical.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check (supposed) logical values. — check_logical","text":"","code":"check_logical(..., list_allowed = F, call = NULL)"},{"path":"https://leod123.github.io/ggcorrheatmap/reference/check_logical.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check (supposed) logical values. — check_logical","text":"... single named argument, name variable name displayed error message. value (supposed) logical. call Call use call error message (used rlang::abort). Default rlang::caller_env() resulting function called check_logical().","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/check_logical.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check (supposed) logical values. — check_logical","text":"Error logical longer 1, otherwise nothing.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/check_numeric.html","id":null,"dir":"Reference","previous_headings":"","what":"Check input numeric arguments for class and length. — check_numeric","title":"Check input numeric arguments for class and length. — check_numeric","text":"Check input numeric arguments class length.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/check_numeric.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check input numeric arguments for class and length. — check_numeric","text":"","code":"check_numeric(..., allow_null = F, allowed_lengths = 1, call = NULL)"},{"path":"https://leod123.github.io/ggcorrheatmap/reference/check_numeric.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check input numeric arguments for class and length. — check_numeric","text":"... single named argument, name variable name displayed error message. value (supposed) logical. allow_null Logical indicating NULL allowed input argument. allowed_lengths allowed lengths argument. call Call use call error message (used rlang::abort). Default rlang::caller_env() resulting function called check_logical().","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/check_numeric.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check input numeric arguments for class and length. — check_numeric","text":"Error numeric, NULL allowed, long/short.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/cluster_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Cluster data using hierarchical clustering or use provided clustering. — cluster_data","title":"Cluster data using hierarchical clustering or use provided clustering. — cluster_data","text":"Cluster data using hierarchical clustering use provided clustering.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/cluster_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cluster data using hierarchical clustering or use provided clustering. — cluster_data","text":"","code":"cluster_data(   cluster_input,   mat,   cluster_distance,   cluster_method,   dend_options = NULL )"},{"path":"https://leod123.github.io/ggcorrheatmap/reference/cluster_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cluster data using hierarchical clustering or use provided clustering. — cluster_data","text":"cluster_input Either logical indicating data clustered, hclust dendrogram object. mat Matrix cluster. cluster_distance Distance metric clustering. cluster_method Clustering method hclust. dend_options List functional sequence specifying dendextend functions use.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/cluster_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cluster data using hierarchical clustering or use provided clustering. — cluster_data","text":"List containing dendrogram clustering objects.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/default_scale.html","id":null,"dir":"Reference","previous_headings":"","what":"Get default scale for non-correlation heatmaps. — default_scale","title":"Get default scale for non-correlation heatmaps. — default_scale","text":"Get default scale non-correlation heatmaps.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/default_scale.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get default scale for non-correlation heatmaps. — default_scale","text":"","code":"default_scale(   val_type,   aes_type,   leg_order = 1,   title = ggplot2::waiver(),   na_col = \"grey50\",   bins = NULL,   limits = NULL )"},{"path":"https://leod123.github.io/ggcorrheatmap/reference/default_scale.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get default scale for non-correlation heatmaps. — default_scale","text":"val_type Value type ('continuous' 'discrete'). aes_type Aesthetic type ('fill', 'col' 'size). leg_order Order legend. title Legend title.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/default_scale.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get default scale for non-correlation heatmaps. — default_scale","text":"ggplot2 scale non-correlation heatmaps.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/default_scale_corr.html","id":null,"dir":"Reference","previous_headings":"","what":"Get a default scale for correlation heatmaps. — default_scale_corr","title":"Get a default scale for correlation heatmaps. — default_scale_corr","text":"Get default scale correlation heatmaps.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/default_scale_corr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get a default scale for correlation heatmaps. — default_scale_corr","text":"","code":"default_scale_corr(   aes_type,   bins = NULL,   limits = c(-1, 1),   size_range = NULL,   high = \"sienna2\",   mid = \"white\",   low = \"skyblue2\",   midpoint = 0,   na_col = \"grey50\",   leg_order = 1,   title = ggplot2::waiver() )"},{"path":"https://leod123.github.io/ggcorrheatmap/reference/default_scale_corr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get a default scale for correlation heatmaps. — default_scale_corr","text":"aes_type Type aesthetic ('fill', 'col', 'size'). bins Number bins (fill colour scales). limits Scale limits (fill colour). size_range Range sizes (size). high Colours higher end fill colour scale. mid Colours middle point fill colour scale. low Colours lower end fill colour scale. midpoint Middle point colour scale. na_col Colour NAs. leg_order Order legend. title Title legend.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/default_scale_corr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get a default scale for correlation heatmaps. — default_scale_corr","text":"ggplot2 scale correlation heatmap.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/extract_scales.html","id":null,"dir":"Reference","previous_headings":"","what":"Pick out relevant scales and format for mixed layout. — extract_scales","title":"Pick out relevant scales and format for mixed layout. — extract_scales","text":"Pick relevant scales format mixed layout.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/extract_scales.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pick out relevant scales and format for mixed layout. — extract_scales","text":"","code":"extract_scales(main_scales, scale_order, aes_type, layout)"},{"path":"https://leod123.github.io/ggcorrheatmap/reference/extract_scales.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pick out relevant scales and format for mixed layout. — extract_scales","text":"main_scales Scales main plot obtained prepare_scales. scale_order List order scales obtained make_legend_order. aes_type Aesthetic pick scales. layout Layout heatmap.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/extract_scales.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pick out relevant scales and format for mixed layout. — extract_scales","text":"List scales use.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/get_annotation_pos.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate positions of annotations for heatmap. — get_annotation_pos","title":"Calculate positions of annotations for heatmap. — get_annotation_pos","text":"Calculate positions annotations heatmap.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/get_annotation_pos.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate positions of annotations for heatmap. — get_annotation_pos","text":"","code":"get_annotation_pos(   annot_side = T,   annot_names,   annot_size,   annot_dist,   annot_gap,   data_size )"},{"path":"https://leod123.github.io/ggcorrheatmap/reference/get_annotation_pos.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate positions of annotations for heatmap. — get_annotation_pos","text":"annot_side Logical specifying annotation position. TRUE left heatmap row annotation, bottom heatmap column annotation annot_names Names annotations. annot_size Size annotation cells 1 size heatmap cell. annot_dist Distance heatmap first annotation. annot_gap Size gap annotations. data_size Number rows columns main heatmap (symmetric). Used get starting position annotations.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/get_annotation_pos.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate positions of annotations for heatmap. — get_annotation_pos","text":"Numeric vector annotation cell positions","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/get_colour_scale.html","id":null,"dir":"Reference","previous_headings":"","what":"Get a Brewer or Viridis colour scale. — get_colour_scale","title":"Get a Brewer or Viridis colour scale. — get_colour_scale","text":"Get Brewer Viridis colour scale.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/get_colour_scale.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get a Brewer or Viridis colour scale. — get_colour_scale","text":"","code":"get_colour_scale(   name,   val_type,   aes_type,   limits = NULL,   bins = NULL,   leg_order = 1,   title = ggplot2::waiver(),   na_col = \"grey50\" )"},{"path":"https://leod123.github.io/ggcorrheatmap/reference/get_colour_scale.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get a Brewer or Viridis colour scale. — get_colour_scale","text":"name Scale palette/option name. val_type Value type ('continuous' 'discrete'). aes_type Aesthetic type ('fill' 'col'). limits Limits scale. bins Number bins binned scale. leg_order Order legend. title Legend title.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/get_colour_scale.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get a Brewer or Viridis colour scale. — get_colour_scale","text":"ggplot2 scale using Brewer Viridis.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/get_default_annot_scale.html","id":null,"dir":"Reference","previous_headings":"","what":"Colour scale dispenser. — get_default_annot_scale","title":"Colour scale dispenser. — get_default_annot_scale","text":"Colour scale dispenser.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/get_default_annot_scale.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Colour scale dispenser. — get_default_annot_scale","text":"","code":"get_default_annot_scale(num, type)"},{"path":"https://leod123.github.io/ggcorrheatmap/reference/get_default_annot_scale.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Colour scale dispenser. — get_default_annot_scale","text":"num Integer 1 8. type String specifying data type (discrete continuous).","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/get_default_annot_scale.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Colour scale dispenser. — get_default_annot_scale","text":"Brewer Viridis ggplot2 scale name.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/ggcorrheatmap-package.html","id":null,"dir":"Reference","previous_headings":"","what":"ggcorrheatmap: Flexible 'ggplot' Correlation Heatmaps — ggcorrheatmap-package","title":"ggcorrheatmap: Flexible 'ggplot' Correlation Heatmaps — ggcorrheatmap-package","text":"Create flexible 'ggplot2' heatmaps correlation heatmaps clustering annotation.","code":""},{"path":[]},{"path":"https://leod123.github.io/ggcorrheatmap/reference/ggcorrheatmap-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"ggcorrheatmap: Flexible 'ggplot' Correlation Heatmaps — ggcorrheatmap-package","text":"Maintainer: Leo Dahl leokosdah@gmail.com [copyright holder]","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/ggcorrhm.html","id":null,"dir":"Reference","previous_headings":"","what":"Make a correlation heatmap with ggplot2. — ggcorrhm","title":"Make a correlation heatmap with ggplot2. — ggcorrhm","text":"Make correlation heatmap input matrices. Uses diverging colour scale centered around 0.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/ggcorrhm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Make a correlation heatmap with ggplot2. — ggcorrhm","text":"","code":"ggcorrhm(   x,   y = NULL,   cor_method = \"pearson\",   cor_use = \"everything\",   cor_in = FALSE,   high = \"sienna2\",   mid = \"white\",   low = \"skyblue2\",   midpoint = 0,   limits = c(-1, 1),   bins = NULL,   layout = \"full\",   mode = if (length(layout) == 1) \"heatmap\" else c(\"heatmap\", \"text\"),   include_diag = TRUE,   na_col = \"grey50\",   na_remove = FALSE,   return_data = FALSE,   col_scale = NULL,   col_name = NULL,   size_range = c(4, 10),   size_scale = NULL,   size_name = NULL,   legend_order = NULL,   p_values = FALSE,   p_adjust = \"none\",   p_thresholds = c(`***` = 0.001, `**` = 0.01, `*` = 0.05, 1),   cell_labels = FALSE,   cell_label_p = FALSE,   cell_label_col = \"black\",   cell_label_size = 3,   cell_label_digits = 2,   cell_bg_col = \"white\",   cell_bg_alpha = 0,   border_col = \"grey\",   border_lwd = 0.1,   border_lty = 1,   show_names_diag = TRUE,   names_diag_params = NULL,   show_names_x = FALSE,   names_x_side = \"top\",   show_names_y = FALSE,   names_y_side = \"left\",   annot_rows_df = NULL,   annot_cols_df = NULL,   annot_rows_col = NULL,   annot_cols_col = NULL,   annot_rows_side = \"right\",   annot_cols_side = \"bottom\",   annot_dist = 0.2,   annot_gap = 0,   annot_size = 0.5,   annot_border_col = if (length(border_col) == 1) border_col else \"grey\",   annot_border_lwd = if (length(border_lwd) == 1) border_lwd else 0.5,   annot_border_lty = if (length(border_lty) == 1) border_lty else 1,   annot_na_col = na_col,   annot_na_remove = na_remove,   annot_rows_params = NULL,   annot_cols_params = NULL,   show_annot_names = TRUE,   annot_names_size = 9,   annot_rows_names_side = \"bottom\",   annot_cols_names_side = \"left\",   annot_rows_name_params = NULL,   annot_cols_name_params = NULL,   cluster_rows = FALSE,   cluster_cols = FALSE,   cluster_distance = \"euclidean\",   cluster_method = \"complete\",   show_dend_rows = TRUE,   show_dend_cols = TRUE,   dend_rows_side = \"right\",   dend_cols_side = \"bottom\",   dend_col = \"black\",   dend_dist = 0,   dend_height = 0.3,   dend_lwd = 0.3,   dend_lty = 1,   dend_rows_params = NULL,   dend_cols_params = NULL,   dend_rows_extend = NULL,   dend_cols_extend = NULL )"},{"path":"https://leod123.github.io/ggcorrheatmap/reference/ggcorrhm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Make a correlation heatmap with ggplot2. — ggcorrhm","text":"x Matrix data frame wide format containing columns correlate columns y. y Optional matrix data frame wide format containing columns correlate columns x. cor_method String specifying correlation method use stats::cor() function. Default 'pearson'. cor_use String specifying use argument stats::cor(), defines deal missing values. Default 'everything'. cor_in Logical indicating input data contains correlation values correlation computations (including p-values) skipped. Default FALSE. high Colour use highest value colour scale. mid Colour use 0 colour scale. low Colour use lowest value colour scale. midpoint Value middle point colour scale. limits Numeric vector length two limits colour scale. NULL uses default. bins Number bins divide scale (continuous values). 'double' class value uses 'nice.breaks' put breaks nice numbers may result specified number bins. integer number bins prioritised. layout String specifying layout output heatmap. Possible layouts include 'topleft', 'topright', 'bottomleft', 'bottomright', 'whole'/'full' heatmap (default possible option matrix asymmetric). combination first letters word also works (.e. f, w, tl, tr, bl, br). layout length two two opposing triangles, mixed layout used. mixed layouts, mode needs vector length two (applied order layout). See details gghm() information. mode string specifying plotting mode. Possible values heatmap/hm normal heatmap, number 1 25 draw corresponding shape, text write cell values instead filling cells (colour scaling value), none blank cells. include_diag Logical indicating diagonal cells plotted (matrix symmetric). na_col Colour use cells NA (main heatmap annotation). na_remove Logical indicating NA values heatmap omitted (meaning cell border drawn). affect NAs handled correlation computations, use cor_use argument NA handling correlation. return_data Logical indicating data used plotting (.e. correlation values , computed, clustering p-values) returned. col_scale Scale use cell colours. NULL (default), divergent scale constructed high, mid, low, midpoint, limits, bins arguments. arguments ignored ggplot2::scale_* function provided instead. string, corresponding Brewer Viridis scale used. string scale name \"rev_\" beginning \"_rev\" end result reversed scale. mixed layouts, can also list length two containing two scales use. col_name String use correlation scale. NULL (default) text depend correlation method. Can two values mixed layouts dual scales. size_range Numeric vector length 2, specifying lower upper ranges shape sizes. Ignored size_scale NULL. size_scale ggplot2::scale_size_* call use size scaling mode number 1 25 (R pch). default behaviour (NULL) use continuous scale absolute values correlation. size_name String use size scale legend title. Can two values mixed layouts dual scales. legend_order Integer vector specifying order legends (first value first legend, second second, etc). default (NULL) shows size legends. NAs hide corresponding legends, single NA hides . Ignored ggplot2 scale objects col_scale size_scale. p_values Logical indicating p-values calculated. Use p_thresholds mark cells, /return_data get p-values output data. p_adjust String specifying adjustment method use p-values (default \"none\"). p_thresholds Named numeric vector specifying p-value thresholds (ascending order) mark. last element must 1 higher (set upper limit). Names must unique, one element can left unnamed (default 1 unnamed, meaning values threshold closest 1 1 marked plot). NULL, thresholding done p-value intervals marked symbols. cell_labels Logical specifying cells labelled correlation values. Alternatively, matrix data frame shape dimnames x containing values write cells. mode text, cell label colours scale correlation values cell_label_col ignored. cell_label_p Logical indicating , cell_labels TRUE, p-values written instead correlation values. cell_label_col Colour use cell labels, passed ggplot2::geom_text(). cell_label_size Size cell labels, used size argument ggplot2::geom_text(). cell_label_digits Number digits display cells labelled (numeric values). Default 2, passed base::round(). NULL rounding. cell_bg_col Colour use cell backgrounds modes 'text' 'none'. cell_bg_alpha Alpha cell colours modes 'text' 'none'. border_col Colour cell borders. mode number, border_col can set NA remove borders completely. border_lwd Size cell borders. mode number, border_col can set 0 remove borders. border_lty Line type cell borders. Either number corresponding name, string length 2, 4, 6, 8. See 'lty' graphics::par() details. supported numeric mode. show_names_diag Logical indicating names written diagonal cells (symmetric input). names_diag_params List named parameters (size, angle, etc) passed geom_text writing column names diagonal. show_names_x Logical indicating names written x axis. Labels can customised using ggplot2::theme() output plot. names_x_side String specifying position x axis names (\"top\" \"bottom\"). show_names_y Logical indicating names written y axis. names_y_side String specifying position y axis names (\"left\" \"right\"). annot_rows_df Data frame row annotations. names columns data must included, either row names column named .names. column specifies annotation column name used annotation name (legend next annotation). Numeric columns use continuous colour scale factor character columns use discrete scales. annot_cols_df usage annot_rows_df column annotation. annot_rows_col Named list row annotation colour scales. names specify annotation scale applies . Elements can strings ggplot2 \"Scale\" class objects. string, used brewer palette viridis option. scale object used , allowing flexibility. may change order legends drawn , specify order using guide argument ggplot2 scale function. annot_cols_col Named list used column annotation colour scales, used like annot_rows_col. annot_rows_side String specifying side row annotation drawn ('left' 'right', defaults 'left'). annot_cols_side String specifying side column annotation drawn ('bottom' 'top', defaults 'bottom'). annot_dist Distance heatmap first annotation cell 1 size one heatmap cell. Used row column annotation. annot_gap Distance annotation 1 size one heatmap cell. Used row column annotation. annot_size Size (width row annotation, height column annotation) annotation cells compared heatmap cell. Used row column annotation. annot_border_col Colour cell borders annotation. default border_col main heatmap length 1, otherwise uses default (grey). annot_border_lwd Line width cell borders annotation. default border_lwd main heatmap length 1, otherwise uses default (0.5). annot_border_lty Line type cell borders annotation. default border_lty main heatmap length 1, otherwise uses default (solid). annot_na_col Colour use NA values annotations. Annotation-specific colour can set ggplot2 scales annot_*_fill arguments. annot_na_remove Logical indicating NAs annotations removed (producing empty spaces). annot_rows_params Named list parameters row annotations overwrite defaults set annot_* arguments, name corresponding * part (see details gghm() information). annot_cols_params Named list parameters column annotations, used like annot_rows_params. show_annot_names Logical controlling names annotations shown drawing area. annot_names_size Size annotation names. annot_rows_names_side String specifying side row annotation names . Either \"top\" \"bottom\". annot_cols_names_side String specifying side column annotation names . Either \"left\" \"right\". annot_rows_name_params Named list parameters row annotation names. Given grid::textGrob, see ?grid::textGrob details. ?grid::gpar also helpful. annot_cols_name_params Named list parameters column annotation names. Given grid::textGrob, see ?grid::textGrob details. ?grid::gpar also helpful. cluster_rows Logical indicating rows clustered. Can also hclust dendrogram object. cluster_cols Logical indicating columns clustered. Can also hclust dendrogram object. cluster_distance String distance metric use clustering, given stats::dist(). cluster_method String clustering method use, given stats::hclust(). show_dend_rows Logical indicating dendrogram drawn rows. show_dend_cols Logical indicating dendrogram drawn columns. dend_rows_side side draw row dendrogram ('left' 'right', defaults 'left'). dend_cols_side side draw column dendrogram ('bottom' 'top', defaults 'bottom'). dend_col Colour use dendrogram lines, applied row column dendrograms. dend_dist Distance heatmap (annotation) leaves dendrogram, measured heatmap cells (1 size one cell). dend_height Number scale dendrogram height, applied row column dendrograms. dend_lwd Linewidth dendrogram lines, applied row column dendrograms. dend_lty Dendrogram line type, applied row column dendrograms. dend_rows_params Named list row dendrogram parameters. See details gghm() information. dend_cols_params Named list column dendrogram parameters. See details gghm() information. dend_rows_extend Named list functional sequence specifying dendextend functions apply row dendrogram. See details gghm() ggcorrhm() usage. dend_cols_extend Named list functional sequence specifying dendextend functions apply column dendrogram. See details gghm() ggcorrhm() usage.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/ggcorrhm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Make a correlation heatmap with ggplot2. — ggcorrhm","text":"correlation heatmap ggplot object. return_data TRUE output list containing plot (named 'plot'), correlations ('plot_data', factor columns 'row' 'col' column 'value' containing cell values), result clustering ('row_clustering' 'col_clustering', clustered). p-values calculated, two additional columns named 'p_val' 'p_adj' included 'plot_data', containing nominal adjusted p-values. layout mixed, extra factor column named 'layout' included, showing triangle cell belongs .","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/ggcorrhm.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Make a correlation heatmap with ggplot2. — ggcorrhm","text":"ggcorrhm() makes convenient make correlation heatmaps, taking input matrix data frame visualise correlations columns gghm() function. input values can either one matrix data frame columns correlate , two matrices data frames columns correlate matrices. rownames needed, two matrices provided number rows rows ordered meaningful way (.e. sample/individual/etc row ). Row column names displayed diagonal default correlation matrix symmetric (x provided x y identical). colour scale set diverging gradient around 0, options change low, mid, high colours, midpoint, limits. bins argument converts scale discrete scale divided bins equally distributed bins. size scale, used numeric cell shape specified, set vary shape size 4 10 (can changed size_range argument) transform values absolute values (positive negative correlations treated equally). behaviour can overwritten setting size_scale another ggplot2::scale_size_* function desired arguments, ggplot2::scale_size() special behaviour. absolute value transformation used legend sizes loses meaning (displaying positive values) therefore set shown legend_order NULL. symmetric correlation matrices, dendrogram customisation arguments dend_rows_extend dend_cols_extend work best functions change dendrogram cosmetically colours, linetypes node shapes. possible reorder (using e.g. 'rotate', 'ladderize') prune (using e.g. 'prune'), anything changes structure dendrogram may end looking strange symmetric matrices applied one dimension (e.g. diagonal may diagonal, triangular mixed layouts may work). applies cluster_rows cluster_cols arguments hclust dendrogram objects.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/ggcorrhm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Make a correlation heatmap with ggplot2. — ggcorrhm","text":"","code":"# Basic usage ggcorrhm(mtcars)   # With two matrices ggcorrhm(iris[1:32, -5], mtcars)   # Different layout ggcorrhm(mtcars, layout = \"br\")   # With clustering ggcorrhm(mtcars, layout = \"tl\", cluster_rows = TRUE, cluster_cols = TRUE)   # With annotation set.seed(123) annot <- data.frame(.names = colnames(mtcars),                     annot1 = rnorm(ncol(mtcars)),                     annot2 = sample(letters[1:3], ncol(mtcars), TRUE)) ggcorrhm(mtcars, layout = \"tr\", annot_cols_df = annot)   # Both ggcorrhm(mtcars, layout = \"full\", cluster_rows = TRUE, cluster_cols = TRUE,          annot_rows_df = annot[, -3], annot_cols_df = annot[, -2])   # Mixed layout ggcorrhm(mtcars, layout = c(\"tl\", \"br\"))"},{"path":"https://leod123.github.io/ggcorrheatmap/reference/gghm.html","id":null,"dir":"Reference","previous_headings":"","what":"Make a heatmap with ggplot2. — gghm","title":"Make a heatmap with ggplot2. — gghm","text":"Make heatmap ggplot2.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/gghm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Make a heatmap with ggplot2. — gghm","text":"","code":"gghm(   x,   layout = \"full\",   mode = if (length(layout) == 1) \"heatmap\" else c(\"heatmap\", \"text\"),   col_scale = NULL,   col_name = \"value\",   limits = NULL,   bins = NULL,   size_scale = NULL,   size_name = \"value\",   legend_order = NULL,   include_diag = TRUE,   show_names_diag = FALSE,   names_diag_params = NULL,   show_names_x = TRUE,   names_x_side = \"top\",   show_names_y = TRUE,   names_y_side = \"left\",   na_col = \"grey50\",   na_remove = FALSE,   return_data = FALSE,   cell_labels = F,   cell_label_col = \"black\",   cell_label_size = 3,   cell_label_digits = 2,   border_col = \"grey\",   border_lwd = 0.1,   border_lty = 1,   cell_bg_col = \"white\",   cell_bg_alpha = 0,   annot_rows_df = NULL,   annot_cols_df = NULL,   annot_rows_col = NULL,   annot_cols_col = NULL,   annot_rows_side = \"right\",   annot_cols_side = \"bottom\",   annot_dist = 0.2,   annot_gap = 0,   annot_size = 0.5,   annot_border_col = if (length(border_col) == 1) border_col else \"grey\",   annot_border_lwd = if (length(border_lwd) == 1) border_lwd else 0.5,   annot_border_lty = if (length(border_lty) == 1) border_lty else 1,   annot_na_col = na_col,   annot_na_remove = na_remove,   annot_rows_params = NULL,   annot_cols_params = NULL,   show_annot_names = TRUE,   annot_names_size = 9,   annot_rows_names_side = \"bottom\",   annot_cols_names_side = \"left\",   annot_rows_name_params = NULL,   annot_cols_name_params = NULL,   cluster_rows = FALSE,   cluster_cols = FALSE,   cluster_distance = \"euclidean\",   cluster_method = \"complete\",   show_dend_rows = TRUE,   show_dend_cols = TRUE,   dend_rows_side = \"right\",   dend_cols_side = \"bottom\",   dend_col = \"black\",   dend_dist = 0,   dend_height = 0.3,   dend_lwd = 0.3,   dend_lty = 1,   dend_rows_params = NULL,   dend_cols_params = NULL,   dend_rows_extend = NULL,   dend_cols_extend = NULL )"},{"path":"https://leod123.github.io/ggcorrheatmap/reference/gghm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Make a heatmap with ggplot2. — gghm","text":"x Matrix data frame wide format make heatmap . rownames present used y axis labels, otherwise row number used. column named .names (containing unique row identifiers) present used rownames. layout String specifying layout output heatmap. Possible layouts include 'topleft', 'topright', 'bottomleft', 'bottomright', 'whole'/'full' heatmap (default possible option matrix asymmetric). combination first letters word also works (.e. f, w, tl, tr, bl, br). layout length two two opposing triangles, mixed layout used. mixed layouts, mode needs vector length two (applied order layout). See details information. mode string specifying plotting mode. Possible values heatmap/hm normal heatmap, number 1 25 draw corresponding shape, text write cell values instead filling cells (colour scaling value), none blank cells. col_scale Colour scale use cells. NULL, default ggplot2 scale used. string, corresponding Brewer Viridis scale used. string scale name \"rev_\" beginning \"_rev\" end result reversed scale. Can also ggplot2 scale object overwrite scale. mixed layouts, list two scales can provided. col_name String use colour scale legend title. Can two values mixed layouts dual scales. limits Numeric vector length two limits colour scale. NULL uses default. bins Number bins divide scale (continuous values). 'double' class value uses 'nice.breaks' put breaks nice numbers may result specified number bins. integer number bins prioritised. size_scale ggplot2::scale_size_* call use size scaling mode number 1 25 (R pch). mixed layouts, can also list length two containing two scales use. size_name String use size scale legend title. Can two values mixed layouts dual scales. legend_order Integer vector specifying order legends (first value first legend, second second, etc). default (NULL) shows legends. NAs hide corresponding legends, single NA hides . Ignored ggplot2 scale objects col_scale size_scale. include_diag Logical indicating diagonal cells (symmetric matrix) plotted. Mostly useful getting cleaner look symmetric correlation matrices triangular layouts, diagonal known 1. show_names_diag Logical indicating names written diagonal cells (symmetric input). names_diag_params List named parameters (size, angle, etc) passed geom_text writing column names diagonal. show_names_x Logical indicating names written x axis. Labels can customised using ggplot2::theme() output plot. names_x_side String specifying position x axis names (\"top\" \"bottom\"). show_names_y Logical indicating names written y axis. names_y_side String specifying position y axis names (\"left\" \"right\"). na_col Colour use cells NA (main heatmap annotation). na_remove Logical indicating NA values heatmap omitted (meaning cell border drawn). NAs kept, fill colour can set ggplot2 scale. return_data Logical indicating data used plotting clustering results returned. cell_labels Logical specifying cells labelled values. Alternatively, matrix data frame shape dimnames x containing values write cells. mode text, cell label colours scale cell values cell_label_col ignored. cell_label_col Colour use cell labels, passed ggplot2::geom_text(). cell_label_size Size cell labels, used size argument ggplot2::geom_text(). cell_label_digits Number digits display cells labelled (numeric values). Default 2, passed base::round(). NULL rounding. border_col Colour cell borders. mode number, border_col can set NA remove borders completely. border_lwd Size cell borders. mode number, border_col can set 0 remove borders. border_lty Line type cell borders. Either number corresponding name, string length 2, 4, 6, 8. See 'lty' graphics::par() details. supported numeric mode. cell_bg_col Colour use cell backgrounds modes 'text' 'none'. cell_bg_alpha Alpha cell colours modes 'text' 'none'. annot_rows_df Data frame row annotations. names columns data must included, either row names column named .names. column specifies annotation column name used annotation name (legend next annotation). Numeric columns use continuous colour scale factor character columns use discrete scales. annot_cols_df usage annot_rows_df column annotation. annot_rows_col Named list row annotation colour scales. names specify annotation scale applies . Elements can strings ggplot2 \"Scale\" class objects. string, used brewer palette viridis option. scale object used , allowing flexibility. may change order legends drawn , specify order using guide argument ggplot2 scale function. annot_cols_col Named list used column annotation colour scales, used like annot_rows_col. annot_rows_side String specifying side row annotation drawn ('left' 'right', defaults 'left'). annot_cols_side String specifying side column annotation drawn ('bottom' 'top', defaults 'bottom'). annot_dist Distance heatmap first annotation cell 1 size one heatmap cell. Used row column annotation. annot_gap Distance annotation 1 size one heatmap cell. Used row column annotation. annot_size Size (width row annotation, height column annotation) annotation cells compared heatmap cell. Used row column annotation. annot_border_col Colour cell borders annotation. default border_col main heatmap length 1, otherwise uses default (grey). annot_border_lwd Line width cell borders annotation. default border_lwd main heatmap length 1, otherwise uses default (0.5). annot_border_lty Line type cell borders annotation. default border_lty main heatmap length 1, otherwise uses default (solid). annot_na_col Colour use NA values annotations. Annotation-specific colour can set ggplot2 scales annot_*_fill arguments. annot_na_remove Logical indicating NAs annotations removed (producing empty spaces). annot_rows_params Named list parameters row annotations overwrite defaults set annot_* arguments, name corresponding * part (see details information). annot_cols_params Named list parameters column annotations, used like annot_rows_params. show_annot_names Logical controlling names annotations shown drawing area. annot_names_size Size annotation names. annot_rows_names_side String specifying side row annotation names . Either \"top\" \"bottom\". annot_cols_names_side String specifying side column annotation names . Either \"left\" \"right\". annot_rows_name_params Named list parameters row annotation names. Given grid::textGrob, see ?grid::textGrob details. ?grid::gpar also helpful. annot_cols_name_params Named list parameters column annotation names. Given grid::textGrob, see ?grid::textGrob details. ?grid::gpar also helpful. cluster_rows Logical indicating rows clustered. Can also hclust dendrogram object. cluster_cols Logical indicating columns clustered. Can also hclust dendrogram object. cluster_distance String distance metric use clustering, given stats::dist(). cluster_method String clustering method use, given stats::hclust(). show_dend_rows Logical indicating dendrogram drawn rows. show_dend_cols Logical indicating dendrogram drawn columns. dend_rows_side side draw row dendrogram ('left' 'right', defaults 'left'). dend_cols_side side draw column dendrogram ('bottom' 'top', defaults 'bottom'). dend_col Colour use dendrogram lines, applied row column dendrograms. dend_dist Distance heatmap (annotation) leaves dendrogram, measured heatmap cells (1 size one cell). dend_height Number scale dendrogram height, applied row column dendrograms. dend_lwd Linewidth dendrogram lines, applied row column dendrograms. dend_lty Dendrogram line type, applied row column dendrograms. dend_rows_params Named list row dendrogram parameters overwrite common parameter values. See details information. dend_cols_params Named list column dendrogram parameters overwrite common parameter values. See details information. dend_rows_extend Named list functional sequence specifying dendextend functions apply row dendrogram. See details usage. dend_cols_extend Named list functional sequence specifying dendextend functions apply column dendrogram. See details usage.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/gghm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Make a heatmap with ggplot2. — gghm","text":"heatmap ggplot object. return_data TRUE output list containing plot (named 'plot'), plotting data ('plot_data', factor columns 'row' 'col' column 'value' containing cell values), result clustering ('row_clustering' /'col_clustering). layout mixed, extra factor column named 'layout' included 'plot_data', showing triangle cell belongs .","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/gghm.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Make a heatmap with ggplot2. — gghm","text":"using mixed layouts (layout length two), mode needs length two well, specifying mode use triangle. cell_label_* border_* arguments can length one apply whole heatmap, length two vectors apply triangle, lists length two, element containing one value (apply whole triangle) value per cell (apply cell-wise triangle). cell_labels can also specified per triangle, either logical vector length two, list length two containing mix logicals matrices/data frames. also possible provide two scales filling colouring triangles differently. case col_scale must one character value (scale used triangles) NULL list length two annotation parameter arguments annot_rows_params annot_cols_params named lists, possible options correspond different annot_* arguments. possible options \"dist\" (distance heatmap annotation), \"gap\" (distance annotations), \"size\" (cell size), \"show_names\" (logical, annotation names displayed), \"border_col\" (colour border) \"border_lwd\" (border line width). unused options use defaults set annot_* arguments. dendrogram parameters arguments dend_rows_params dend_cols_params named lists, analogous annotation parameter arguments. Possible options \"col\" (line colour), \"dist\" (distance heatmap dendrogram), \"height\" (height scaling), \"lwd\" (line width), \"lty\" (line type). dend_rows_extend dend_cols_extend arguments make possible customise dendrograms using dendextend package. argument named list, element named dendextend function use (consecutive usage set function supported due duplicate list names possible). element contain arguments given dendextend function, argument used set function. Alternatively, dendextend functions can provided functional sequence (\"fseq\" object) piping together functions using %>% pipe. Functions modifying labels work dendrogram labels displayed (axis text). dendextend::.ggdend() used conversion dendrogram, anything supported .ggdend() work (\"nodes_bg\" \"rect.dendrogram\"). See examples clustering article example usage.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/gghm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Make a heatmap with ggplot2. — gghm","text":"","code":"library(ggplot2)  # Use part of the mtcars data (for visibility) hm_in <- mtcars[1:15, ]  # Basic usage gghm(hm_in)   # Different layout (using a symmetric matrix) gghm(cor(mtcars), layout = \"tl\")   # Mixed layouts gghm(cor(mtcars), layout = c(\"tr\", \"bl\"),      # Hide one of the legends      legend_order = c(1, NA))   # With clustering gghm(scale(hm_in), cluster_rows = TRUE, cluster_cols = TRUE)   # Adjusting cluster dendrograms using common and specific options gghm(scale(hm_in), cluster_rows = TRUE, cluster_cols = TRUE,      # Common options      dend_lwd = 0.7, dend_col = \"magenta\",      # Specific options      dend_rows_params = list(height = 1), dend_cols_params = list(lty = 2))   # With annotation and specifying colour scales set.seed(123) annot_rows <- data.frame(.names = rownames(hm_in),                          annot1 = rnorm(nrow(hm_in)),                          annot2 = sample(letters[1:3], nrow(hm_in), TRUE)) # Specify colour scale for one of the annotations (viridis mako) annot_fill <- list(annot1 = \"G\")  gghm(scale(hm_in),      # Change colours of heatmap (Brewer Purples)      col_scale = \"Purples\",      annot_rows_df = annot_rows, annot_rows_col = annot_fill) +      # Use ggplot2::theme to adjust margins to fit the annotation names      theme(plot.margin = margin(30, 10, 60, 20))   # Using the dend_*_extend arguments gghm(scale(hm_in), cluster_rows = TRUE, dend_rows_extend =   list(\"set\" = list(\"branches_lty\", c(1, 2, 3)),        # Empty list element (or NULL) if no arguments to be given        \"highlight_branches_col\" = list()))"},{"path":"https://leod123.github.io/ggcorrheatmap/reference/increment1to8.html","id":null,"dir":"Reference","previous_headings":"","what":"Increment between 1 and 8. — increment1to8","title":"Increment between 1 and 8. — increment1to8","text":"Increment 1 8.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/increment1to8.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Increment between 1 and 8. — increment1to8","text":"","code":"increment1to8(x)"},{"path":"https://leod123.github.io/ggcorrheatmap/reference/increment1to8.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Increment between 1 and 8. — increment1to8","text":"x Integer increment.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/increment1to8.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Increment between 1 and 8. — increment1to8","text":"Integer. x + 1 x 1 7, 1 otherwise.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/layout_hm.html","id":null,"dir":"Reference","previous_headings":"","what":"Layout heatmap data for plotting — layout_hm","title":"Layout heatmap data for plotting — layout_hm","text":"Layout heatmap data plotting","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/layout_hm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Layout heatmap data for plotting — layout_hm","text":"","code":"layout_hm(x, layout = \"f\", na_remove = F)"},{"path":"https://leod123.github.io/ggcorrheatmap/reference/layout_hm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Layout heatmap data for plotting — layout_hm","text":"x Matrix plot. layout Layout (full, triangular (topleft, topright, bottomleft, bottomright)). na_remove Logical indicating NAs removed.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/layout_hm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Layout heatmap data for plotting — layout_hm","text":"Long format data plotting.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/make_heatmap.html","id":null,"dir":"Reference","previous_headings":"","what":"Make main heatmap part of plot for gghm. — make_heatmap","title":"Make main heatmap part of plot for gghm. — make_heatmap","text":"Make main heatmap part plot gghm.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/make_heatmap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Make main heatmap part of plot for gghm. — make_heatmap","text":"","code":"make_heatmap(   x_long,   plt = NULL,   mode = \"heatmap\",   include_diag = T,   invisible_diag = F,   border_lwd = 0.1,   border_col = \"grey\",   border_lty = 1,   show_names_diag = T,   show_names_x = F,   show_names_y = F,   names_x_side = \"top\",   names_y_side = \"left\",   col_scale = NULL,   size_scale = NULL,   cell_labels = F,   cell_label_col = \"black\",   cell_label_size = 3,   cell_label_digits = 2,   cell_bg_col = \"white\",   cell_bg_alpha = 0 )"},{"path":"https://leod123.github.io/ggcorrheatmap/reference/make_heatmap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Make main heatmap part of plot for gghm. — make_heatmap","text":"x_long Long format data. plt ggplot object build onto. NULL, makes new plot. mode Plotting mode. include_diag Logical indicating diagonal included. invisible_diag Logical indicating invisible diagonal included. border_lwd Border linewidth. border_col Border colour. border_lty Border linetype. show_names_diag Logical indicating names displayed diagonal. show_names_x Logical indicating names displayed x axis. show_names_y Logical indicating names displayed y axis. names_x_side X axis side. names_y_side Y axis side. col_scale Scale colour/fill aesthetic. size_scale Scale size aesthetic. cell_labels Logical indicating cell labels written matrix data frame (shape x_long) values write. cell_label_col Colour cell labels. cell_label_size Size cell labels. cell_label_digits Number digits cell labels numeric. cell_bg_col Cell background colour (fill). cell_bg_alpha Cell background alpha.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/make_heatmap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Make main heatmap part of plot for gghm. — make_heatmap","text":"ggplot object heatmap component.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/make_legend_order.html","id":null,"dir":"Reference","previous_headings":"","what":"Make legend order depending on what the plot will contain. — make_legend_order","title":"Make legend order depending on what the plot will contain. — make_legend_order","text":"Make legend order depending plot contain.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/make_legend_order.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Make legend order depending on what the plot will contain. — make_legend_order","text":"","code":"make_legend_order(   mode,   col_scale = NULL,   size_scale = NULL,   annot_rows_df = NULL,   annot_cols_df = NULL,   legend_order = NULL )"},{"path":"https://leod123.github.io/ggcorrheatmap/reference/make_legend_order.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Make legend order depending on what the plot will contain. — make_legend_order","text":"mode Plotting modes. col_scale One two colour scales (shared fill colour). NULL default, string Brewer Viridis, scale. size_scale Size scales (NULL ggplot2 scales). annot_rows_df Annotation data frame rows. annot_cols_df Annotation data frame columnss. legend_order Numeric vector legend order. NULL default.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/make_legend_order.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Make legend order depending on what the plot will contain. — make_legend_order","text":"list aesthetics main plot orders legends.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/move_dendrogram.html","id":null,"dir":"Reference","previous_headings":"","what":"Move coordinates of dendrogram to edges of heatmap — move_dendrogram","title":"Move coordinates of dendrogram to edges of heatmap — move_dendrogram","text":"Move coordinates dendrogram calculating distance move end desired edges heatmap","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/move_dendrogram.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Move coordinates of dendrogram to edges of heatmap — move_dendrogram","text":"","code":"move_dendrogram(   dend_seg,   x_long,   context = c(\"rows\", \"cols\"),   dend_side,   dend_dist,   annot_df,   annot_side,   annot_pos,   annot_size )"},{"path":"https://leod123.github.io/ggcorrheatmap/reference/move_dendrogram.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Move coordinates of dendrogram to edges of heatmap — move_dendrogram","text":"dend_seg Data frame containing dendrogram segments, attained dendextend::.ggdend() x_long Long format data frame values context Character specifying whether dendrogram linked rows columns heatmap dend_side Logical specifying dendrogram position. TRUE left heatmap row dendrogram, bottom heatmap column dendrogram dend_dist Distance heatmap (annotation) dendrogram cell size. annot_df Data frame annotations checking annotations exist well size annot_side Logical specifying annotation position, analogous dend_side annot_pos Numeric vector annotation coordinates (x coordinates row annotations, y column annotations) annot_size Numeric length 1, specified size (width height) annotation cells","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/move_dendrogram.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Move coordinates of dendrogram to edges of heatmap — move_dendrogram","text":"Data frame updated dendrogram coordinates","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/orient_dendrogram.html","id":null,"dir":"Reference","previous_headings":"","what":"Orient a dendrogram. — orient_dendrogram","title":"Orient a dendrogram. — orient_dendrogram","text":"Orient dendrogram.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/orient_dendrogram.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Orient a dendrogram. — orient_dendrogram","text":"","code":"orient_dendrogram(dend, dim = c(\"rows\", \"cols\"), full_plt, layout, dend_side)"},{"path":"https://leod123.github.io/ggcorrheatmap/reference/orient_dendrogram.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Orient a dendrogram. — orient_dendrogram","text":"dend Dendrogram segments nodes data frame (containing x, y, xend, yend). dim String, rows cols know dimensions dendrogram . full_plt Logical indicating full layout. layout heatmap layout take mixed layout account. dend_side Logical indicating dendrogram placed left (row dend) bottom (col dend).","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/orient_dendrogram.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Orient a dendrogram. — orient_dendrogram","text":"input dendrogram data frame rotated mirrored fit plot.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/prepare_annotation.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare annotation parameters and positions — prepare_annotation","title":"Prepare annotation parameters and positions — prepare_annotation","text":"Prepare annotation parameters positions","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/prepare_annotation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare annotation parameters and positions — prepare_annotation","text":"","code":"prepare_annotation(   annot_df,   annot_defaults,   annot_params,   annot_side,   context = c(\"rows\", \"cols\"),   annot_names_size,   annot_name_params,   annot_names_side,   data_size )"},{"path":"https://leod123.github.io/ggcorrheatmap/reference/prepare_annotation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare annotation parameters and positions — prepare_annotation","text":"annot_df Annotation data frame. contain rownames column called '.names' names, columns used annotation annot_defaults Default parameters annotation. annot_params Provided annotation parameters update. annot_side String annotation side. context String stating context (\"rows\" \"cols\"). annot_names_size Size annotation names. annot_name_params Annotation label (names next annotations) parameters update. annot_names_side Annotation label side. data_size Size data (ncol row annotations, nrow column annotations).","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/prepare_annotation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare annotation parameters and positions — prepare_annotation","text":"List updated annotation parameters, calculated annotation positions, updated annotation label parameters.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/prepare_cell_labels.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare cell labels in ggcorrhm to pass to gghm — prepare_cell_labels","title":"Prepare cell labels in ggcorrhm to pass to gghm — prepare_cell_labels","text":"Prepare cell labels ggcorrhm pass gghm","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/prepare_cell_labels.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare cell labels in ggcorrhm to pass to gghm — prepare_cell_labels","text":"","code":"prepare_cell_labels(   mode,   cell_labels,   p_values,   cell_label_p,   cell_label_digits,   p_thresholds = NULL,   cor_mat_dat = NULL )"},{"path":"https://leod123.github.io/ggcorrheatmap/reference/prepare_cell_labels.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare cell labels in ggcorrhm to pass to gghm — prepare_cell_labels","text":"mode Plotting mode. cell_labels Cell labels (TRUE, FALSE, matrix, data frame). p_values Logical indicating p-values computed. cell_label_p Logical indicating cell labels swapped p-values. cell_label_digits Number digits display cell labels. p_thresholds P-value thresholds. cor_mat_dat Correlation long format data correlation tests.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/prepare_cell_labels.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare cell labels in ggcorrhm to pass to gghm — prepare_cell_labels","text":"Object use cell_labels gghm (containing logical, matrix/data frame, list length 2 things).","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/prepare_dendrogram.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare dendrogram by transforming dendrogram segments. — prepare_dendrogram","title":"Prepare dendrogram by transforming dendrogram segments. — prepare_dendrogram","text":"Prepare dendrogram transforming dendrogram segments.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/prepare_dendrogram.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare dendrogram by transforming dendrogram segments. — prepare_dendrogram","text":"","code":"prepare_dendrogram(   dendro_in,   context = c(\"rows\", \"cols\"),   dend_side,   dend_defaults,   dend_params,   full_plt,   layout,   x_long,   annot_df,   annot_side,   annot_pos,   annot_size )"},{"path":"https://leod123.github.io/ggcorrheatmap/reference/prepare_dendrogram.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare dendrogram by transforming dendrogram segments. — prepare_dendrogram","text":"dendro_in Dendrogram object generated some_matrix |> dist() |> hclust() |> .dendrogram() |> dendextend::.ggdend(). context Dimension dendrogram plotted (rows columns). dend_side String dendrogram side. dend_defaults List dendrogram default parameters. dend_params List dendrogram parameters overwrite defaults. full_plt Logical indicating whole heatmap plotted . layout heatmap layout (reordering rows). x_long Data frame containing values plotted heatmap. annot_df Data frame containing annotations. annot_side Logical specifying side annotation drawn, analogous 'dend_down' 'dend_left' (use one dimension dendrogram). annot_pos Vector annotation positions along opposite dimension. annot_size Size annotation cells, specified heatmap cells (1 size one cell).","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/prepare_dendrogram.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare dendrogram by transforming dendrogram segments. — prepare_dendrogram","text":"Data frame dendrogram segment node parameters.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/prepare_mixed_param.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare parameters for mixed layouts. — prepare_mixed_param","title":"Prepare parameters for mixed layouts. — prepare_mixed_param","text":"Prepare parameters mixed layouts.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/prepare_mixed_param.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare parameters for mixed layouts. — prepare_mixed_param","text":"","code":"prepare_mixed_param(param, param_name)"},{"path":"https://leod123.github.io/ggcorrheatmap/reference/prepare_mixed_param.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare parameters for mixed layouts. — prepare_mixed_param","text":"param Parameter prepare. param_name Parameter name (error messages handling special parameter).","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/prepare_mixed_param.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare parameters for mixed layouts. — prepare_mixed_param","text":"length one, returned duplicated list use triangle. longer 1 error message returned. cases, input parameter returned (length two input).","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/prepare_scales.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare scales for heatmap. — prepare_scales","title":"Prepare scales for heatmap. — prepare_scales","text":"Prepare scales heatmap.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/prepare_scales.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare scales for heatmap. — prepare_scales","text":"","code":"prepare_scales(   scale_order,   context = c(\"gghm\", \"ggcorrhm\"),   val_type,   col_scale = NULL,   col_name = \"value\",   size_scale = NULL,   size_name = \"value\",   bins = NULL,   limits = c(-1, 1),   high = \"sienna2\",   mid = \"white\",   low = \"skyblue2\",   midpoint = 0,   size_range = NULL,   na_col = \"grey50\" )"},{"path":"https://leod123.github.io/ggcorrheatmap/reference/prepare_scales.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare scales for heatmap. — prepare_scales","text":"scale_order List necessary scales orders, obtained make_legend_order. context Scale context (gghm ggcorrhm) deciding defaults use. val_type String type value ('continuous' 'discrete'). col_scale Colour scales input. col_name Colour scale names. size_scale Size scales input. size_name Size scale names. bins Number bins divide scale (ggcorrhm). limits Scale limits (ggcorrhm). high Colour higher end scale (ggcorrhm). mid Colour middle point scale (ggcorrhm). low Colour Lower end scale (ggcorrhm). midpoint Middle point scale (ggcorrhm). size_range Size range size scale (ggcorrhm). na_col Colour use NAs (ggcorrhm).","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/prepare_scales.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare scales for heatmap. — prepare_scales","text":"ggplot2 scales plot.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/prepare_scales_annot.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare default colour scales for annotation. — prepare_scales_annot","title":"Prepare default colour scales for annotation. — prepare_scales_annot","text":"Prepares brewer palette viridis option annotations colour scale specified user. eight options brewer (categorical) viridis (continuous) selected sequentially, going back beginning eight annotations kind.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/prepare_scales_annot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare default colour scales for annotation. — prepare_scales_annot","text":"","code":"prepare_scales_annot(   scale_order,   annot_rows_df = NULL,   annot_cols_df = NULL,   annot_rows_col = NULL,   annot_cols_col = NULL,   na_col = \"grey50\" )"},{"path":"https://leod123.github.io/ggcorrheatmap/reference/prepare_scales_annot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare default colour scales for annotation. — prepare_scales_annot","text":"scale_order List containing orders scales obtained make_legend_order. annot_rows_df Data frame annotation rows. annot_cols_df Data frame annotation columns. annot_rows_col List colour scales rows. annot_cols_col List colour scales columns.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/prepare_scales_annot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare default colour scales for annotation. — prepare_scales_annot","text":"List length two containing lists row annotation column annotation.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/process_dendrogram.html","id":null,"dir":"Reference","previous_headings":"","what":"Process dendrogram with customisation options — process_dendrogram","title":"Process dendrogram with customisation options — process_dendrogram","text":"Process dendrogram customisation options","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/process_dendrogram.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Process dendrogram with customisation options — process_dendrogram","text":"","code":"process_dendrogram(mat, dendro, dend_options)"},{"path":"https://leod123.github.io/ggcorrheatmap/reference/process_dendrogram.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Process dendrogram with customisation options — process_dendrogram","text":"mat Data used clustering. dendro Dendrogram object. dend_options Dendrogram extension options (list fseq NULL).","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/process_dendrogram.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Process dendrogram with customisation options — process_dendrogram","text":"Processed dendrogram object.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/remove_duplicate_scales.html","id":null,"dir":"Reference","previous_headings":"","what":"Remove duplicate scales. — remove_duplicate_scales","title":"Remove duplicate scales. — remove_duplicate_scales","text":"mixed layout uses aesthetic triangles one () colour size scale specified, remove redundant scales.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/remove_duplicate_scales.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Remove duplicate scales. — remove_duplicate_scales","text":"","code":"remove_duplicate_scales(scale_vec, col_scale = NULL, size_scale = NULL)"},{"path":"https://leod123.github.io/ggcorrheatmap/reference/remove_duplicate_scales.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Remove duplicate scales. — remove_duplicate_scales","text":"scale_vec Vector scale aesthetics. col_scale Input colour scales (NULL, string scale object). size_scale Input size scales.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/remove_duplicate_scales.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Remove duplicate scales. — remove_duplicate_scales","text":"Vector aesthetics duplicates removed appropriate.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/remove_triangle.html","id":null,"dir":"Reference","previous_headings":"","what":"Remove triangle from symmetric matrix and return long format data. — remove_triangle","title":"Remove triangle from symmetric matrix and return long format data. — remove_triangle","text":"Remove triangle symmetric matrix return long format data.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/remove_triangle.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Remove triangle from symmetric matrix and return long format data. — remove_triangle","text":"","code":"remove_triangle(x, tri_remove = \"upper\", na_remove = F)"},{"path":"https://leod123.github.io/ggcorrheatmap/reference/remove_triangle.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Remove triangle from symmetric matrix and return long format data. — remove_triangle","text":"x Matrix remove triangle (make long). tri_remove Triangle remove. na_remove NAs removed.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/remove_triangle.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Remove triangle from symmetric matrix and return long format data. — remove_triangle","text":"Matrix long format triangle removed.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/replace_default.html","id":null,"dir":"Reference","previous_headings":"","what":"Replace default elements in a named list with corresponding elements in a new list. — replace_default","title":"Replace default elements in a named list with corresponding elements in a new list. — replace_default","text":"Replace default elements named list corresponding elements new list.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/replace_default.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Replace default elements in a named list with corresponding elements in a new list. — replace_default","text":"","code":"replace_default(default_param, new_param, add_new = F, warning_context = NULL)"},{"path":"https://leod123.github.io/ggcorrheatmap/reference/replace_default.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Replace default elements in a named list with corresponding elements in a new list. — replace_default","text":"default_param Named list elements potentially replace (\"defaults\"). new_param Named list elements replace . add_new Logical, TRUE elements names unique new_param added output. warning_context String add beginning warning message unsupported parameters detected (add_new FALSE). Default (NULL) produces warning.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/replace_default.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Replace default elements in a named list with corresponding elements in a new list. — replace_default","text":"named list overlapping elements overlapping names replaced.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/scale_dendrogram.html","id":null,"dir":"Reference","previous_headings":"","what":"Scale height of dendrogram. — scale_dendrogram","title":"Scale height of dendrogram. — scale_dendrogram","text":"Scale height dendrogram.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/scale_dendrogram.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Scale height of dendrogram. — scale_dendrogram","text":"","code":"scale_dendrogram(dend_seg, context = c(\"rows\", \"cols\"), dend_side, dend_height)"},{"path":"https://leod123.github.io/ggcorrheatmap/reference/scale_dendrogram.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Scale height of dendrogram. — scale_dendrogram","text":"dend_seg Data frame containing dendrogram segments format obtained dendextend. context Dimension draw dendrogram along (rows columns). dend_side Logical indicating side draw dendrogram . row dendrogram TRUE left. column dendrogram TRUE . dend_height Scaling parameter dendrogram height (1 scaling).","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/scale_dendrogram.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Scale height of dendrogram. — scale_dendrogram","text":"Data frame containing coordinates dendrogram segments (colour, linewidth, line type parameters)","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/shape_mat_long.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert a matrix to long format using row names and column names. — shape_mat_long","title":"Convert a matrix to long format using row names and column names. — shape_mat_long","text":"Convert matrix long format using row names column names.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/shape_mat_long.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert a matrix to long format using row names and column names. — shape_mat_long","text":"","code":"shape_mat_long(x, unique_pairs = F, na_remove = F)"},{"path":"https://leod123.github.io/ggcorrheatmap/reference/shape_mat_long.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert a matrix to long format using row names and column names. — shape_mat_long","text":"x Matrix convert long format. unique_pairs Whether unique combinations included output (symmetric matrices). na_remove Logical indicating NAs excluded (removes NaNs ).","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/shape_mat_long.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert a matrix to long format using row names and column names. — shape_mat_long","text":"data frame columns 'row', 'column' (indicating combinations), 'value'","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/shape_mat_wide.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert long formt matrix to wide. — shape_mat_wide","title":"Convert long formt matrix to wide. — shape_mat_wide","text":"Convert long formt matrix wide.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/shape_mat_wide.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert long formt matrix to wide. — shape_mat_wide","text":"","code":"shape_mat_wide(x)"},{"path":"https://leod123.github.io/ggcorrheatmap/reference/shape_mat_wide.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert long formt matrix to wide. — shape_mat_wide","text":"x Long format matrix obtained 'shape_mat_long' (contains columns named 'row', 'col', 'value').","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/shape_mat_wide.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert long formt matrix to wide. — shape_mat_wide","text":"Wide format version x.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/test_cor.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate correlations and p-values between columns. — test_cor","title":"Calculate correlations and p-values between columns. — test_cor","text":"Calculate correlations p-values columns.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/test_cor.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate correlations and p-values between columns. — test_cor","text":"","code":"test_cor(   x,   y = NULL,   method = \"pearson\",   use = \"everything\",   p_adj_method = \"none\" )"},{"path":"https://leod123.github.io/ggcorrheatmap/reference/test_cor.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate correlations and p-values between columns. — test_cor","text":"x Matrix data frame columns correlate. y Matrix data frame, provided correlated x. method Passed stats::cor. use Passed stats::cor. p_adj_method P-value adjustment method, passed stats::p.adjust.","code":""},{"path":"https://leod123.github.io/ggcorrheatmap/reference/test_cor.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate correlations and p-values between columns. — test_cor","text":"Data frame long format correlation values nominal adjusted p-values.","code":""}]
